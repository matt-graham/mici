
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>mici.adapters module &#8212; Mici 0.2.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=ed26ec02"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'mici.adapters';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="mici.autodiff module" href="mici.autodiff.html" />
    <link rel="prev" title="mici package" href="mici.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/mici-logo-rectangular.svg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/mici-logo-rectangular-light-text.svg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="mici.html">
                        mici package
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/matt-graham/mici" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="mici.html">
                        mici package
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/matt-graham/mici" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">mici.adapters module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.autodiff.html">mici.autodiff module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.autograd_wrapper.html">mici.autograd_wrapper module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.errors.html">mici.errors module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.integrators.html">mici.integrators module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.interop.html">mici.interop module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.matrices.html">mici.matrices module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.progressbars.html">mici.progressbars module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.samplers.html">mici.samplers module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.solvers.html">mici.solvers module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.stagers.html">mici.stagers module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.states.html">mici.states module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.systems.html">mici.systems module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.transitions.html">mici.transitions module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.types.html">mici.types module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.utils.html">mici.utils module</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="mici.html" class="nav-link">mici package</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">mici.adapters module</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="module-mici.adapters">
<span id="mici-adapters-module"></span><h1>mici.adapters module<a class="headerlink" href="#module-mici.adapters" title="Permalink to this heading">#</a></h1>
<p>Methods for adaptively setting algorithmic parameters of transitions.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mici.adapters.Adapter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mici.adapters.</span></span><span class="sig-name descname"><span class="pre">Adapter</span></span><a class="reference internal" href="_modules/mici/adapters.html#Adapter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.adapters.Adapter" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>Abstract adapter for implementing schemes to adapt transition parameters.</p>
<p>Adaptation schemes are assumed to be based on updating a collection of adaptation
variables (collectively termed the adapter state here) after each chain transition
based on the sampled chain state and/or statistics of the transition such as an
acceptance probability statistic. After completing a chain of one or more adaptive
transitions, the final adapter state may be used to perform a final update to the
transition parameters.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mici.adapters.Adapter.finalize">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">finalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adapt_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chain_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rngs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/adapters.html#Adapter.finalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.adapters.Adapter.finalize" title="Permalink to this definition">#</a></dt>
<dd><p>Update transition parameters based on final adapter state or states.</p>
<p>Optionally, if multiple adapter states are available, e.g. from a set of
independent adaptive chains, then these adaptation information from all the
chains may be combined to set the transition parameter(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adapt_states</strong> (<em>Union</em><em>[</em><em>AdapterState</em><em>, </em><em>Iterable</em><em>[</em><em>AdapterState</em><em>]</em><em>]</em>) – Final adapter state or a list of per chain adapter states.
Arrays / buffers associated with the adapter state entries may be
recycled to reduce memory usage - if so  the corresponding entries will
be removed from the adapter state dictionary / dictionaries.</p></li>
<li><p><strong>chain_states</strong> (<em>Union</em><em>[</em><a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a><em>, </em><em>Iterable</em><em>[</em><a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a><em>]</em><em>]</em>) – Final state of chain (or states of chains) in current
sampling stage. May be updated in-place if transition parameters altered
by adapter require updating any state components.</p></li>
<li><p><strong>transition</strong> (<a class="reference internal" href="mici.transitions.html#mici.transitions.Transition" title="mici.transitions.Transition"><em>Transition</em></a>) – Markov transition being dapted. Attributes of the transition or
child objects will be updated in-place by the method.</p></li>
<li><p><strong>rngs</strong> (<em>Union</em><em>[</em><em>Generator</em><em>, </em><em>Iterable</em><em>[</em><em>Generator</em><em>]</em><em>]</em>) – Random number generator for the chain or a list of per-chain random
number generators. Used to resample any components of states needing to
be updated due to adaptation if required.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.adapters.Adapter.initialize">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chain_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/adapters.html#Adapter.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.adapters.Adapter.initialize" title="Permalink to this definition">#</a></dt>
<dd><p>Initialize adapter state prior to starting adaptive transitions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chain_state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – Initial chain state adaptive transition will be started from.
May be used to calculate initial adapter state but should not be mutated
by method.</p></li>
<li><p><strong>transition</strong> (<a class="reference internal" href="mici.transitions.html#mici.transitions.Transition" title="mici.transitions.Transition"><em>Transition</em></a>) – Markov transition being adapted. Attributes of the transition or
child objects may be updated in-place by the method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Initial adapter state.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>AdapterState</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mici.adapters.Adapter.is_fast">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_fast</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#mici.adapters.Adapter.is_fast" title="Permalink to this definition">#</a></dt>
<dd><p>Whether the adapter is ‘fast’ or ‘slow’.</p>
<p>An adapter which requires only local information to adapt the transition
parameters should be classified as fast while one which requires more global
information and so more chain iterations should be classified as slow i.e.
<code class="code docutils literal notranslate"><span class="pre">is_fast</span> <span class="pre">==</span> <span class="pre">False</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.adapters.Adapter.update">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adapt_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chain_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trans_stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/adapters.html#Adapter.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.adapters.Adapter.update" title="Permalink to this definition">#</a></dt>
<dd><p>Update adapter state after sampling from transition being adapted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adapt_state</strong> (<em>AdapterState</em>) – Current adapter state. Entries will be updated in-place by the
method.</p></li>
<li><p><strong>chain_state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – Current chain state following sampling from transition being
adapted. May be used to calculate adapter state updates but should not
be mutated by method.</p></li>
<li><p><strong>trans_stats</strong> (<em>TransitionStatistics</em>) – Dictionary of statistics associated with transition being
adapted. May be used to calculate adapter state updates but should not
be mutated by method.</p></li>
<li><p><strong>transition</strong> (<a class="reference internal" href="mici.transitions.html#mici.transitions.Transition" title="mici.transitions.Transition"><em>Transition</em></a>) – Markov transition being adapted. Attributes of the transition or
child objects may be updated in-place by the method.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mici.adapters.DualAveragingStepSizeAdapter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mici.adapters.</span></span><span class="sig-name descname"><span class="pre">DualAveragingStepSizeAdapter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adapt_stat_target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adapt_stat_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_step_size_reg_target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_step_size_reg_coefficient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter_decay_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_init_step_size_iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_step_size_reducer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/adapters.html#DualAveragingStepSizeAdapter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.adapters.DualAveragingStepSizeAdapter" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#mici.adapters.Adapter" title="mici.adapters.Adapter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Adapter</span></code></a></p>
<p>Dual averaging integrator step size adapter.</p>
<p>Implementation of the dual algorithm step size adaptation algorithm described in
Hoffman and Gelman (2014), a modified version of the stochastic optimisation scheme
of Nesterov (2009). By default the adaptation is performed to control the
<code class="code docutils literal notranslate"><span class="pre">accept_stat</span></code> statistic of an integration transition to be close to a target
value but the statistic adapted on can be altered by changing the
<code class="code docutils literal notranslate"><span class="pre">adapt_stat_func</span></code>.</p>
<p class="rubric">References</p>
<ol class="arabic simple">
<li><p>Hoffman, M.D. and Gelman, A. (2014). The No-U-turn sampler: adaptively setting
path lengths in Hamiltonian Monte Carlo. Journal of Machine Learning Research,
15(1), pp.1593-1623.</p></li>
<li><p>Nesterov, Y. (2009). Primal-dual subgradient methods for convex problems.
Mathematical programming 120(1), pp.221-259.</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adapt_stat_target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Target value for the transition statistic
being controlled during adaptation.</p></li>
<li><p><strong>adapt_stat_func</strong> (<em>Optional</em><em>[</em><em>AdaptationStatisticFunction</em><em>]</em>) – Function which given a dictionary of transition statistics
outputs the value of the statistic to control during adaptation. By
default this is set to a function which simply selects the
:code:’accept_stat’ value in the statistics dictionary.</p></li>
<li><p><strong>log_step_size_reg_target</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>]</em>) – Value to regularize the controlled output
(logarithm of the integrator step size) towards. If <code class="code docutils literal notranslate"><span class="pre">None</span></code> set to
<code class="code docutils literal notranslate"><span class="pre">log(10</span> <span class="pre">*</span> <span class="pre">init_step_size)</span></code> where <code class="code docutils literal notranslate"><span class="pre">init_step_size</span></code> is the
initial ‘reasonable’ step size found by a coarse search as recommended
in Hoffman and Gelman (2014). This has the effect of giving the dual
averaging algorithm a tendency towards testing step sizes larger than
the initial value, with typically integrating with a larger step size
having a lower computational cost.</p></li>
<li><p><strong>log_step_size_reg_coefficient</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Coefficient controlling amount of
regularisation of controlled output (logarithm of the integrator step
size) towards <code class="code docutils literal notranslate"><span class="pre">log_step_size_reg_target</span></code>. Defaults to 0.05 as
recommended in Hoffman and Gelman (2014).</p></li>
<li><p><strong>iter_decay_coeff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Coefficient controlling exponent of decay in schedule
weighting stochastic updates to smoothed log step size estimate. Should
be in the interval (0.5, 1] to ensure asymptotic convergence of
adaptation. A value of 1 gives equal weight to the whole history of
updates while setting to a smaller value increasingly highly weights
recent updates, giving a tendency to ‘forget’ early updates.
Defaults to 0.75 as recommended in Hoffman and Gelman (2014).</p></li>
<li><p><strong>iter_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Offset used for the iteration based weighting of the adaptation
statistic error estimate. Should be set to a non-negative value. A value
&gt; 0 has the effect of stabilising early iterations. Defaults to the
value of 10 as recommended in Hoffman and Gelman (2014).</p></li>
<li><p><strong>max_init_step_size_iters</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Maximum number of iterations to use in initial
search for a reasonable step size with an
<a class="reference internal" href="mici.errors.html#mici.errors.AdaptationError" title="mici.errors.AdaptationError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">mici.errors.AdaptationError</span></code></a> exception raised if a suitable
step size is not found within this many iterations.</p></li>
<li><p><strong>log_step_size_reducer</strong> (<em>Optional</em><em>[</em><em>ReducerFunction</em><em>]</em>) – Reduction to apply to final per-chain step sizes
estimates to produce overall integrator step size for main chain stages.
The specified function should accept a sequence of logarithms of
estimated step sizes and output a non-negative step size to use. If
<code class="code docutils literal notranslate"><span class="pre">None</span></code>, the default, a function which computes the arithmetic mean
of the per-chain step sizes is used.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mici.adapters.DualAveragingStepSizeAdapter.finalize">
<span class="sig-name descname"><span class="pre">finalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adapt_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chain_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rngs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/adapters.html#DualAveragingStepSizeAdapter.finalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.adapters.DualAveragingStepSizeAdapter.finalize" title="Permalink to this definition">#</a></dt>
<dd><p>Update transition parameters based on final adapter state or states.</p>
<p>Optionally, if multiple adapter states are available, e.g. from a set of
independent adaptive chains, then these adaptation information from all the
chains may be combined to set the transition parameter(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adapt_states</strong> (<em>Union</em><em>[</em><em>AdapterState</em><em>, </em><em>Iterable</em><em>[</em><em>AdapterState</em><em>]</em><em>]</em>) – Final adapter state or a list of per chain adapter states.
Arrays / buffers associated with the adapter state entries may be
recycled to reduce memory usage - if so  the corresponding entries will
be removed from the adapter state dictionary / dictionaries.</p></li>
<li><p><strong>chain_states</strong> (<em>Union</em><em>[</em><a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a><em>, </em><em>Iterable</em><em>[</em><a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a><em>]</em><em>]</em>) – Final state of chain (or states of chains) in current
sampling stage. May be updated in-place if transition parameters altered
by adapter require updating any state components.</p></li>
<li><p><strong>transition</strong> (<a class="reference internal" href="mici.transitions.html#mici.transitions.Transition" title="mici.transitions.Transition"><em>Transition</em></a>) – Markov transition being dapted. Attributes of the transition or
child objects will be updated in-place by the method.</p></li>
<li><p><strong>rngs</strong> (<em>Union</em><em>[</em><em>Generator</em><em>, </em><em>Iterable</em><em>[</em><em>Generator</em><em>]</em><em>]</em>) – Random number generator for the chain or a list of per-chain random
number generators. Used to resample any components of states needing to
be updated due to adaptation if required.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.adapters.DualAveragingStepSizeAdapter.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chain_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/adapters.html#DualAveragingStepSizeAdapter.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.adapters.DualAveragingStepSizeAdapter.initialize" title="Permalink to this definition">#</a></dt>
<dd><p>Initialize adapter state prior to starting adaptive transitions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chain_state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – Initial chain state adaptive transition will be started from.
May be used to calculate initial adapter state but should not be mutated
by method.</p></li>
<li><p><strong>transition</strong> (<a class="reference internal" href="mici.transitions.html#mici.transitions.Transition" title="mici.transitions.Transition"><em>Transition</em></a>) – Markov transition being adapted. Attributes of the transition or
child objects may be updated in-place by the method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Initial adapter state.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>AdapterState</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mici.adapters.DualAveragingStepSizeAdapter.is_fast">
<span class="sig-name descname"><span class="pre">is_fast</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#mici.adapters.DualAveragingStepSizeAdapter.is_fast" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.adapters.DualAveragingStepSizeAdapter.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adapt_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chain_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trans_stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/adapters.html#DualAveragingStepSizeAdapter.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.adapters.DualAveragingStepSizeAdapter.update" title="Permalink to this definition">#</a></dt>
<dd><p>Update adapter state after sampling from transition being adapted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adapt_state</strong> (<em>AdapterState</em>) – Current adapter state. Entries will be updated in-place by the
method.</p></li>
<li><p><strong>chain_state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – Current chain state following sampling from transition being
adapted. May be used to calculate adapter state updates but should not
be mutated by method.</p></li>
<li><p><strong>trans_stats</strong> (<em>TransitionStatistics</em>) – Dictionary of statistics associated with transition being
adapted. May be used to calculate adapter state updates but should not
be mutated by method.</p></li>
<li><p><strong>transition</strong> (<a class="reference internal" href="mici.transitions.html#mici.transitions.Transition" title="mici.transitions.Transition"><em>Transition</em></a>) – Markov transition being adapted. Attributes of the transition or
child objects may be updated in-place by the method.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mici.adapters.OnlineCovarianceMetricAdapter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mici.adapters.</span></span><span class="sig-name descname"><span class="pre">OnlineCovarianceMetricAdapter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reg_iter_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/adapters.html#OnlineCovarianceMetricAdapter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.adapters.OnlineCovarianceMetricAdapter" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#mici.adapters.Adapter" title="mici.adapters.Adapter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Adapter</span></code></a></p>
<p>Dense metric adapter using online covariance estimates.</p>
<p>Uses Welford’s algorithm (Welford, 1962) to stably compute an online estimate of the
sample covariance matrix of the chain state position components during sampling. If
online estimates are available from multiple independent chains, the final
covariance matrix estimate is calculated from the per-chain statistics using a
covariance variant due to Schubert and Gertz (2018) of the parallel / batched
incremental variance algorithm described by Chan et al. (1979). The covariance
matrix estimates are optionally regularized towards a scaled identity matrix, with
increasing weight for small number of samples, to decrease the effect of noisy
estimates for small sample sizes, following the approach in Stan (Carpenter et al.,
2017). The metric matrix representation is set to a dense positive definite matrix
corresponding to the inverse of the (regularized) covariance matrix estimate.</p>
<p class="rubric">References</p>
<ol class="arabic simple">
<li><p>Welford, B. P. (1962). Note on a method for calculating corrected sums of
squares and products. Technometrics, 4(3), pp. 419-420.</p></li>
<li><p>Schubert, E. and Gertz, M. (2018). Numerically stable parallel computation of
(co-)variance. ACM. p. 10. doi:10.1145/3221269.3223036.</p></li>
<li><p>Chan, T. F., Golub, G. H. and LeVeque, R. J. (1979). Updating formulae and a
pairwise algorithm for computing sample variances. Technical Report
STAN-CS-79-773, Department of Computer Science, Stanford University.</p></li>
<li><p>Carpenter, B., Gelman, A., Hoffman, M.D., Lee, D., Goodrich, B., Betancourt,
M., Brubaker, M., Guo, J., Li, P. and Riddell, A.  (2017). Stan: A
probabilistic programming language. Journal of Statistical Software, 76(1).</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reg_iter_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Iteration offset used for calculating iteration
dependent weighting between regularisation target and current covariance
estimate. Higher values cause stronger regularisation during initial
iterations.</p></li>
<li><p><strong>reg_scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Positive scalar defining value variance estimates are
regularized towards.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mici.adapters.OnlineCovarianceMetricAdapter.finalize">
<span class="sig-name descname"><span class="pre">finalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adapt_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chain_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rngs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/adapters.html#OnlineCovarianceMetricAdapter.finalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.adapters.OnlineCovarianceMetricAdapter.finalize" title="Permalink to this definition">#</a></dt>
<dd><p>Update transition parameters based on final adapter state or states.</p>
<p>Optionally, if multiple adapter states are available, e.g. from a set of
independent adaptive chains, then these adaptation information from all the
chains may be combined to set the transition parameter(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adapt_states</strong> (<em>Union</em><em>[</em><em>AdapterState</em><em>, </em><em>Iterable</em><em>[</em><em>AdapterState</em><em>]</em><em>]</em>) – Final adapter state or a list of per chain adapter states.
Arrays / buffers associated with the adapter state entries may be
recycled to reduce memory usage - if so  the corresponding entries will
be removed from the adapter state dictionary / dictionaries.</p></li>
<li><p><strong>chain_states</strong> (<em>Union</em><em>[</em><a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a><em>, </em><em>Iterable</em><em>[</em><a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a><em>]</em><em>]</em>) – Final state of chain (or states of chains) in current
sampling stage. May be updated in-place if transition parameters altered
by adapter require updating any state components.</p></li>
<li><p><strong>transition</strong> (<a class="reference internal" href="mici.transitions.html#mici.transitions.Transition" title="mici.transitions.Transition"><em>Transition</em></a>) – Markov transition being dapted. Attributes of the transition or
child objects will be updated in-place by the method.</p></li>
<li><p><strong>rngs</strong> (<em>Union</em><em>[</em><em>Generator</em><em>, </em><em>Iterable</em><em>[</em><em>Generator</em><em>]</em><em>]</em>) – Random number generator for the chain or a list of per-chain random
number generators. Used to resample any components of states needing to
be updated due to adaptation if required.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.adapters.OnlineCovarianceMetricAdapter.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chain_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/adapters.html#OnlineCovarianceMetricAdapter.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.adapters.OnlineCovarianceMetricAdapter.initialize" title="Permalink to this definition">#</a></dt>
<dd><p>Initialize adapter state prior to starting adaptive transitions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chain_state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – Initial chain state adaptive transition will be started from.
May be used to calculate initial adapter state but should not be mutated
by method.</p></li>
<li><p><strong>transition</strong> (<a class="reference internal" href="mici.transitions.html#mici.transitions.Transition" title="mici.transitions.Transition"><em>Transition</em></a>) – Markov transition being adapted. Attributes of the transition or
child objects may be updated in-place by the method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Initial adapter state.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>AdapterState</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mici.adapters.OnlineCovarianceMetricAdapter.is_fast">
<span class="sig-name descname"><span class="pre">is_fast</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#mici.adapters.OnlineCovarianceMetricAdapter.is_fast" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.adapters.OnlineCovarianceMetricAdapter.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adapt_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chain_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trans_stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/adapters.html#OnlineCovarianceMetricAdapter.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.adapters.OnlineCovarianceMetricAdapter.update" title="Permalink to this definition">#</a></dt>
<dd><p>Update adapter state after sampling from transition being adapted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adapt_state</strong> (<em>AdapterState</em>) – Current adapter state. Entries will be updated in-place by the
method.</p></li>
<li><p><strong>chain_state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – Current chain state following sampling from transition being
adapted. May be used to calculate adapter state updates but should not
be mutated by method.</p></li>
<li><p><strong>trans_stats</strong> (<em>TransitionStatistics</em>) – Dictionary of statistics associated with transition being
adapted. May be used to calculate adapter state updates but should not
be mutated by method.</p></li>
<li><p><strong>transition</strong> (<a class="reference internal" href="mici.transitions.html#mici.transitions.Transition" title="mici.transitions.Transition"><em>Transition</em></a>) – Markov transition being adapted. Attributes of the transition or
child objects may be updated in-place by the method.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mici.adapters.OnlineVarianceMetricAdapter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mici.adapters.</span></span><span class="sig-name descname"><span class="pre">OnlineVarianceMetricAdapter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reg_iter_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/adapters.html#OnlineVarianceMetricAdapter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.adapters.OnlineVarianceMetricAdapter" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#mici.adapters.Adapter" title="mici.adapters.Adapter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Adapter</span></code></a></p>
<p>Diagonal metric adapter using online variance estimates.</p>
<p>Uses Welford’s algorithm (Welford, 1962) to stably compute an online estimate of the
sample variances of the chain state position components during sampling. If online
estimates are available from multiple independent chains, the final variance
estimate is calculated from the per-chain statistics using the parallel / batched
incremental variance algorithm described by Chan et al. (1979). The variance
estimates are optionally regularized towards a common scalar value, with increasing
weight for small number of samples, to decrease the effect of noisy estimates for
small sample sizes, following the approach in Stan (Carpenter et al., 2017). The
metric matrix representation is set to a diagonal matrix with diagonal elements
corresponding to the reciprocal of the (regularized) variance estimates.</p>
<p class="rubric">References</p>
<ol class="arabic simple">
<li><p>Welford, B. P. (1962). Note on a method for calculating corrected sums of
squares and products. Technometrics, 4(3), pp. 419-420.</p></li>
<li><p>Chan, T. F., Golub, G. H. and LeVeque, R. J. (1979). Updating formulae and a
pairwise algorithm for computing sample variances. Technical Report
STAN-CS-79-773, Department of Computer Science, Stanford University.</p></li>
<li><p>Carpenter, B., Gelman, A., Hoffman, M.D., Lee, D., Goodrich, B., Betancourt,
M., Brubaker, M., Guo, J., Li, P. and Riddell, A.  (2017). Stan: A
probabilistic programming language. Journal of Statistical Software, 76(1).</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reg_iter_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Iteration offset used for calculating iteration dependent
weighting between regularisation target and current covariance estimate.
Higher values cause stronger regularisation during initial iterations. A
value of zero corresponds to no regularisation; this should only be used
if the sample covariance is guaranteed to be positive definite.</p></li>
<li><p><strong>reg_scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Positive scalar defining value variance estimates are regularized
towards.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mici.adapters.OnlineVarianceMetricAdapter.finalize">
<span class="sig-name descname"><span class="pre">finalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adapt_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chain_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rngs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/adapters.html#OnlineVarianceMetricAdapter.finalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.adapters.OnlineVarianceMetricAdapter.finalize" title="Permalink to this definition">#</a></dt>
<dd><p>Update transition parameters based on final adapter state or states.</p>
<p>Optionally, if multiple adapter states are available, e.g. from a set of
independent adaptive chains, then these adaptation information from all the
chains may be combined to set the transition parameter(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adapt_states</strong> (<em>Union</em><em>[</em><em>AdapterState</em><em>, </em><em>Iterable</em><em>[</em><em>AdapterState</em><em>]</em><em>]</em>) – Final adapter state or a list of per chain adapter states.
Arrays / buffers associated with the adapter state entries may be
recycled to reduce memory usage - if so  the corresponding entries will
be removed from the adapter state dictionary / dictionaries.</p></li>
<li><p><strong>chain_states</strong> (<em>Union</em><em>[</em><a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a><em>, </em><em>Iterable</em><em>[</em><a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a><em>]</em><em>]</em>) – Final state of chain (or states of chains) in current
sampling stage. May be updated in-place if transition parameters altered
by adapter require updating any state components.</p></li>
<li><p><strong>transition</strong> (<a class="reference internal" href="mici.transitions.html#mici.transitions.Transition" title="mici.transitions.Transition"><em>Transition</em></a>) – Markov transition being dapted. Attributes of the transition or
child objects will be updated in-place by the method.</p></li>
<li><p><strong>rngs</strong> (<em>Union</em><em>[</em><em>Generator</em><em>, </em><em>Iterable</em><em>[</em><em>Generator</em><em>]</em><em>]</em>) – Random number generator for the chain or a list of per-chain random
number generators. Used to resample any components of states needing to
be updated due to adaptation if required.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.adapters.OnlineVarianceMetricAdapter.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chain_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/adapters.html#OnlineVarianceMetricAdapter.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.adapters.OnlineVarianceMetricAdapter.initialize" title="Permalink to this definition">#</a></dt>
<dd><p>Initialize adapter state prior to starting adaptive transitions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chain_state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – Initial chain state adaptive transition will be started from.
May be used to calculate initial adapter state but should not be mutated
by method.</p></li>
<li><p><strong>transition</strong> (<a class="reference internal" href="mici.transitions.html#mici.transitions.Transition" title="mici.transitions.Transition"><em>Transition</em></a>) – Markov transition being adapted. Attributes of the transition or
child objects may be updated in-place by the method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Initial adapter state.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>AdapterState</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mici.adapters.OnlineVarianceMetricAdapter.is_fast">
<span class="sig-name descname"><span class="pre">is_fast</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#mici.adapters.OnlineVarianceMetricAdapter.is_fast" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.adapters.OnlineVarianceMetricAdapter.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adapt_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chain_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trans_stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/adapters.html#OnlineVarianceMetricAdapter.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.adapters.OnlineVarianceMetricAdapter.update" title="Permalink to this definition">#</a></dt>
<dd><p>Update adapter state after sampling from transition being adapted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adapt_state</strong> (<em>AdapterState</em>) – Current adapter state. Entries will be updated in-place by the
method.</p></li>
<li><p><strong>chain_state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – Current chain state following sampling from transition being
adapted. May be used to calculate adapter state updates but should not
be mutated by method.</p></li>
<li><p><strong>trans_stats</strong> (<em>TransitionStatistics</em>) – Dictionary of statistics associated with transition being
adapted. May be used to calculate adapter state updates but should not
be mutated by method.</p></li>
<li><p><strong>transition</strong> (<a class="reference internal" href="mici.transitions.html#mici.transitions.Transition" title="mici.transitions.Transition"><em>Transition</em></a>) – Markov transition being adapted. Attributes of the transition or
child objects may be updated in-place by the method.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mici.adapters.arithmetic_mean_log_step_size_reducer">
<span class="sig-prename descclassname"><span class="pre">mici.adapters.</span></span><span class="sig-name descname"><span class="pre">arithmetic_mean_log_step_size_reducer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_step_sizes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/adapters.html#arithmetic_mean_log_step_size_reducer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.adapters.arithmetic_mean_log_step_size_reducer" title="Permalink to this definition">#</a></dt>
<dd><p>Compute arithmetic mean of step sizes from their logs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>log_step_sizes</strong> (<em>Collection</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>]</em>) – Logarithms of per-chain estimated step sizes.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Arithmetic mean of estimated step sizes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mici.adapters.default_adapt_stat_func">
<span class="sig-prename descclassname"><span class="pre">mici.adapters.</span></span><span class="sig-name descname"><span class="pre">default_adapt_stat_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stats</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/adapters.html#default_adapt_stat_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.adapters.default_adapt_stat_func" title="Permalink to this definition">#</a></dt>
<dd><p>Function to extract default statistic used for step-size adaptation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>stats</strong> (<em>TransitionStatistics</em>) – Dictionary of transition statistics.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Acceptance statistic.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mici.adapters.geometric_mean_log_step_size_reducer">
<span class="sig-prename descclassname"><span class="pre">mici.adapters.</span></span><span class="sig-name descname"><span class="pre">geometric_mean_log_step_size_reducer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_step_sizes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/adapters.html#geometric_mean_log_step_size_reducer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.adapters.geometric_mean_log_step_size_reducer" title="Permalink to this definition">#</a></dt>
<dd><p>Compute geometric mean of step sizes from their logs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>log_step_sizes</strong> (<em>Collection</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>]</em>) – Logarithms of per-chain estimated step sizes.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Geometric mean of estimated step sizes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mici.adapters.min_log_step_size_reducer">
<span class="sig-prename descclassname"><span class="pre">mici.adapters.</span></span><span class="sig-name descname"><span class="pre">min_log_step_size_reducer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_step_sizes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/adapters.html#min_log_step_size_reducer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.adapters.min_log_step_size_reducer" title="Permalink to this definition">#</a></dt>
<dd><p>Compute minimum of step sizes from their logs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>log_step_sizes</strong> (<em>Collection</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>]</em>) – Logarithms of per-chain estimated step sizes.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Minimum of estimated step sizes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a></p>
</dd>
</dl>
</dd></dl>

</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="mici.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">mici package</p>
      </div>
    </a>
    <a class="right-next"
       href="mici.autodiff.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">mici.autodiff module</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.adapters.Adapter"><code class="docutils literal notranslate"><span class="pre">Adapter</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.adapters.Adapter.finalize"><code class="docutils literal notranslate"><span class="pre">Adapter.finalize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.adapters.Adapter.initialize"><code class="docutils literal notranslate"><span class="pre">Adapter.initialize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.adapters.Adapter.is_fast"><code class="docutils literal notranslate"><span class="pre">Adapter.is_fast</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.adapters.Adapter.update"><code class="docutils literal notranslate"><span class="pre">Adapter.update()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.adapters.DualAveragingStepSizeAdapter"><code class="docutils literal notranslate"><span class="pre">DualAveragingStepSizeAdapter</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.adapters.DualAveragingStepSizeAdapter.finalize"><code class="docutils literal notranslate"><span class="pre">DualAveragingStepSizeAdapter.finalize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.adapters.DualAveragingStepSizeAdapter.initialize"><code class="docutils literal notranslate"><span class="pre">DualAveragingStepSizeAdapter.initialize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.adapters.DualAveragingStepSizeAdapter.is_fast"><code class="docutils literal notranslate"><span class="pre">DualAveragingStepSizeAdapter.is_fast</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.adapters.DualAveragingStepSizeAdapter.update"><code class="docutils literal notranslate"><span class="pre">DualAveragingStepSizeAdapter.update()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.adapters.OnlineCovarianceMetricAdapter"><code class="docutils literal notranslate"><span class="pre">OnlineCovarianceMetricAdapter</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.adapters.OnlineCovarianceMetricAdapter.finalize"><code class="docutils literal notranslate"><span class="pre">OnlineCovarianceMetricAdapter.finalize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.adapters.OnlineCovarianceMetricAdapter.initialize"><code class="docutils literal notranslate"><span class="pre">OnlineCovarianceMetricAdapter.initialize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.adapters.OnlineCovarianceMetricAdapter.is_fast"><code class="docutils literal notranslate"><span class="pre">OnlineCovarianceMetricAdapter.is_fast</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.adapters.OnlineCovarianceMetricAdapter.update"><code class="docutils literal notranslate"><span class="pre">OnlineCovarianceMetricAdapter.update()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.adapters.OnlineVarianceMetricAdapter"><code class="docutils literal notranslate"><span class="pre">OnlineVarianceMetricAdapter</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.adapters.OnlineVarianceMetricAdapter.finalize"><code class="docutils literal notranslate"><span class="pre">OnlineVarianceMetricAdapter.finalize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.adapters.OnlineVarianceMetricAdapter.initialize"><code class="docutils literal notranslate"><span class="pre">OnlineVarianceMetricAdapter.initialize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.adapters.OnlineVarianceMetricAdapter.is_fast"><code class="docutils literal notranslate"><span class="pre">OnlineVarianceMetricAdapter.is_fast</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.adapters.OnlineVarianceMetricAdapter.update"><code class="docutils literal notranslate"><span class="pre">OnlineVarianceMetricAdapter.update()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.adapters.arithmetic_mean_log_step_size_reducer"><code class="docutils literal notranslate"><span class="pre">arithmetic_mean_log_step_size_reducer()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.adapters.default_adapt_stat_func"><code class="docutils literal notranslate"><span class="pre">default_adapt_stat_func()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.adapters.geometric_mean_log_step_size_reducer"><code class="docutils literal notranslate"><span class="pre">geometric_mean_log_step_size_reducer()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.adapters.min_log_step_size_reducer"><code class="docutils literal notranslate"><span class="pre">min_log_step_size_reducer()</span></code></a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="_sources/mici.adapters.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2023, Matt Graham.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.1.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>