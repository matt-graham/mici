
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>mici.systems module &#8212; Mici 0.2.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=938c9ccc"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'mici.systems';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="mici.transitions module" href="mici.transitions.html" />
    <link rel="prev" title="mici.states module" href="mici.states.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/mici-logo-rectangular.svg" class="logo__image only-light" alt="Mici 0.2.0 documentation - Home"/>
    <img src="_static/mici-logo-rectangular-light-text.svg" class="logo__image only-dark pst-js-only" alt="Mici 0.2.0 documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="mici.html">
    mici package
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/matt-graham/mici" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="mici.html">
    mici package
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/matt-graham/mici" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="mici.autodiff.html">mici.autodiff package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="mici.autodiff.autograd_wrapper.html">mici.autodiff.autograd_wrapper module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mici.autodiff.jax_wrapper.html">mici.autodiff.jax_wrapper module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mici.autodiff.symnum_wrapper.html">mici.autodiff.symnum_wrapper module</a></li>
</ul>
</details></li>
</ul>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="mici.adapters.html">mici.adapters module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.errors.html">mici.errors module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.integrators.html">mici.integrators module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.interop.html">mici.interop module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.matrices.html">mici.matrices module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.progressbars.html">mici.progressbars module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.samplers.html">mici.samplers module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.solvers.html">mici.solvers module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.stagers.html">mici.stagers module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.states.html">mici.states module</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">mici.systems module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.transitions.html">mici.transitions module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.types.html">mici.types module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.utils.html">mici.utils module</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="mici.html" class="nav-link">mici package</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">mici.systems module</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-mici.systems">
<span id="mici-systems-module"></span><h1>mici.systems module<a class="headerlink" href="#module-mici.systems" title="Link to this heading">#</a></h1>
<p>Hamiltonian systems encapsulating energy functions and their derivatives.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mici.systems.CholeskyFactoredRiemannianMetricSystem">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mici.systems.</span></span><span class="sig-name descname"><span class="pre">CholeskyFactoredRiemannianMetricSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neg_log_dens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_chol_func</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">vjp_metric_chol_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_neg_log_dens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#CholeskyFactoredRiemannianMetricSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#mici.systems.RiemannianMetricSystem" title="mici.systems.RiemannianMetricSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">RiemannianMetricSystem</span></code></a></p>
<p>Riemannian-metric system with Cholesky-factored matrix representation.</p>
<p>Hamiltonian system with a position dependent metric matrix representation which is
specified by its Cholesky factor by a matrix function <cite>metric_chol_func</cite> of the
position <cite>q</cite> which outputs a lower-triangular matrix <cite>L = metric_chol_func(q)</cite> with
the metric matrix representation then taken to be <cite>L &#64; L.T</cite>.</p>
<p>See documentation of <cite>RiemannianMetricSystem</cite> for more general details about
Riemannian-metric Hamiltonian systems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neg_log_dens</strong> (<em>ScalarFunction</em>) – Function which given a position array returns the negative
logarithm of an unnormalized probability density on the position space
with respect to the Lebesgue measure, with the corresponding
distribution on the position space being the target distribution it is
wished to draw approximate samples from.</p></li>
<li><p><strong>metric_chol_func</strong> (<em>ArrayFunction</em>) – Function which given a position array returns a 2D array
with zeros above the diagonal corresponding to the lower-triangular
Cholesky-factor of the positive definite metric matrix representation.</p></li>
<li><p><strong>vjp_metric_chol_func</strong> (<em>VectorJacobianProductFunction</em><em> | </em><em>None</em>) – <p>Function which given a position array returns another
function which takes a lower-triangular 2D array as an argument (any
values in the array above the diagonal are ignored) and returns the
<em>vector-Jacobian-product</em> (VJP) of <cite>metric_chol_func</cite> with respect to
the position array argument. The VJP is here defined as a function of a
2D array <cite>v</cite>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vjp</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">v</span><span class="p">[:,</span> <span class="p">:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">jacob</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<p>where <cite>jacob</cite> is the <cite>(dim_pos, dim_pos, dim_pos)</cite> shaped Jacobian of <cite>L
= metric_chol_func(q)</cite> with respect to <cite>q</cite> i.e. the array of partial
derivatives of the function such that</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>jacob[i, j, k] = ∂L[i, j] / ∂q[k]
</pre></div>
</div>
<p>Optionally the function may instead return a 2-tuple of values with the
first a function to compute a VJP of <cite>metric_chol_func</cite> and the second a
2D array containing the value of <cite>metric_chol_func</cite>, both evaluated at
the passed position array. If <cite>None</cite> is passed (the default) an
automatic differentiation fallback will be used to attempt to construct
a function which calculates the VJP (and value) of <cite>metric_chol_func</cite>
automatically.</p>
</p></li>
<li><p><strong>grad_neg_log_dens</strong> (<em>GradientFunction</em><em> | </em><em>None</em>) – Function which given a position array returns the
derivative of <cite>neg_log_dens</cite> with respect to the position array
argument. Optionally the function may instead return a 2-tuple of values
with the first being the array corresponding to the derivative and the
second being the value of the <cite>neg_log_dens</cite> evaluated at the passed
position array. If <cite>None</cite> is passed (the default) an automatic
differentiation fallback will be used to attempt to construct the
derivative of <cite>neg_log_dens</cite> automatically.</p></li>
<li><p><strong>backend</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – Name of automatic differentiation backend to use. See
<a class="reference internal" href="mici.autodiff.html#module-mici.autodiff" title="mici.autodiff"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autodiff</span></code></a> subpackage documentation for details of available
backends. If <cite>None</cite> (the default) no automatic differentiation fallback
will be used and so all derivative functions must be specified
explicitly.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.CholeskyFactoredRiemannianMetricSystem.dh1_dpos">
<span class="sig-name descname"><span class="pre">dh1_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.dh1_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h1</cite> Hamiltonian component with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of computed <cite>h1</cite> derivative.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.CholeskyFactoredRiemannianMetricSystem.dh2_dmom">
<span class="sig-name descname"><span class="pre">dh2_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.dh2_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h2</cite> Hamiltonian component with respect to momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2(state)</cite> derivative with respect to <cite>state.mom</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.CholeskyFactoredRiemannianMetricSystem.dh2_dpos">
<span class="sig-name descname"><span class="pre">dh2_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.dh2_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h2</cite> Hamiltonian component with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.CholeskyFactoredRiemannianMetricSystem.dh_dmom">
<span class="sig-name descname"><span class="pre">dh_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.dh_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivative of Hamiltonian with respect to momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h(state)</cite> derivative with respect to <cite>state.mom</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.CholeskyFactoredRiemannianMetricSystem.dh_dpos">
<span class="sig-name descname"><span class="pre">dh_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.dh_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of Hamiltonian with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.CholeskyFactoredRiemannianMetricSystem.grad_neg_log_dens">
<span class="sig-name descname"><span class="pre">grad_neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.grad_neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Derivative of negative log density with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>neg_log_dens(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.CholeskyFactoredRiemannianMetricSystem.h">
<span class="sig-name descname"><span class="pre">h</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.h" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian function for system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of Hamiltonian.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.CholeskyFactoredRiemannianMetricSystem.h1">
<span class="sig-name descname"><span class="pre">h1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.h1" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian component depending only on position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h1</cite> Hamiltonian component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.CholeskyFactoredRiemannianMetricSystem.h1_flow">
<span class="sig-name descname"><span class="pre">h1_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.h1_flow" title="Link to this definition">#</a></dt>
<dd><p>Apply exact flow map corresponding to <cite>h1</cite> Hamiltonian component.</p>
<p><cite>state</cite> argument is modified in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to start flow at.</p></li>
<li><p><strong>dt</strong> (<em>ScalarLike</em>) – Time interval to simulate flow for.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.CholeskyFactoredRiemannianMetricSystem.h2">
<span class="sig-name descname"><span class="pre">h2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.h2" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian component depending on momentum and optionally position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2</cite> Hamiltonian component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.CholeskyFactoredRiemannianMetricSystem.metric">
<span class="sig-name descname"><span class="pre">metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.metric" title="Link to this definition">#</a></dt>
<dd><p>Function computing the metric matrix representation.</p>
<p>The returned type of this function is that specified by the
<cite>metric_matrix_class</cite> argument to the initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Metric matrix representation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="mici.matrices.html#mici.matrices.PositiveDefiniteMatrix" title="mici.matrices.PositiveDefiniteMatrix"><em>PositiveDefiniteMatrix</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.CholeskyFactoredRiemannianMetricSystem.metric_func">
<span class="sig-name descname"><span class="pre">metric_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.metric_func" title="Link to this definition">#</a></dt>
<dd><p>Function computing the parameter of the metric matrix representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>metric_func(state.pos)</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.CholeskyFactoredRiemannianMetricSystem.neg_log_dens">
<span class="sig-name descname"><span class="pre">neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Negative logarithm of unnormalized density of target distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of computed negative log density.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.CholeskyFactoredRiemannianMetricSystem.sample_momentum">
<span class="sig-name descname"><span class="pre">sample_momentum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.sample_momentum" title="Link to this definition">#</a></dt>
<dd><p>Sample a momentum from its conditional distribution given a position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State defining position to condition on.</p></li>
<li><p><strong>rng</strong> (<em>Generator</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sampled momentum.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.CholeskyFactoredRiemannianMetricSystem.vjp_metric_func">
<span class="sig-name descname"><span class="pre">vjp_metric_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.vjp_metric_func" title="Link to this definition">#</a></dt>
<dd><p>Function constructing a vector-Jacobian-product for <cite>metric_func</cite>.</p>
<p>The vector-Jacobian-product is here defined as a function of an array <cite>v</cite> (of
the same shape as the output of <cite>metric_func</cite>) corresponding to</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vjp</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">jacob</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ndim</span><span class="p">))</span>
</pre></div>
</div>
<p>where <cite>jacob</cite> is the Jacobian of <cite>m = metric_func(q)</cite> wrt <cite>q</cite> i.e. the array of
partial derivatives of the function such that</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>jacob[..., i] = ∂m[...] / ∂q[i]
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute VJP at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Vector-Jacobian-product function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>VectorJacobianProduct</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mici.systems.ConstrainedEuclideanMetricSystem">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mici.systems.</span></span><span class="sig-name descname"><span class="pre">ConstrainedEuclideanMetricSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neg_log_dens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constr</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dens_wrt_hausdorff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_neg_log_dens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jacob_constr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#ConstrainedEuclideanMetricSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.ConstrainedEuclideanMetricSystem" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#mici.systems.ConstrainedTractableFlowSystem" title="mici.systems.ConstrainedTractableFlowSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstrainedTractableFlowSystem</span></code></a>, <a class="reference internal" href="#mici.systems.EuclideanMetricSystem" title="mici.systems.EuclideanMetricSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">EuclideanMetricSystem</span></code></a></p>
<p>Base class for Euclidean Hamiltonian systems subject to constraints.</p>
<p>The (constrained) position space is assumed to be a differentiable manifold embedded
with a <span class="math notranslate nohighlight">\(Q\)</span>-dimensional ambient Euclidean space. The <span class="math notranslate nohighlight">\(Q-C\)</span> dimensional
manifold <span class="math notranslate nohighlight">\(\mathcal{M}\)</span> is implicitly defined by an equation
<span class="math notranslate nohighlight">\(\mathcal{M} = \lbrace q \in \mathbb{R}^Q : c(q) = 0 \rbrace\)</span> with
<span class="math notranslate nohighlight">\(c: \mathbb{R}^Q \to \mathbb{R}^C\)</span> the <em>constraint function</em>.</p>
<p>The ambient Euclidean space is assumed to be equipped with a metric with constant
positive-definite matrix representation <span class="math notranslate nohighlight">\(M\)</span> which further specifies the
covariance of the zero-mean Gaussian distribution <span class="math notranslate nohighlight">\(\mathcal{N}(0, M)\)</span> on the
<em>unconstrained</em> momentum (co-)vector <span class="math notranslate nohighlight">\(p\)</span> with corresponding <span class="math notranslate nohighlight">\(h_2\)</span>
Hamiltonian component defined as</p>
<div class="math notranslate nohighlight">
\[h_2(q, p) = \frac{1}{2} p^T M^{-1} p.\]</div>
<p>The time-derivative of the constraint equation implies a further set of constraints
on the momentum <span class="math notranslate nohighlight">\(p\)</span> with <span class="math notranslate nohighlight">\(\partial c(q) M^{-1} p = 0\)</span> at all time
points, corresponding to the momentum (velocity) being in the co-tangent space
(tangent space) to the manifold.</p>
<p>The target distribution is either assumed to be directly specified with unnormalized
density <span class="math notranslate nohighlight">\(\exp(-\ell(q))\)</span> with respect to the Hausdorff measure on the manifold
(under the metric induced from the ambient metric) with in this case the <span class="math notranslate nohighlight">\(h_1\)</span>
Hamiltonian component then simply</p>
<div class="math notranslate nohighlight">
\[h_1(q) = \ell(q),\]</div>
<p>or alternatively it is assumed a prior distribution on the position <span class="math notranslate nohighlight">\(q\)</span> with
density <span class="math notranslate nohighlight">\(\exp(-\ell(q))\)</span> with respect to the Lebesgue measure on the ambient
space is specifed and the target distribution is the posterior distribution on
<span class="math notranslate nohighlight">\(q\)</span> when conditioning on the event <span class="math notranslate nohighlight">\(c(q) = 0\)</span>. The negative logarithm of
the posterior distribution density with respect to the Hausdorff measure (and so
<span class="math notranslate nohighlight">\(h_1\)</span> Hamiltonian component) is then</p>
<div class="math notranslate nohighlight">
\[h_1(q) =
\ell(q) + \frac{1}{2} \log\left|\partial c(q)M^{-1}\partial c(q)^T\right|\]</div>
<p>with an additional second <em>Gram matrix</em> determinant term to give the correct density
with respect to the Hausdorff measure on the manifold.</p>
<p>Due to the requirement to enforce the constraints on the position and momentum, a
constraint-preserving numerical integrator needs to be used when simulating the
Hamiltonian dynamic associated with the system, e.g.
<a class="reference internal" href="mici.integrators.html#mici.integrators.ConstrainedLeapfrogIntegrator" title="mici.integrators.ConstrainedLeapfrogIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">mici.integrators.ConstrainedLeapfrogIntegrator</span></code></a>.</p>
<p class="rubric">References</p>
<ol class="arabic simple">
<li><p>Lelièvre, T., Rousset, M. and Stoltz, G., 2019. Hybrid Monte Carlo methods for
sampling probability measures on submanifolds. Numerische Mathematik, 143(2),
pp.379-421.</p></li>
<li><p>Graham, M.M. and Storkey, A.J., 2017. Asymptotically exact inference in
differentiable generative models. Electronic Journal of Statistics, 11(2),
pp.5105-5164.</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neg_log_dens</strong> (<em>ScalarFunction</em>) – Function which given a position array returns the negative
logarithm of an unnormalized probability density on the constrained
position space with respect to the Hausdorff measure on the constraint
manifold (if <code class="code docutils literal notranslate"><span class="pre">dens_wrt_hausdorff</span> <span class="pre">==</span> <span class="pre">True</span></code>) or alternatively the
negative logarithm of an unnormalized probability density on the
unconstrained (ambient) position space with respect to the Lebesgue
measure. In the former case the target distribution it is wished to draw
approximate samples from is assumed to be directly specified by the
density function on the manifold. In the latter case the density
function is instead taken to specify a prior distribution on the ambient
space with the target distribution then corresponding to the posterior
distribution when conditioning on the (zero Lebesgue measure) event
<code class="code docutils literal notranslate"><span class="pre">constr(q)</span> <span class="pre">==</span> <span class="pre">0</span></code> where <code class="code docutils literal notranslate"><span class="pre">q</span></code> is the position array. This
target posterior distribution has support on the differentiable manifold
implicitly defined by the constraint equation, with density with respect
to the Hausdorff measure on the manifold corresponding to the ratio of
the prior density (specified by <code class="code docutils literal notranslate"><span class="pre">neg_log_dens</span></code>) and the
square-root of the determinant of the Gram matrix defined by
<code class="code docutils literal notranslate"><span class="pre">gram(q)</span> <span class="pre">=</span> <span class="pre">jacob_constr(q)</span> <span class="pre">&#64;</span> <span class="pre">inv(metric)</span> <span class="pre">&#64;</span> <span class="pre">jacob_constr(q).T</span></code>
where <code class="code docutils literal notranslate"><span class="pre">jacob_constr</span></code> is the Jacobian of the constraint function
<code class="code docutils literal notranslate"><span class="pre">constr</span></code> and <code class="code docutils literal notranslate"><span class="pre">metric</span></code> is the matrix representation of the
metric on the ambient space.</p></li>
<li><p><strong>constr</strong> (<em>ArrayFunction</em>) – Function which given a position array return as a 1D array the value
of the (vector-valued) constraint function, the zero level-set of which
implicitly defines the manifold the dynamic is simulated on.</p></li>
<li><p><strong>metric</strong> (<em>MetricLike</em><em> | </em><em>None</em>) – Matrix object corresponding to matrix representation of metric on
<em>unconstrained</em> position space and covariance of Gaussian marginal
distribution on <em>unconstrained</em> momentum vector. If <code class="code docutils literal notranslate"><span class="pre">None</span></code> is
passed (the default), the identity matrix will be used. If a 1D array is
passed then this is assumed to specify a metric with positive diagonal
matrix representation and the array the matrix diagonal. If a 2D array
is passed then this is assumed to specify a metric with a dense positive
definite matrix representation specified by the array. Otherwise if the
value is a <a class="reference internal" href="mici.matrices.html#mici.matrices.PositiveDefiniteMatrix" title="mici.matrices.PositiveDefiniteMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">mici.matrices.PositiveDefiniteMatrix</span></code></a> subclass it
is assumed to directly specify the metric matrix representation.</p></li>
<li><p><strong>dens_wrt_hausdorff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether the <code class="code docutils literal notranslate"><span class="pre">neg_log_dens</span></code> function specifies the
(negative logarithm) of the density of the target distribution with
respect to the Hausdorff measure on the manifold directly (<code class="code docutils literal notranslate"><span class="pre">True</span></code>)
or alternatively the negative logarithm of a density of a prior
distriubtion on the unconstrained (ambient) position space with respect
to the Lebesgue measure, with the target distribution then corresponding
to the posterior distribution when conditioning on the event
<code class="code docutils literal notranslate"><span class="pre">constr(pos)</span> <span class="pre">==</span> <span class="pre">0</span></code> (<code class="code docutils literal notranslate"><span class="pre">False</span></code>). Note that in the former case
the base Hausdorff measure on the manifold depends on the metric defined
on the ambient space, with the Hausdorff measure being defined with
respect to the metric induced on the manifold from this ambient metric.</p></li>
<li><p><strong>grad_neg_log_dens</strong> (<em>GradientFunction</em><em> | </em><em>None</em>) – Function which given a position array returns the
derivative of <code class="code docutils literal notranslate"><span class="pre">neg_log_dens</span></code> with respect to the position array
argument. Optionally the function may instead return a 2-tuple of values
with the first being the array corresponding to the derivative and the
second being the value of the <code class="code docutils literal notranslate"><span class="pre">neg_log_dens</span></code> evaluated at the
passed position array. If <code class="code docutils literal notranslate"><span class="pre">None</span></code> is passed (the default) an
automatic differentiation fallback will be used to attempt to construct
a function to compute the derivative (and value) of <code class="code docutils literal notranslate"><span class="pre">neg_log_dens</span></code>
automatically.</p></li>
<li><p><strong>jacob_constr</strong> (<em>JacobianFunction</em><em> | </em><em>None</em>) – Function which given a position array computes the Jacobian
(matrix / 2D array of partial derivatives) of the output of the
constraint function <code class="code docutils literal notranslate"><span class="pre">c</span> <span class="pre">=</span> <span class="pre">constr(q)</span></code> with respect to the position
array argument <code class="code docutils literal notranslate"><span class="pre">q</span></code>, returning the computed Jacobian as a 2D array
<code class="code docutils literal notranslate"><span class="pre">jacob</span></code> with <code class="code docutils literal notranslate"><span class="pre">jacob[i,</span> <span class="pre">j]</span> <span class="pre">=</span> <span class="pre">∂c[i]</span> <span class="pre">/</span> <span class="pre">∂q[j]</span></code>. Optionally the
function may instead return a 2-tuple of values with the first being the
array corresponding to the Jacobian and the second being the value of
<code class="code docutils literal notranslate"><span class="pre">constr</span></code> evaluated at the passed position array. If <code class="code docutils literal notranslate"><span class="pre">None</span></code>
is passed (the default) an automatic differentiation fallback will be
used to attempt to construct a function to compute the Jacobian (and
value) of <code class="code docutils literal notranslate"><span class="pre">constr</span></code>
automatically.</p></li>
<li><p><strong>backend</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – Name of automatic differentiation backend to use. See
<a class="reference internal" href="mici.autodiff.html#module-mici.autodiff" title="mici.autodiff"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autodiff</span></code></a> subpackage documentation for details of available
backends. If <cite>None</cite> (the default) no automatic differentiation fallback
will be used and so all derivative functions must be specified
explicitly.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedEuclideanMetricSystem.constr">
<span class="sig-name descname"><span class="pre">constr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#ConstrainedEuclideanMetricSystem.constr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.ConstrainedEuclideanMetricSystem.constr" title="Link to this definition">#</a></dt>
<dd><p>Constraint function at the current position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <code class="code docutils literal notranslate"><span class="pre">constr(state.pos)</span></code> as 1D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedEuclideanMetricSystem.dh1_dpos">
<span class="sig-name descname"><span class="pre">dh1_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#ConstrainedEuclideanMetricSystem.dh1_dpos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.ConstrainedEuclideanMetricSystem.dh1_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h1</cite> Hamiltonian component with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of computed <cite>h1</cite> derivative.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedEuclideanMetricSystem.dh2_dmom">
<span class="sig-name descname"><span class="pre">dh2_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ConstrainedEuclideanMetricSystem.dh2_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h2</cite> Hamiltonian component with respect to momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2(state)</cite> derivative with respect to <cite>state.mom</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedEuclideanMetricSystem.dh2_dpos">
<span class="sig-name descname"><span class="pre">dh2_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ConstrainedEuclideanMetricSystem.dh2_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h2</cite> Hamiltonian component with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedEuclideanMetricSystem.dh2_flow_dmom">
<span class="sig-name descname"><span class="pre">dh2_flow_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#ConstrainedEuclideanMetricSystem.dh2_flow_dmom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.ConstrainedEuclideanMetricSystem.dh2_flow_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivatives of <a class="reference internal" href="#mici.systems.ConstrainedEuclideanMetricSystem.h2_flow" title="mici.systems.ConstrainedEuclideanMetricSystem.h2_flow"><code class="xref py py-meth docutils literal notranslate"><span class="pre">h2_flow()</span></code></a> flow map with respect to momentum argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to evaluate derivatives of flow map at.</p></li>
<li><p><strong>dt</strong> (<em>ScalarLike</em>) – Time interval flow simulated for.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple <code class="code docutils literal notranslate"><span class="pre">(dpos_dmom,</span> <span class="pre">dmom_dmom)</span></code> with <code class="code docutils literal notranslate"><span class="pre">dpos_dmom</span></code> a matrix
representing derivative (Jacobian) of position output of <a class="reference internal" href="#mici.systems.ConstrainedEuclideanMetricSystem.h2_flow" title="mici.systems.ConstrainedEuclideanMetricSystem.h2_flow"><code class="xref py py-meth docutils literal notranslate"><span class="pre">h2_flow()</span></code></a>
with respect to the value of the momentum component of the initial input
state and <code class="code docutils literal notranslate"><span class="pre">dmom_dmom</span></code> a matrix representing derivative (Jacobian) of
momentum output of <a class="reference internal" href="#mici.systems.ConstrainedEuclideanMetricSystem.h2_flow" title="mici.systems.ConstrainedEuclideanMetricSystem.h2_flow"><code class="xref py py-meth docutils literal notranslate"><span class="pre">h2_flow()</span></code></a> with respect to the value of the
momentum component of the initial input state.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a>[<a class="reference internal" href="mici.matrices.html#mici.matrices.Matrix" title="mici.matrices.Matrix"><em>Matrix</em></a>, <a class="reference internal" href="mici.matrices.html#mici.matrices.Matrix" title="mici.matrices.Matrix"><em>Matrix</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedEuclideanMetricSystem.dh_dmom">
<span class="sig-name descname"><span class="pre">dh_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ConstrainedEuclideanMetricSystem.dh_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivative of Hamiltonian with respect to momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h(state)</cite> derivative with respect to <cite>state.mom</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedEuclideanMetricSystem.dh_dpos">
<span class="sig-name descname"><span class="pre">dh_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ConstrainedEuclideanMetricSystem.dh_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of Hamiltonian with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedEuclideanMetricSystem.grad_log_det_sqrt_gram">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">grad_log_det_sqrt_gram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#ConstrainedEuclideanMetricSystem.grad_log_det_sqrt_gram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.ConstrainedEuclideanMetricSystem.grad_log_det_sqrt_gram" title="Link to this definition">#</a></dt>
<dd><p>Derivative of half log-determinant of Gram matrix with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <code class="code docutils literal notranslate"><span class="pre">log_det_sqrt_gram(state)</span></code> derivative with respect to
<code class="code docutils literal notranslate"><span class="pre">state.pos</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedEuclideanMetricSystem.grad_neg_log_dens">
<span class="sig-name descname"><span class="pre">grad_neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ConstrainedEuclideanMetricSystem.grad_neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Derivative of negative log density with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>neg_log_dens(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedEuclideanMetricSystem.gram">
<span class="sig-name descname"><span class="pre">gram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#ConstrainedEuclideanMetricSystem.gram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.ConstrainedEuclideanMetricSystem.gram" title="Link to this definition">#</a></dt>
<dd><p>Gram matrix at current position.</p>
<p>The Gram matrix as a position <cite>q</cite> is defined as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gram</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">=</span> <span class="n">jacob_constr</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">@</span> <span class="n">inv</span><span class="p">(</span><span class="n">metric</span><span class="p">)</span> <span class="o">@</span> <span class="n">jacob_constr</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
<p>where <code class="code docutils literal notranslate"><span class="pre">jacob_constr</span></code> is the Jacobian of the constraint function
<code class="code docutils literal notranslate"><span class="pre">constr</span></code> and <code class="code docutils literal notranslate"><span class="pre">metric</span></code> is the matrix representation of the metric on
the ambient space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gram matrix as matrix object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="mici.matrices.html#mici.matrices.PositiveDefiniteMatrix" title="mici.matrices.PositiveDefiniteMatrix"><em>PositiveDefiniteMatrix</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedEuclideanMetricSystem.h">
<span class="sig-name descname"><span class="pre">h</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ConstrainedEuclideanMetricSystem.h" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian function for system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of Hamiltonian.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedEuclideanMetricSystem.h1">
<span class="sig-name descname"><span class="pre">h1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#ConstrainedEuclideanMetricSystem.h1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.ConstrainedEuclideanMetricSystem.h1" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian component depending only on position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h1</cite> Hamiltonian component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedEuclideanMetricSystem.h1_flow">
<span class="sig-name descname"><span class="pre">h1_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ConstrainedEuclideanMetricSystem.h1_flow" title="Link to this definition">#</a></dt>
<dd><p>Apply exact flow map corresponding to <cite>h1</cite> Hamiltonian component.</p>
<p><cite>state</cite> argument is modified in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to start flow at.</p></li>
<li><p><strong>dt</strong> (<em>ScalarLike</em>) – Time interval to simulate flow for.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedEuclideanMetricSystem.h2">
<span class="sig-name descname"><span class="pre">h2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ConstrainedEuclideanMetricSystem.h2" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian component depending on momentum and optionally position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2</cite> Hamiltonian component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedEuclideanMetricSystem.h2_flow">
<span class="sig-name descname"><span class="pre">h2_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ConstrainedEuclideanMetricSystem.h2_flow" title="Link to this definition">#</a></dt>
<dd><p>Apply exact flow map corresponding to <cite>h2</cite> Hamiltonian component.</p>
<p><cite>state</cite> argument is modified in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to start flow at.</p></li>
<li><p><strong>dt</strong> (<em>ScalarLike</em>) – Time interval to simulate flow for.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedEuclideanMetricSystem.inv_gram">
<span class="sig-name descname"><span class="pre">inv_gram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#ConstrainedEuclideanMetricSystem.inv_gram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.ConstrainedEuclideanMetricSystem.inv_gram" title="Link to this definition">#</a></dt>
<dd><p>Inverse of Gram matrix at current position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Inverse of Gram matrix as matrix object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="mici.matrices.html#mici.matrices.PositiveDefiniteMatrix" title="mici.matrices.PositiveDefiniteMatrix"><em>PositiveDefiniteMatrix</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedEuclideanMetricSystem.jacob_constr">
<span class="sig-name descname"><span class="pre">jacob_constr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#ConstrainedEuclideanMetricSystem.jacob_constr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.ConstrainedEuclideanMetricSystem.jacob_constr" title="Link to this definition">#</a></dt>
<dd><p>Jacobian of constraint function at the current position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of Jacobian of <code class="code docutils literal notranslate"><span class="pre">constr(state.pos)</span></code> as 2D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedEuclideanMetricSystem.jacob_constr_inner_product">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">jacob_constr_inner_product</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jacob_constr_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_product_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jacob_constr_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ConstrainedEuclideanMetricSystem.jacob_constr_inner_product" title="Link to this definition">#</a></dt>
<dd><p>Compute inner product of rows of constraint Jacobian matrices.</p>
<p>Computes <code class="code docutils literal notranslate"><span class="pre">jacob_constr_1</span> <span class="pre">&#64;</span> <span class="pre">inner_product_matrix</span> <span class="pre">&#64;</span> <span class="pre">jacob_constr_2.T</span></code>
potentially exploiting any structure / sparsity in <code class="code docutils literal notranslate"><span class="pre">jacob_constr_1</span></code>,
<code class="code docutils literal notranslate"><span class="pre">jacob_constr_2</span></code> and <code class="code docutils literal notranslate"><span class="pre">inner_product_matrix</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jacob_constr_1</strong> (<em>MatrixLike</em>) – First constraint Jacobian in product.</p></li>
<li><p><strong>inner_product_matrix</strong> (<a class="reference internal" href="mici.matrices.html#mici.matrices.PositiveDefiniteMatrix" title="mici.matrices.PositiveDefiniteMatrix"><em>PositiveDefiniteMatrix</em></a>) – Positive-definite matrix defining inner-product
between rows of two constraint Jacobians.</p></li>
<li><p><strong>jacob_constr_2</strong> (<em>MatrixLike</em><em> | </em><em>None</em>) – Second constraint Jacobian in product. Defaults to
<code class="code docutils literal notranslate"><span class="pre">jacob_constr_1</span></code> if set to <code class="code docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Object corresponding to computed inner products of the constraint Jacobian
rows.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>MatrixLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedEuclideanMetricSystem.log_det_sqrt_gram">
<span class="sig-name descname"><span class="pre">log_det_sqrt_gram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#ConstrainedEuclideanMetricSystem.log_det_sqrt_gram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.ConstrainedEuclideanMetricSystem.log_det_sqrt_gram" title="Link to this definition">#</a></dt>
<dd><p>Value of (half of) log-determinant of Gram matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedEuclideanMetricSystem.neg_log_dens">
<span class="sig-name descname"><span class="pre">neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ConstrainedEuclideanMetricSystem.neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Negative logarithm of unnormalized density of target distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of computed negative log density.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedEuclideanMetricSystem.project_onto_cotangent_space">
<span class="sig-name descname"><span class="pre">project_onto_cotangent_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#ConstrainedEuclideanMetricSystem.project_onto_cotangent_space"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.ConstrainedEuclideanMetricSystem.project_onto_cotangent_space" title="Link to this definition">#</a></dt>
<dd><p>Project a momentum on to the co-tangent space at a position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mom</strong> (<em>ArrayLike</em>) – Momentum (co-)vector as 1D array to project on to co-tangent space.</p></li>
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State definining position on the  manifold to project in to the
co-tangent space of.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Projected momentum in the co-tangent space at <code class="code docutils literal notranslate"><span class="pre">state.pos</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedEuclideanMetricSystem.sample_momentum">
<span class="sig-name descname"><span class="pre">sample_momentum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ConstrainedEuclideanMetricSystem.sample_momentum" title="Link to this definition">#</a></dt>
<dd><p>Sample a momentum from its conditional distribution given a position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State defining position to condition on.</p></li>
<li><p><strong>rng</strong> (<em>Generator</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sampled momentum.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mici.systems.ConstrainedTractableFlowSystem">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mici.systems.</span></span><span class="sig-name descname"><span class="pre">ConstrainedTractableFlowSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neg_log_dens</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_neg_log_dens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#ConstrainedTractableFlowSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.ConstrainedTractableFlowSystem" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#mici.systems.TractableFlowSystem" title="mici.systems.TractableFlowSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">TractableFlowSystem</span></code></a></p>
<p>Base class for Hamiltonian systems subject to constraints with tractable flows.</p>
<p>The (constrained) position space is assumed to be a differentiable manifold embedded
with a <span class="math notranslate nohighlight">\(Q\)</span>-dimensional ambient Euclidean space. The <span class="math notranslate nohighlight">\(Q-C\)</span> dimensional
manifold <span class="math notranslate nohighlight">\(\mathcal{M}\)</span> is implicitly defined by an equation</p>
<div class="math notranslate nohighlight">
\[\mathcal{M} = \lbrace q \in \mathbb{R}^Q : c(q) = 0 \rbrace\]</div>
<p>with <span class="math notranslate nohighlight">\(c: \mathbb{R}^Q \to \mathbb{R}^C\)</span> the differentiable and surjective
vector-valued <em>constraint function</em>.</p>
<p>The Hamiltonian function <span class="math notranslate nohighlight">\(h\)</span> is assumed to have the general form</p>
<div class="math notranslate nohighlight">
\[h(q, p) = h_1(q) + h_2(q, p)\]</div>
<p>where <span class="math notranslate nohighlight">\(q\)</span> and <span class="math notranslate nohighlight">\(p\)</span> are the position and momentum variables respectively,
and <span class="math notranslate nohighlight">\(h_1\)</span> and <span class="math notranslate nohighlight">\(h_2\)</span> Hamiltonian component functions. The exact
<em>unconstrained</em> Hamiltonian flows for both the <span class="math notranslate nohighlight">\(h_1\)</span> and <span class="math notranslate nohighlight">\(h_2\)</span>
components, respectively <span class="math notranslate nohighlight">\(\Phi_1\)</span> and <span class="math notranslate nohighlight">\(\Phi_2\)</span> are assumed to be
tractable for subclasses of this class.</p>
<p>The <em>constrained</em> Hamiltonian dynamics are described by the system of differential
algebraic equations</p>
<div class="math notranslate nohighlight">
\[\dot{q} = \nabla_2 h(q, p), \quad
\dot{p} = -\nabla_1 h(q, p) - \partial c(q)^T\lambda, \quad
c(q) = 0.\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda\)</span> is a set of Lagrange multipliers of dimension equal to number
of constraints, <span class="math notranslate nohighlight">\(C\)</span>, and which are implicitly defined by the condition that
the constraint equation <span class="math notranslate nohighlight">\(c(q) = 0\)</span> applies at all times.</p>
<p>The dynamics implicitly define a set of constraints on the momentum variables,
differentiating the constraint equation with respect to time giving that</p>
<div class="math notranslate nohighlight">
\[\partial c(q) \nabla_2 h(q, p) = \partial c(q) \nabla_2 h_2(q, p) = 0.\]</div>
<p>The set of momentum variables satisfying the above for given position variables is
termed the cotangent space of the manifold (at a position). Here we assume that the
operation of projecting a momentum vector onto the cotangent space at a given
position is tractable to compute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neg_log_dens</strong> (<em>ScalarFunction</em>) – Function which given a position array returns the negative
logarithm of an unnormalized probability density on the position space
with respect to a reference measure, with the corresponding
distribution on the position space being the target distribution it is
wished to draw approximate samples from.</p></li>
<li><p><strong>grad_neg_log_dens</strong> (<em>GradientFunction</em><em> | </em><em>None</em>) – Function which given a position array returns the
derivative of <cite>neg_log_dens</cite> with respect to the position array
argument. Optionally the function may instead return a 2-tuple of values
with the first being the array corresponding to the derivative and the
second being the value of the <cite>neg_log_dens</cite> evaluated at the passed
position array. If <cite>None</cite> is passed (the default) an automatic
differentiation fallback will be used to attempt to construct the
derivative of <cite>neg_log_dens</cite> automatically.</p></li>
<li><p><strong>backend</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – Name of automatic differentiation backend to use. See
<a class="reference internal" href="mici.autodiff.html#module-mici.autodiff" title="mici.autodiff"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autodiff</span></code></a> subpackage documentation for details of available
backends. If <cite>None</cite> (the default) no automatic differentiation fallback
will be used and so all derivative functions must be specified
explicitly.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedTractableFlowSystem.constr">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">constr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#ConstrainedTractableFlowSystem.constr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.ConstrainedTractableFlowSystem.constr" title="Link to this definition">#</a></dt>
<dd><p>Constraint function at the current position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <code class="code docutils literal notranslate"><span class="pre">constr(state.pos)</span></code> as 1D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedTractableFlowSystem.dh1_dpos">
<span class="sig-name descname"><span class="pre">dh1_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ConstrainedTractableFlowSystem.dh1_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h1</cite> Hamiltonian component with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of computed <cite>h1</cite> derivative.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedTractableFlowSystem.dh2_dmom">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dh2_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ConstrainedTractableFlowSystem.dh2_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h2</cite> Hamiltonian component with respect to momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2(state)</cite> derivative with respect to <cite>state.mom</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedTractableFlowSystem.dh2_dpos">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dh2_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ConstrainedTractableFlowSystem.dh2_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h2</cite> Hamiltonian component with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedTractableFlowSystem.dh2_flow_dmom">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dh2_flow_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#ConstrainedTractableFlowSystem.dh2_flow_dmom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.ConstrainedTractableFlowSystem.dh2_flow_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivatives of <a class="reference internal" href="#mici.systems.ConstrainedTractableFlowSystem.h2_flow" title="mici.systems.ConstrainedTractableFlowSystem.h2_flow"><code class="xref py py-meth docutils literal notranslate"><span class="pre">h2_flow()</span></code></a> flow map with respect to momentum argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to evaluate derivatives of flow map at.</p></li>
<li><p><strong>dt</strong> (<em>ScalarLike</em>) – Time interval flow simulated for.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple <code class="code docutils literal notranslate"><span class="pre">(dpos_dmom,</span> <span class="pre">dmom_dmom)</span></code> with <code class="code docutils literal notranslate"><span class="pre">dpos_dmom</span></code> a matrix
representing derivative (Jacobian) of position output of <a class="reference internal" href="#mici.systems.ConstrainedTractableFlowSystem.h2_flow" title="mici.systems.ConstrainedTractableFlowSystem.h2_flow"><code class="xref py py-meth docutils literal notranslate"><span class="pre">h2_flow()</span></code></a>
with respect to the value of the momentum component of the initial input
state and <code class="code docutils literal notranslate"><span class="pre">dmom_dmom</span></code> a matrix representing derivative (Jacobian) of
momentum output of <a class="reference internal" href="#mici.systems.ConstrainedTractableFlowSystem.h2_flow" title="mici.systems.ConstrainedTractableFlowSystem.h2_flow"><code class="xref py py-meth docutils literal notranslate"><span class="pre">h2_flow()</span></code></a> with respect to the value of the
momentum component of the initial input state.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a>[<a class="reference internal" href="mici.matrices.html#mici.matrices.Matrix" title="mici.matrices.Matrix"><em>Matrix</em></a>, <a class="reference internal" href="mici.matrices.html#mici.matrices.Matrix" title="mici.matrices.Matrix"><em>Matrix</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedTractableFlowSystem.dh_dmom">
<span class="sig-name descname"><span class="pre">dh_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ConstrainedTractableFlowSystem.dh_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivative of Hamiltonian with respect to momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h(state)</cite> derivative with respect to <cite>state.mom</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedTractableFlowSystem.dh_dpos">
<span class="sig-name descname"><span class="pre">dh_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ConstrainedTractableFlowSystem.dh_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of Hamiltonian with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedTractableFlowSystem.grad_neg_log_dens">
<span class="sig-name descname"><span class="pre">grad_neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ConstrainedTractableFlowSystem.grad_neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Derivative of negative log density with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>neg_log_dens(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedTractableFlowSystem.h">
<span class="sig-name descname"><span class="pre">h</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ConstrainedTractableFlowSystem.h" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian function for system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of Hamiltonian.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedTractableFlowSystem.h1">
<span class="sig-name descname"><span class="pre">h1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ConstrainedTractableFlowSystem.h1" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian component depending only on position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h1</cite> Hamiltonian component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedTractableFlowSystem.h1_flow">
<span class="sig-name descname"><span class="pre">h1_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ConstrainedTractableFlowSystem.h1_flow" title="Link to this definition">#</a></dt>
<dd><p>Apply exact flow map corresponding to <cite>h1</cite> Hamiltonian component.</p>
<p><cite>state</cite> argument is modified in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to start flow at.</p></li>
<li><p><strong>dt</strong> (<em>ScalarLike</em>) – Time interval to simulate flow for.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedTractableFlowSystem.h2">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">h2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ConstrainedTractableFlowSystem.h2" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian component depending on momentum and optionally position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2</cite> Hamiltonian component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedTractableFlowSystem.h2_flow">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">h2_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ConstrainedTractableFlowSystem.h2_flow" title="Link to this definition">#</a></dt>
<dd><p>Apply exact flow map corresponding to <cite>h2</cite> Hamiltonian component.</p>
<p><cite>state</cite> argument is modified in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to start flow at.</p></li>
<li><p><strong>dt</strong> (<em>ScalarLike</em>) – Time interval to simulate flow for.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedTractableFlowSystem.jacob_constr">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">jacob_constr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#ConstrainedTractableFlowSystem.jacob_constr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.ConstrainedTractableFlowSystem.jacob_constr" title="Link to this definition">#</a></dt>
<dd><p>Jacobian of constraint function at the current position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of Jacobian of <code class="code docutils literal notranslate"><span class="pre">constr(state.pos)</span></code> as 2D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedTractableFlowSystem.jacob_constr_inner_product">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">jacob_constr_inner_product</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jacob_constr_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_product_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jacob_constr_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#ConstrainedTractableFlowSystem.jacob_constr_inner_product"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.ConstrainedTractableFlowSystem.jacob_constr_inner_product" title="Link to this definition">#</a></dt>
<dd><p>Compute inner product of rows of constraint Jacobian matrices.</p>
<p>Computes <code class="code docutils literal notranslate"><span class="pre">jacob_constr_1</span> <span class="pre">&#64;</span> <span class="pre">inner_product_matrix</span> <span class="pre">&#64;</span> <span class="pre">jacob_constr_2.T</span></code>
potentially exploiting any structure / sparsity in <code class="code docutils literal notranslate"><span class="pre">jacob_constr_1</span></code>,
<code class="code docutils literal notranslate"><span class="pre">jacob_constr_2</span></code> and <code class="code docutils literal notranslate"><span class="pre">inner_product_matrix</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jacob_constr_1</strong> (<em>MatrixLike</em>) – First constraint Jacobian in product.</p></li>
<li><p><strong>inner_product_matrix</strong> (<a class="reference internal" href="mici.matrices.html#mici.matrices.PositiveDefiniteMatrix" title="mici.matrices.PositiveDefiniteMatrix"><em>PositiveDefiniteMatrix</em></a>) – Positive-definite matrix defining inner-product
between rows of two constraint Jacobians.</p></li>
<li><p><strong>jacob_constr_2</strong> (<em>MatrixLike</em><em> | </em><em>None</em>) – Second constraint Jacobian in product. Defaults to
<code class="code docutils literal notranslate"><span class="pre">jacob_constr_1</span></code> if set to <code class="code docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Object corresponding to computed inner products of the constraint Jacobian
rows.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>MatrixLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedTractableFlowSystem.neg_log_dens">
<span class="sig-name descname"><span class="pre">neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ConstrainedTractableFlowSystem.neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Negative logarithm of unnormalized density of target distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of computed negative log density.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedTractableFlowSystem.project_onto_cotangent_space">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">project_onto_cotangent_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#ConstrainedTractableFlowSystem.project_onto_cotangent_space"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.ConstrainedTractableFlowSystem.project_onto_cotangent_space" title="Link to this definition">#</a></dt>
<dd><p>Project a momentum on to the co-tangent space at a position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mom</strong> (<em>ArrayLike</em>) – Momentum (co-)vector as 1D array to project on to co-tangent space.</p></li>
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State definining position on the  manifold to project in to the
co-tangent space of.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Projected momentum in the co-tangent space at <code class="code docutils literal notranslate"><span class="pre">state.pos</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ConstrainedTractableFlowSystem.sample_momentum">
<span class="sig-name descname"><span class="pre">sample_momentum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#ConstrainedTractableFlowSystem.sample_momentum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.ConstrainedTractableFlowSystem.sample_momentum" title="Link to this definition">#</a></dt>
<dd><p>Sample a momentum from its conditional distribution given a position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State defining position to condition on.</p></li>
<li><p><strong>rng</strong> (<em>Generator</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sampled momentum.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mici.systems.DenseConstrainedEuclideanMetricSystem">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mici.systems.</span></span><span class="sig-name descname"><span class="pre">DenseConstrainedEuclideanMetricSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neg_log_dens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constr</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dens_wrt_hausdorff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_neg_log_dens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jacob_constr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mhp_constr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#DenseConstrainedEuclideanMetricSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.DenseConstrainedEuclideanMetricSystem" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#mici.systems.ConstrainedEuclideanMetricSystem" title="mici.systems.ConstrainedEuclideanMetricSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstrainedEuclideanMetricSystem</span></code></a></p>
<p>Euclidean Hamiltonian system subject to a dense set of constraints.</p>
<p>See <a class="reference internal" href="#mici.systems.ConstrainedEuclideanMetricSystem" title="mici.systems.ConstrainedEuclideanMetricSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstrainedEuclideanMetricSystem</span></code></a> for more details about constrained
systems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neg_log_dens</strong> (<em>ScalarFunction</em>) – Function which given a position array returns the negative
logarithm of an unnormalized probability density on the constrained
position space with respect to the Hausdorff measure on the constraint
manifold (if <code class="code docutils literal notranslate"><span class="pre">dens_wrt_hausdorff</span> <span class="pre">==</span> <span class="pre">True</span></code>) or alternatively the
negative logarithm of an unnormalized probability density on the
unconstrained (ambient) position space with respect to the Lebesgue
measure. In the former case the target distribution it is wished to draw
approximate samples from is assumed to be directly specified by the
density function on the manifold. In the latter case the density
function is instead taken to specify a prior distribution on the ambient
space with the target distribution then corresponding to the posterior
distribution when conditioning on the (zero Lebesgue measure) event
<code class="code docutils literal notranslate"><span class="pre">constr(q)</span> <span class="pre">==</span> <span class="pre">0</span></code> where <code class="code docutils literal notranslate"><span class="pre">q</span></code> is the position array. This
target posterior distribution has support on the differentiable manifold
implicitly defined by the constraint equation, with density with respect
to the Hausdorff measure on the manifold corresponding to the ratio of
the prior density (specified by <code class="code docutils literal notranslate"><span class="pre">neg_log_dens</span></code>) and the
square-root of the determinant of the Gram matrix defined by
<code class="code docutils literal notranslate"><span class="pre">gram(q)</span> <span class="pre">=</span> <span class="pre">jacob_constr(q)</span> <span class="pre">&#64;</span> <span class="pre">inv(metric)</span> <span class="pre">&#64;</span> <span class="pre">jacob_constr(q).T</span></code>
where <code class="code docutils literal notranslate"><span class="pre">jacob_constr</span></code> is the Jacobian of the constraint function
<code class="code docutils literal notranslate"><span class="pre">constr</span></code> and <code class="code docutils literal notranslate"><span class="pre">metric</span></code> is the matrix representation of the
metric on the ambient space.</p></li>
<li><p><strong>constr</strong> (<em>ArrayFunction</em>) – Function which given a position array return as a 1D array the value
of the (vector-valued) constraint function, the zero level-set of which
implicitly defines the manifold the dynamic is simulated on.</p></li>
<li><p><strong>metric</strong> (<em>MetricLike</em><em> | </em><em>None</em>) – Matrix object corresponding to matrix representation of metric on
<em>unconstrained</em> position space and covariance of Gaussian marginal
distribution on <em>unconstrained</em> momentum vector. If <code class="code docutils literal notranslate"><span class="pre">None</span></code> is
passed (the default), the identity matrix will be used. If a 1D array is
passed then this is assumed to specify a metric with positive diagonal
matrix representation and the array the matrix diagonal. If a 2D array
is passed then this is assumed to specify a metric with a dense positive
definite matrix representation specified by the array. Otherwise if the
value is a <a class="reference internal" href="mici.matrices.html#mici.matrices.PositiveDefiniteMatrix" title="mici.matrices.PositiveDefiniteMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">mici.matrices.PositiveDefiniteMatrix</span></code></a> subclass it
is assumed to directly specify the metric matrix representation.</p></li>
<li><p><strong>dens_wrt_hausdorff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether the <code class="code docutils literal notranslate"><span class="pre">neg_log_dens</span></code> function specifies the
(negative logarithm) of the density of the target distribution with
respect to the Hausdorff measure on the manifold directly (<code class="code docutils literal notranslate"><span class="pre">True</span></code>)
or alternatively the negative logarithm of a density of a prior
distriubtion on the unconstrained (ambient) position space with respect
to the Lebesgue measure, with the target distribution then corresponding
to the posterior distribution when conditioning on the event
<code class="code docutils literal notranslate"><span class="pre">constr(pos)</span> <span class="pre">==</span> <span class="pre">0</span></code> (<code class="code docutils literal notranslate"><span class="pre">False</span></code>). Note that in the former case
the base Hausdorff measure on the manifold depends on the metric defined
on the ambient space, with the Hausdorff measure being defined with
respect to the metric induced on the manifold from this ambient metric.</p></li>
<li><p><strong>grad_neg_log_dens</strong> (<em>GradientFunction</em><em> | </em><em>None</em>) – Function which given a position array returns the
derivative of <code class="code docutils literal notranslate"><span class="pre">neg_log_dens</span></code> with respect to the position array
argument. Optionally the function may instead return a 2-tuple of values
with the first being the array corresponding to the derivative and the
second being the value of the <code class="code docutils literal notranslate"><span class="pre">neg_log_dens</span></code> evaluated at the
passed position array. If <code class="code docutils literal notranslate"><span class="pre">None</span></code> is passed (the default) an
automatic differentiation fallback will be used to attempt to construct
a function to compute the derivative (and value) of <code class="code docutils literal notranslate"><span class="pre">neg_log_dens</span></code>
automatically.</p></li>
<li><p><strong>jacob_constr</strong> (<em>JacobianFunction</em><em> | </em><em>None</em>) – Function which given a position array computes the Jacobian
(matrix / 2D array of partial derivatives) of the output of the
constraint function <code class="code docutils literal notranslate"><span class="pre">c</span> <span class="pre">=</span> <span class="pre">constr(q)</span></code> with respect to the position
array argument <code class="code docutils literal notranslate"><span class="pre">q</span></code>, returning the computed Jacobian as a 2D array
<code class="code docutils literal notranslate"><span class="pre">jacob</span></code> with <code class="code docutils literal notranslate"><span class="pre">jacob[i,</span> <span class="pre">j]</span> <span class="pre">=</span> <span class="pre">∂c[i]</span> <span class="pre">/</span> <span class="pre">∂q[j]</span></code>. Optionally the
function may instead return a 2-tuple of values with the first being the
array corresponding to the Jacobian and the second being the value of
<code class="code docutils literal notranslate"><span class="pre">constr</span></code> evaluated at the passed position array. If <code class="code docutils literal notranslate"><span class="pre">None</span></code>
is passed (the default) an automatic differentiation fallback will be
used to attempt to construct a function to compute the Jacobian (and
value) of <code class="code docutils literal notranslate"><span class="pre">constr</span></code>
automatically.</p></li>
<li><p><strong>mhp_constr</strong> (<em>MatrixHessianProductFunction</em><em> | </em><em>None</em>) – Function which given a position array returns another function
which takes a 2D array as an argument and returns the
<em>matrix-Hessian-product</em> (MHP) of the constraint function <code class="code docutils literal notranslate"><span class="pre">constr</span></code>
with respect to the position array argument. The MHP is here defined as
a function of a <code class="code docutils literal notranslate"><span class="pre">(dim_constr,</span> <span class="pre">dim_pos)</span></code> shaped 2D array <code class="code docutils literal notranslate"><span class="pre">m</span></code>
as <code class="code docutils literal notranslate"><span class="pre">mhp(m)</span> <span class="pre">=</span> <span class="pre">sum(m[:,</span> <span class="pre">:,</span> <span class="pre">None]</span> <span class="pre">*</span> <span class="pre">hess[:,</span> <span class="pre">:,</span> <span class="pre">:],</span> <span class="pre">axis=(0,</span> <span class="pre">1))</span></code>
where <code class="code docutils literal notranslate"><span class="pre">hess</span></code> is the <code class="code docutils literal notranslate"><span class="pre">(dim_constr,</span> <span class="pre">dim_pos,</span> <span class="pre">dim_pos)</span></code> shaped
vector-Hessian of <code class="code docutils literal notranslate"><span class="pre">c</span> <span class="pre">=</span> <span class="pre">constr(q)</span></code> with respect to <code class="code docutils literal notranslate"><span class="pre">q</span></code> i.e.
the array of second-order partial derivatives of such that
<code class="code docutils literal notranslate"><span class="pre">hess[i,</span> <span class="pre">j,</span> <span class="pre">k]</span> <span class="pre">=</span> <span class="pre">∂²c[i]</span> <span class="pre">/</span> <span class="pre">(∂q[j]</span> <span class="pre">∂q[k])</span></code>. Optionally the function
may instead return a 3-tuple of values with the first a function to
compute a MHP of <code class="code docutils literal notranslate"><span class="pre">constr</span></code>, the second a 2D array corresponding to
the Jacobian of <code class="code docutils literal notranslate"><span class="pre">constr</span></code>, and the third the value of
<code class="code docutils literal notranslate"><span class="pre">constr</span></code>, all evaluated at the passed position array. If
<code class="code docutils literal notranslate"><span class="pre">None</span></code> is passed (the default) an automatic differentiation
fallback will be used to attempt to construct a function which
calculates the MHP (and Jacobian and value) of <code class="code docutils literal notranslate"><span class="pre">constr</span></code>
automatically.</p></li>
<li><p><strong>backend</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – Name of automatic differentiation backend to use. See
<a class="reference internal" href="mici.autodiff.html#module-mici.autodiff" title="mici.autodiff"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autodiff</span></code></a> subpackage documentation for details of available
backends. If <cite>None</cite> (the default) no automatic differentiation fallback
will be used and so all derivative functions must be specified
explicitly.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseConstrainedEuclideanMetricSystem.constr">
<span class="sig-name descname"><span class="pre">constr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.constr" title="Link to this definition">#</a></dt>
<dd><p>Constraint function at the current position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <code class="code docutils literal notranslate"><span class="pre">constr(state.pos)</span></code> as 1D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseConstrainedEuclideanMetricSystem.dh1_dpos">
<span class="sig-name descname"><span class="pre">dh1_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.dh1_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h1</cite> Hamiltonian component with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of computed <cite>h1</cite> derivative.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseConstrainedEuclideanMetricSystem.dh2_dmom">
<span class="sig-name descname"><span class="pre">dh2_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.dh2_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h2</cite> Hamiltonian component with respect to momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2(state)</cite> derivative with respect to <cite>state.mom</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseConstrainedEuclideanMetricSystem.dh2_dpos">
<span class="sig-name descname"><span class="pre">dh2_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.dh2_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h2</cite> Hamiltonian component with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseConstrainedEuclideanMetricSystem.dh2_flow_dmom">
<span class="sig-name descname"><span class="pre">dh2_flow_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.dh2_flow_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivatives of <a class="reference internal" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.h2_flow" title="mici.systems.DenseConstrainedEuclideanMetricSystem.h2_flow"><code class="xref py py-meth docutils literal notranslate"><span class="pre">h2_flow()</span></code></a> flow map with respect to momentum argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to evaluate derivatives of flow map at.</p></li>
<li><p><strong>dt</strong> (<em>ScalarLike</em>) – Time interval flow simulated for.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple <code class="code docutils literal notranslate"><span class="pre">(dpos_dmom,</span> <span class="pre">dmom_dmom)</span></code> with <code class="code docutils literal notranslate"><span class="pre">dpos_dmom</span></code> a matrix
representing derivative (Jacobian) of position output of <a class="reference internal" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.h2_flow" title="mici.systems.DenseConstrainedEuclideanMetricSystem.h2_flow"><code class="xref py py-meth docutils literal notranslate"><span class="pre">h2_flow()</span></code></a>
with respect to the value of the momentum component of the initial input
state and <code class="code docutils literal notranslate"><span class="pre">dmom_dmom</span></code> a matrix representing derivative (Jacobian) of
momentum output of <a class="reference internal" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.h2_flow" title="mici.systems.DenseConstrainedEuclideanMetricSystem.h2_flow"><code class="xref py py-meth docutils literal notranslate"><span class="pre">h2_flow()</span></code></a> with respect to the value of the
momentum component of the initial input state.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a>[<a class="reference internal" href="mici.matrices.html#mici.matrices.Matrix" title="mici.matrices.Matrix"><em>Matrix</em></a>, <a class="reference internal" href="mici.matrices.html#mici.matrices.Matrix" title="mici.matrices.Matrix"><em>Matrix</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseConstrainedEuclideanMetricSystem.dh_dmom">
<span class="sig-name descname"><span class="pre">dh_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.dh_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivative of Hamiltonian with respect to momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h(state)</cite> derivative with respect to <cite>state.mom</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseConstrainedEuclideanMetricSystem.dh_dpos">
<span class="sig-name descname"><span class="pre">dh_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.dh_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of Hamiltonian with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseConstrainedEuclideanMetricSystem.grad_log_det_sqrt_gram">
<span class="sig-name descname"><span class="pre">grad_log_det_sqrt_gram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#DenseConstrainedEuclideanMetricSystem.grad_log_det_sqrt_gram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.grad_log_det_sqrt_gram" title="Link to this definition">#</a></dt>
<dd><p>Derivative of half log-determinant of Gram matrix with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <code class="code docutils literal notranslate"><span class="pre">log_det_sqrt_gram(state)</span></code> derivative with respect to
<code class="code docutils literal notranslate"><span class="pre">state.pos</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseConstrainedEuclideanMetricSystem.grad_neg_log_dens">
<span class="sig-name descname"><span class="pre">grad_neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.grad_neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Derivative of negative log density with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>neg_log_dens(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseConstrainedEuclideanMetricSystem.gram">
<span class="sig-name descname"><span class="pre">gram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.gram" title="Link to this definition">#</a></dt>
<dd><p>Gram matrix at current position.</p>
<p>The Gram matrix as a position <cite>q</cite> is defined as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gram</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">=</span> <span class="n">jacob_constr</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">@</span> <span class="n">inv</span><span class="p">(</span><span class="n">metric</span><span class="p">)</span> <span class="o">@</span> <span class="n">jacob_constr</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
<p>where <code class="code docutils literal notranslate"><span class="pre">jacob_constr</span></code> is the Jacobian of the constraint function
<code class="code docutils literal notranslate"><span class="pre">constr</span></code> and <code class="code docutils literal notranslate"><span class="pre">metric</span></code> is the matrix representation of the metric on
the ambient space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gram matrix as matrix object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="mici.matrices.html#mici.matrices.PositiveDefiniteMatrix" title="mici.matrices.PositiveDefiniteMatrix"><em>PositiveDefiniteMatrix</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseConstrainedEuclideanMetricSystem.h">
<span class="sig-name descname"><span class="pre">h</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.h" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian function for system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of Hamiltonian.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseConstrainedEuclideanMetricSystem.h1">
<span class="sig-name descname"><span class="pre">h1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.h1" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian component depending only on position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h1</cite> Hamiltonian component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseConstrainedEuclideanMetricSystem.h1_flow">
<span class="sig-name descname"><span class="pre">h1_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.h1_flow" title="Link to this definition">#</a></dt>
<dd><p>Apply exact flow map corresponding to <cite>h1</cite> Hamiltonian component.</p>
<p><cite>state</cite> argument is modified in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to start flow at.</p></li>
<li><p><strong>dt</strong> (<em>ScalarLike</em>) – Time interval to simulate flow for.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseConstrainedEuclideanMetricSystem.h2">
<span class="sig-name descname"><span class="pre">h2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.h2" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian component depending on momentum and optionally position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2</cite> Hamiltonian component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseConstrainedEuclideanMetricSystem.h2_flow">
<span class="sig-name descname"><span class="pre">h2_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.h2_flow" title="Link to this definition">#</a></dt>
<dd><p>Apply exact flow map corresponding to <cite>h2</cite> Hamiltonian component.</p>
<p><cite>state</cite> argument is modified in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to start flow at.</p></li>
<li><p><strong>dt</strong> (<em>ScalarLike</em>) – Time interval to simulate flow for.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseConstrainedEuclideanMetricSystem.inv_gram">
<span class="sig-name descname"><span class="pre">inv_gram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.inv_gram" title="Link to this definition">#</a></dt>
<dd><p>Inverse of Gram matrix at current position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Inverse of Gram matrix as matrix object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="mici.matrices.html#mici.matrices.PositiveDefiniteMatrix" title="mici.matrices.PositiveDefiniteMatrix"><em>PositiveDefiniteMatrix</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseConstrainedEuclideanMetricSystem.jacob_constr">
<span class="sig-name descname"><span class="pre">jacob_constr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.jacob_constr" title="Link to this definition">#</a></dt>
<dd><p>Jacobian of constraint function at the current position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of Jacobian of <code class="code docutils literal notranslate"><span class="pre">constr(state.pos)</span></code> as 2D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseConstrainedEuclideanMetricSystem.jacob_constr_inner_product">
<span class="sig-name descname"><span class="pre">jacob_constr_inner_product</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jacob_constr_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_product_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jacob_constr_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#DenseConstrainedEuclideanMetricSystem.jacob_constr_inner_product"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.jacob_constr_inner_product" title="Link to this definition">#</a></dt>
<dd><p>Compute inner product of rows of constraint Jacobian matrices.</p>
<p>Computes <code class="code docutils literal notranslate"><span class="pre">jacob_constr_1</span> <span class="pre">&#64;</span> <span class="pre">inner_product_matrix</span> <span class="pre">&#64;</span> <span class="pre">jacob_constr_2.T</span></code>
potentially exploiting any structure / sparsity in <code class="code docutils literal notranslate"><span class="pre">jacob_constr_1</span></code>,
<code class="code docutils literal notranslate"><span class="pre">jacob_constr_2</span></code> and <code class="code docutils literal notranslate"><span class="pre">inner_product_matrix</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jacob_constr_1</strong> (<em>MatrixLike</em>) – First constraint Jacobian in product.</p></li>
<li><p><strong>inner_product_matrix</strong> (<a class="reference internal" href="mici.matrices.html#mici.matrices.PositiveDefiniteMatrix" title="mici.matrices.PositiveDefiniteMatrix"><em>PositiveDefiniteMatrix</em></a>) – Positive-definite matrix defining inner-product
between rows of two constraint Jacobians.</p></li>
<li><p><strong>jacob_constr_2</strong> (<em>MatrixLike</em><em> | </em><em>None</em>) – Second constraint Jacobian in product. Defaults to
<code class="code docutils literal notranslate"><span class="pre">jacob_constr_1</span></code> if set to <code class="code docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Object corresponding to computed inner products of the constraint Jacobian
rows.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>MatrixLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseConstrainedEuclideanMetricSystem.log_det_sqrt_gram">
<span class="sig-name descname"><span class="pre">log_det_sqrt_gram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.log_det_sqrt_gram" title="Link to this definition">#</a></dt>
<dd><p>Value of (half of) log-determinant of Gram matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseConstrainedEuclideanMetricSystem.mhp_constr">
<span class="sig-name descname"><span class="pre">mhp_constr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#DenseConstrainedEuclideanMetricSystem.mhp_constr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.mhp_constr" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>MatrixHessianProduct</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseConstrainedEuclideanMetricSystem.neg_log_dens">
<span class="sig-name descname"><span class="pre">neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Negative logarithm of unnormalized density of target distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of computed negative log density.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseConstrainedEuclideanMetricSystem.project_onto_cotangent_space">
<span class="sig-name descname"><span class="pre">project_onto_cotangent_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.project_onto_cotangent_space" title="Link to this definition">#</a></dt>
<dd><p>Project a momentum on to the co-tangent space at a position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mom</strong> (<em>ArrayLike</em>) – Momentum (co-)vector as 1D array to project on to co-tangent space.</p></li>
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State definining position on the  manifold to project in to the
co-tangent space of.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Projected momentum in the co-tangent space at <code class="code docutils literal notranslate"><span class="pre">state.pos</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseConstrainedEuclideanMetricSystem.sample_momentum">
<span class="sig-name descname"><span class="pre">sample_momentum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.sample_momentum" title="Link to this definition">#</a></dt>
<dd><p>Sample a momentum from its conditional distribution given a position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State defining position to condition on.</p></li>
<li><p><strong>rng</strong> (<em>Generator</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sampled momentum.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mici.systems.DenseRiemannianMetricSystem">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mici.systems.</span></span><span class="sig-name descname"><span class="pre">DenseRiemannianMetricSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neg_log_dens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_func</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">vjp_metric_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_neg_log_dens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#DenseRiemannianMetricSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.DenseRiemannianMetricSystem" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#mici.systems.RiemannianMetricSystem" title="mici.systems.RiemannianMetricSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">RiemannianMetricSystem</span></code></a></p>
<p>Riemannian-metric system with dense matrix representation.</p>
<p>Hamiltonian system with a position dependent metric matrix representation which is
specified to be a dense matrix function <cite>metric_func</cite> of the position <cite>q</cite> which is
guaranteed to be positive definite almost-everywhere, with <cite>M = metric_func(q)</cite> then
the metric matrix representation.</p>
<p>See documentation of <cite>RiemannianMetricSystem</cite> for more general details about
Riemannian-metric Hamiltonian systems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neg_log_dens</strong> (<em>ScalarFunction</em>) – Function which given a position array returns the negative
logarithm of an unnormalized probability density on the position space
with respect to the Lebesgue measure, with the corresponding
distribution on the position space being the target distribution it is
wished to draw approximate samples from.</p></li>
<li><p><strong>metric_func</strong> (<em>ArrayFunction</em>) – Function which given a position array returns a 2D array
corresponding to the positive definite metric matrix representation. The
returned matrices (2D arrays) are assumed to be positive-definite for
all input positions and a <cite>LinAlgError</cite> exception may be raised if this
fails to be the case.</p></li>
<li><p><strong>vjp_metric_func</strong> (<em>VectorJacobianProductFunction</em><em> | </em><em>None</em>) – <p>Function which given a position array returns another
function which takes a 2D array as an argument and returns the
<em>vector-Jacobian-product</em> (VJP) of <cite>metric_func</cite> with respect to the
position array argument. The VJP is here defined as a function of a 2D
array <cite>v</cite>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vjp</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">v</span><span class="p">[:,</span> <span class="p">:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">jacob</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<p>where <cite>jacob</cite> is the <cite>(dim_pos, dim_pos, dim_pos)</cite> shaped Jacobian of <cite>M
= metric_func(q)</cite> with respect to <cite>q</cite> i.e. the array of partial
derivatives of the function such that</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>jacob[i, j, k] = ∂M[i, j] / ∂q[k]
</pre></div>
</div>
<p>Optionally the function may instead return a 2-tuple of values with the
first a function to compute a VJP of <cite>metric_func</cite> and the second a 2D
array containing the value of <cite>metric_func</cite>, both evaluated at the
passed position array. If <cite>None</cite> is passed (the default) an automatic
differentiation fallback will be used to attempt to construct a function
which calculates the VJP (and value) of <cite>metric_func</cite> automatically.</p>
</p></li>
<li><p><strong>grad_neg_log_dens</strong> (<em>GradientFunction</em><em> | </em><em>None</em>) – Function which given a position array returns the
derivative of <cite>neg_log_dens</cite> with respect to the position array
argument. Optionally the function may instead return a 2-tuple of values
with the first being the array corresponding to the derivative and the
second being the value of the <cite>neg_log_dens</cite> evaluated at the passed
position array. If <cite>None</cite> is passed (the default) an automatic
differentiation fallback will be used to attempt to construct the
derivative of <cite>neg_log_dens</cite> automatically.</p></li>
<li><p><strong>backend</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – Name of automatic differentiation backend to use. See
<a class="reference internal" href="mici.autodiff.html#module-mici.autodiff" title="mici.autodiff"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autodiff</span></code></a> subpackage documentation for details of available
backends. If <cite>None</cite> (the default) no automatic differentiation fallback
will be used and so all derivative functions must be specified
explicitly.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseRiemannianMetricSystem.dh1_dpos">
<span class="sig-name descname"><span class="pre">dh1_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseRiemannianMetricSystem.dh1_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h1</cite> Hamiltonian component with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of computed <cite>h1</cite> derivative.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseRiemannianMetricSystem.dh2_dmom">
<span class="sig-name descname"><span class="pre">dh2_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseRiemannianMetricSystem.dh2_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h2</cite> Hamiltonian component with respect to momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2(state)</cite> derivative with respect to <cite>state.mom</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseRiemannianMetricSystem.dh2_dpos">
<span class="sig-name descname"><span class="pre">dh2_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseRiemannianMetricSystem.dh2_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h2</cite> Hamiltonian component with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseRiemannianMetricSystem.dh_dmom">
<span class="sig-name descname"><span class="pre">dh_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseRiemannianMetricSystem.dh_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivative of Hamiltonian with respect to momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h(state)</cite> derivative with respect to <cite>state.mom</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseRiemannianMetricSystem.dh_dpos">
<span class="sig-name descname"><span class="pre">dh_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseRiemannianMetricSystem.dh_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of Hamiltonian with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseRiemannianMetricSystem.grad_neg_log_dens">
<span class="sig-name descname"><span class="pre">grad_neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseRiemannianMetricSystem.grad_neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Derivative of negative log density with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>neg_log_dens(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseRiemannianMetricSystem.h">
<span class="sig-name descname"><span class="pre">h</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseRiemannianMetricSystem.h" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian function for system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of Hamiltonian.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseRiemannianMetricSystem.h1">
<span class="sig-name descname"><span class="pre">h1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseRiemannianMetricSystem.h1" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian component depending only on position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h1</cite> Hamiltonian component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseRiemannianMetricSystem.h1_flow">
<span class="sig-name descname"><span class="pre">h1_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseRiemannianMetricSystem.h1_flow" title="Link to this definition">#</a></dt>
<dd><p>Apply exact flow map corresponding to <cite>h1</cite> Hamiltonian component.</p>
<p><cite>state</cite> argument is modified in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to start flow at.</p></li>
<li><p><strong>dt</strong> (<em>ScalarLike</em>) – Time interval to simulate flow for.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseRiemannianMetricSystem.h2">
<span class="sig-name descname"><span class="pre">h2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseRiemannianMetricSystem.h2" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian component depending on momentum and optionally position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2</cite> Hamiltonian component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseRiemannianMetricSystem.metric">
<span class="sig-name descname"><span class="pre">metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseRiemannianMetricSystem.metric" title="Link to this definition">#</a></dt>
<dd><p>Function computing the metric matrix representation.</p>
<p>The returned type of this function is that specified by the
<cite>metric_matrix_class</cite> argument to the initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Metric matrix representation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="mici.matrices.html#mici.matrices.PositiveDefiniteMatrix" title="mici.matrices.PositiveDefiniteMatrix"><em>PositiveDefiniteMatrix</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseRiemannianMetricSystem.metric_func">
<span class="sig-name descname"><span class="pre">metric_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseRiemannianMetricSystem.metric_func" title="Link to this definition">#</a></dt>
<dd><p>Function computing the parameter of the metric matrix representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>metric_func(state.pos)</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseRiemannianMetricSystem.neg_log_dens">
<span class="sig-name descname"><span class="pre">neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseRiemannianMetricSystem.neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Negative logarithm of unnormalized density of target distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of computed negative log density.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseRiemannianMetricSystem.sample_momentum">
<span class="sig-name descname"><span class="pre">sample_momentum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseRiemannianMetricSystem.sample_momentum" title="Link to this definition">#</a></dt>
<dd><p>Sample a momentum from its conditional distribution given a position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State defining position to condition on.</p></li>
<li><p><strong>rng</strong> (<em>Generator</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sampled momentum.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DenseRiemannianMetricSystem.vjp_metric_func">
<span class="sig-name descname"><span class="pre">vjp_metric_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DenseRiemannianMetricSystem.vjp_metric_func" title="Link to this definition">#</a></dt>
<dd><p>Function constructing a vector-Jacobian-product for <cite>metric_func</cite>.</p>
<p>The vector-Jacobian-product is here defined as a function of an array <cite>v</cite> (of
the same shape as the output of <cite>metric_func</cite>) corresponding to</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vjp</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">jacob</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ndim</span><span class="p">))</span>
</pre></div>
</div>
<p>where <cite>jacob</cite> is the Jacobian of <cite>m = metric_func(q)</cite> wrt <cite>q</cite> i.e. the array of
partial derivatives of the function such that</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>jacob[..., i] = ∂m[...] / ∂q[i]
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute VJP at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Vector-Jacobian-product function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>VectorJacobianProduct</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mici.systems.DiagonalRiemannianMetricSystem">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mici.systems.</span></span><span class="sig-name descname"><span class="pre">DiagonalRiemannianMetricSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neg_log_dens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_diagonal_func</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">vjp_metric_diagonal_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_neg_log_dens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#DiagonalRiemannianMetricSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.DiagonalRiemannianMetricSystem" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#mici.systems.RiemannianMetricSystem" title="mici.systems.RiemannianMetricSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">RiemannianMetricSystem</span></code></a></p>
<p>Riemannian-metric system with diagonal matrix representation.</p>
<p>Hamiltonian system with a position dependent diagonal metric matrix representation
which is specified by a vector-valued function <cite>metric_diagonal_func</cite> of the
position <cite>q</cite> which outputs a 1D array with strictly positive elements <cite>d =
metric_diagonal_func(q)</cite> with the metric matrix representation then taken to be
<cite>diag(d)</cite>.</p>
<p>See documentation of <cite>RiemannianMetricSystem</cite> for more general details about
Riemannian-metric Hamiltonian systems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neg_log_dens</strong> (<em>ScalarFunction</em>) – Function which given a position array returns the negative
logarithm of an unnormalized probability density on the position space
with respect to the Lebesgue measure, with the corresponding
distribution on the position space being the target distribution it is
wished to draw approximate samples from.</p></li>
<li><p><strong>metric_diagonal_func</strong> (<em>ArrayFunction</em>) – Function which given a position array returns a 1D
array with strictly positive values corresponding to the diagonal values
(left-to-right) of the diagonal metric matrix representation.</p></li>
<li><p><strong>vjp_metric_diagonal_func</strong> (<em>VectorJacobianProductFunction</em><em> | </em><em>None</em>) – <p>Function which given a position array returns
another function which takes a 1D array as an argument and returns the
<em>vector-Jacobian-product</em> (VJP) of <cite>metric_diagonal_func</cite> with respect
to the position array argument. The VJP is here defined as a function of
a 1D array <cite>v</cite>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vjp</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">v</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">jacob</span><span class="p">[:,</span> <span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>where <cite>jacob</cite> is the <cite>(dim_pos, dim_pos)</cite> shaped Jacobian of <cite>d =
metric_diagonal_func(q)</cite> with respect to <cite>q</cite> i.e. the array of partial
derivatives of the function such that</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>jacob[i, j] = ∂d[i] / ∂q[j]
</pre></div>
</div>
<p>Optionally the function may instead return a 2-tuple of values with the
first a function to compute a VJP of <cite>metric_diagonal_func</cite> and the
second a 1D array containing the value of <cite>metric_diagonal_func</cite>, both
evaluated at the passed position array. If <cite>None</cite> is passed (the
default) an automatic differentiation fallback will be used to attempt
to construct a function which calculates the VJP (and value) of
<cite>metric_diagonal_func</cite> automatically.</p>
</p></li>
<li><p><strong>grad_neg_log_dens</strong> (<em>GradientFunction</em><em> | </em><em>None</em>) – Function which given a position array returns the
derivative of <cite>neg_log_dens</cite> with respect to the position array
argument. Optionally the function may instead return a 2-tuple of values
with the first being the array corresponding to the derivative and the
second being the value of the <cite>neg_log_dens</cite> evaluated at the passed
position array. If <cite>None</cite> is passed (the default) an automatic
differentiation fallback will be used to attempt to construct the
derivative of <cite>neg_log_dens</cite> automatically.</p></li>
<li><p><strong>backend</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – Name of automatic differentiation backend to use. See
<a class="reference internal" href="mici.autodiff.html#module-mici.autodiff" title="mici.autodiff"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autodiff</span></code></a> subpackage documentation for details of available
backends. If <cite>None</cite> (the default) no automatic differentiation fallback
will be used and so all derivative functions must be specified
explicitly.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DiagonalRiemannianMetricSystem.dh1_dpos">
<span class="sig-name descname"><span class="pre">dh1_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DiagonalRiemannianMetricSystem.dh1_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h1</cite> Hamiltonian component with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of computed <cite>h1</cite> derivative.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DiagonalRiemannianMetricSystem.dh2_dmom">
<span class="sig-name descname"><span class="pre">dh2_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DiagonalRiemannianMetricSystem.dh2_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h2</cite> Hamiltonian component with respect to momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2(state)</cite> derivative with respect to <cite>state.mom</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DiagonalRiemannianMetricSystem.dh2_dpos">
<span class="sig-name descname"><span class="pre">dh2_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DiagonalRiemannianMetricSystem.dh2_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h2</cite> Hamiltonian component with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DiagonalRiemannianMetricSystem.dh_dmom">
<span class="sig-name descname"><span class="pre">dh_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DiagonalRiemannianMetricSystem.dh_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivative of Hamiltonian with respect to momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h(state)</cite> derivative with respect to <cite>state.mom</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DiagonalRiemannianMetricSystem.dh_dpos">
<span class="sig-name descname"><span class="pre">dh_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DiagonalRiemannianMetricSystem.dh_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of Hamiltonian with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DiagonalRiemannianMetricSystem.grad_neg_log_dens">
<span class="sig-name descname"><span class="pre">grad_neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DiagonalRiemannianMetricSystem.grad_neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Derivative of negative log density with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>neg_log_dens(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DiagonalRiemannianMetricSystem.h">
<span class="sig-name descname"><span class="pre">h</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DiagonalRiemannianMetricSystem.h" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian function for system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of Hamiltonian.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DiagonalRiemannianMetricSystem.h1">
<span class="sig-name descname"><span class="pre">h1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DiagonalRiemannianMetricSystem.h1" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian component depending only on position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h1</cite> Hamiltonian component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DiagonalRiemannianMetricSystem.h1_flow">
<span class="sig-name descname"><span class="pre">h1_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DiagonalRiemannianMetricSystem.h1_flow" title="Link to this definition">#</a></dt>
<dd><p>Apply exact flow map corresponding to <cite>h1</cite> Hamiltonian component.</p>
<p><cite>state</cite> argument is modified in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to start flow at.</p></li>
<li><p><strong>dt</strong> (<em>ScalarLike</em>) – Time interval to simulate flow for.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DiagonalRiemannianMetricSystem.h2">
<span class="sig-name descname"><span class="pre">h2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DiagonalRiemannianMetricSystem.h2" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian component depending on momentum and optionally position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2</cite> Hamiltonian component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DiagonalRiemannianMetricSystem.metric">
<span class="sig-name descname"><span class="pre">metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DiagonalRiemannianMetricSystem.metric" title="Link to this definition">#</a></dt>
<dd><p>Function computing the metric matrix representation.</p>
<p>The returned type of this function is that specified by the
<cite>metric_matrix_class</cite> argument to the initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Metric matrix representation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="mici.matrices.html#mici.matrices.PositiveDefiniteMatrix" title="mici.matrices.PositiveDefiniteMatrix"><em>PositiveDefiniteMatrix</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DiagonalRiemannianMetricSystem.metric_func">
<span class="sig-name descname"><span class="pre">metric_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DiagonalRiemannianMetricSystem.metric_func" title="Link to this definition">#</a></dt>
<dd><p>Function computing the parameter of the metric matrix representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>metric_func(state.pos)</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DiagonalRiemannianMetricSystem.neg_log_dens">
<span class="sig-name descname"><span class="pre">neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DiagonalRiemannianMetricSystem.neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Negative logarithm of unnormalized density of target distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of computed negative log density.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DiagonalRiemannianMetricSystem.sample_momentum">
<span class="sig-name descname"><span class="pre">sample_momentum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DiagonalRiemannianMetricSystem.sample_momentum" title="Link to this definition">#</a></dt>
<dd><p>Sample a momentum from its conditional distribution given a position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State defining position to condition on.</p></li>
<li><p><strong>rng</strong> (<em>Generator</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sampled momentum.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.DiagonalRiemannianMetricSystem.vjp_metric_func">
<span class="sig-name descname"><span class="pre">vjp_metric_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.DiagonalRiemannianMetricSystem.vjp_metric_func" title="Link to this definition">#</a></dt>
<dd><p>Function constructing a vector-Jacobian-product for <cite>metric_func</cite>.</p>
<p>The vector-Jacobian-product is here defined as a function of an array <cite>v</cite> (of
the same shape as the output of <cite>metric_func</cite>) corresponding to</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vjp</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">jacob</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ndim</span><span class="p">))</span>
</pre></div>
</div>
<p>where <cite>jacob</cite> is the Jacobian of <cite>m = metric_func(q)</cite> wrt <cite>q</cite> i.e. the array of
partial derivatives of the function such that</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>jacob[..., i] = ∂m[...] / ∂q[i]
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute VJP at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Vector-Jacobian-product function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>VectorJacobianProduct</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mici.systems.EuclideanMetricSystem">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mici.systems.</span></span><span class="sig-name descname"><span class="pre">EuclideanMetricSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neg_log_dens</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_neg_log_dens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#EuclideanMetricSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.EuclideanMetricSystem" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#mici.systems.TractableFlowSystem" title="mici.systems.TractableFlowSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">TractableFlowSystem</span></code></a></p>
<p>Hamiltonian system with a Euclidean metric on the position space.</p>
<p>Here Euclidean metric is defined to mean a metric with a fixed positive definite
matrix representation <span class="math notranslate nohighlight">\(M\)</span>. The momentum variables are taken to be independent
of the position variables and with a zero-mean Gaussian marginal distribution with
covariance specified by <span class="math notranslate nohighlight">\(M\)</span>, so that the <span class="math notranslate nohighlight">\(h_2\)</span> Hamiltonian component is</p>
<div class="math notranslate nohighlight">
\[h_2(q, p) = \frac{1}{2} p^T M^{-1} p\]</div>
<p>where <span class="math notranslate nohighlight">\(q\)</span> and <span class="math notranslate nohighlight">\(p\)</span> are the position and momentum variables respectively.</p>
<p>The <span class="math notranslate nohighlight">\(h_1\)</span> Hamiltonian component function is</p>
<div class="math notranslate nohighlight">
\[h_1(q) = \ell(q)\]</div>
<p>where <span class="math notranslate nohighlight">\(\ell(q)\)</span> is the negative log (unnormalized) density of the target
distribution with respect to the Lebesgue measure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neg_log_dens</strong> (<em>ScalarFunction</em>) – Function which given a position array returns the negative
logarithm of an unnormalized probability density on the position space
with respect to the Lebesgue measure, with the corresponding
distribution on the position space being the target distribution it is
wished to draw approximate samples from.</p></li>
<li><p><strong>metric</strong> (<em>MetricLike</em><em> | </em><em>None</em>) – Matrix object corresponding to matrix representation of metric on
position space and covariance of Gaussian marginal distribution on
momentum vector. If <cite>None</cite> is passed (the default), the identity matrix
will be used. If a 1D array is passed then this is assumed to specify a
metric with positive diagonal matrix representation and the array the
matrix diagonal. If a 2D array is passed then this is assumed to specify
a metric with a dense positive definite matrix representation specified
by the array. Otherwise if the value is a subclass of
<cite>mici.matrices.PositiveDefiniteMatrix</cite> it is assumed to directly specify
the metric matrix representation.</p></li>
<li><p><strong>grad_neg_log_dens</strong> (<em>GradientFunction</em><em> | </em><em>None</em>) – Function which given a position array returns the
derivative of <cite>neg_log_dens</cite> with respect to the position array
argument. Optionally the function may instead return a 2-tuple of values
with the first being the array corresponding to the derivative and the
second being the value of the <cite>neg_log_dens</cite> evaluated at the passed
position array. If <cite>None</cite> is passed (the default) an automatic
differentiation fallback will be used to attempt to construct the
derivative of <cite>neg_log_dens</cite> automatically.</p></li>
<li><p><strong>backend</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – Name of automatic differentiation backend to use. See
<a class="reference internal" href="mici.autodiff.html#module-mici.autodiff" title="mici.autodiff"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autodiff</span></code></a> subpackage documentation for details of available
backends. If <cite>None</cite> (the default) no automatic differentiation fallback
will be used and so all derivative functions must be specified
explicitly.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.EuclideanMetricSystem.dh1_dpos">
<span class="sig-name descname"><span class="pre">dh1_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.EuclideanMetricSystem.dh1_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h1</cite> Hamiltonian component with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of computed <cite>h1</cite> derivative.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.EuclideanMetricSystem.dh2_dmom">
<span class="sig-name descname"><span class="pre">dh2_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#EuclideanMetricSystem.dh2_dmom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.EuclideanMetricSystem.dh2_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h2</cite> Hamiltonian component with respect to momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2(state)</cite> derivative with respect to <cite>state.mom</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.EuclideanMetricSystem.dh2_dpos">
<span class="sig-name descname"><span class="pre">dh2_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#EuclideanMetricSystem.dh2_dpos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.EuclideanMetricSystem.dh2_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h2</cite> Hamiltonian component with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.EuclideanMetricSystem.dh_dmom">
<span class="sig-name descname"><span class="pre">dh_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.EuclideanMetricSystem.dh_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivative of Hamiltonian with respect to momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h(state)</cite> derivative with respect to <cite>state.mom</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.EuclideanMetricSystem.dh_dpos">
<span class="sig-name descname"><span class="pre">dh_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#EuclideanMetricSystem.dh_dpos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.EuclideanMetricSystem.dh_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of Hamiltonian with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.EuclideanMetricSystem.grad_neg_log_dens">
<span class="sig-name descname"><span class="pre">grad_neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.EuclideanMetricSystem.grad_neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Derivative of negative log density with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>neg_log_dens(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.EuclideanMetricSystem.h">
<span class="sig-name descname"><span class="pre">h</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.EuclideanMetricSystem.h" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian function for system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of Hamiltonian.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.EuclideanMetricSystem.h1">
<span class="sig-name descname"><span class="pre">h1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.EuclideanMetricSystem.h1" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian component depending only on position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h1</cite> Hamiltonian component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.EuclideanMetricSystem.h1_flow">
<span class="sig-name descname"><span class="pre">h1_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.EuclideanMetricSystem.h1_flow" title="Link to this definition">#</a></dt>
<dd><p>Apply exact flow map corresponding to <cite>h1</cite> Hamiltonian component.</p>
<p><cite>state</cite> argument is modified in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to start flow at.</p></li>
<li><p><strong>dt</strong> (<em>ScalarLike</em>) – Time interval to simulate flow for.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.EuclideanMetricSystem.h2">
<span class="sig-name descname"><span class="pre">h2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#EuclideanMetricSystem.h2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.EuclideanMetricSystem.h2" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian component depending on momentum and optionally position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2</cite> Hamiltonian component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.EuclideanMetricSystem.h2_flow">
<span class="sig-name descname"><span class="pre">h2_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#EuclideanMetricSystem.h2_flow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.EuclideanMetricSystem.h2_flow" title="Link to this definition">#</a></dt>
<dd><p>Apply exact flow map corresponding to <cite>h2</cite> Hamiltonian component.</p>
<p><cite>state</cite> argument is modified in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to start flow at.</p></li>
<li><p><strong>dt</strong> (<em>ScalarLike</em>) – Time interval to simulate flow for.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.EuclideanMetricSystem.neg_log_dens">
<span class="sig-name descname"><span class="pre">neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.EuclideanMetricSystem.neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Negative logarithm of unnormalized density of target distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of computed negative log density.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.EuclideanMetricSystem.sample_momentum">
<span class="sig-name descname"><span class="pre">sample_momentum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#EuclideanMetricSystem.sample_momentum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.EuclideanMetricSystem.sample_momentum" title="Link to this definition">#</a></dt>
<dd><p>Sample a momentum from its conditional distribution given a position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State defining position to condition on.</p></li>
<li><p><strong>rng</strong> (<em>Generator</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sampled momentum.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mici.systems.GaussianDenseConstrainedEuclideanMetricSystem">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mici.systems.</span></span><span class="sig-name descname"><span class="pre">GaussianDenseConstrainedEuclideanMetricSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neg_log_dens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constr</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_neg_log_dens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jacob_constr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mhp_constr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#GaussianDenseConstrainedEuclideanMetricSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#mici.systems.GaussianEuclideanMetricSystem" title="mici.systems.GaussianEuclideanMetricSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">GaussianEuclideanMetricSystem</span></code></a>, <a class="reference internal" href="#mici.systems.DenseConstrainedEuclideanMetricSystem" title="mici.systems.DenseConstrainedEuclideanMetricSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">DenseConstrainedEuclideanMetricSystem</span></code></a></p>
<p>Gaussian Euclidean Hamiltonian system subject to a dense set of constraints.</p>
<p>See <a class="reference internal" href="#mici.systems.ConstrainedEuclideanMetricSystem" title="mici.systems.ConstrainedEuclideanMetricSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstrainedEuclideanMetricSystem</span></code></a> for more details about constrained
systems and <a class="reference internal" href="#mici.systems.GaussianEuclideanMetricSystem" title="mici.systems.GaussianEuclideanMetricSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">GaussianEuclideanMetricSystem</span></code></a> for Gaussian Euclidean metric
systems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neg_log_dens</strong> (<em>ScalarFunction</em>) – <p>Function which given a position array returns the negative
logarithm of an unnormalized probability density on the unconstrained
(ambient) position space with respect to the standard Gaussian measure.
The density function is taken to specify a prior distribution on the
ambient space with the target distribution then corresponding to the
posterior distribution when conditioning on the (zero Lebesgue measure)
event <cite>constr(pos) == 0</cite>. This target posterior distribution has support
on the differentiable manifold implicitly defined by the constraint
equation, with density with respect to the Hausdorff measure on the
manifold corresponding to the ratio of the prior density (specified by
<cite>neg_log_dens</cite>) and the square-root of the determinant of the Gram
matrix defined by.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gram</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">=</span> <span class="n">jacob_constr</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">@</span> <span class="n">inv</span><span class="p">(</span><span class="n">metric</span><span class="p">)</span> <span class="o">@</span> <span class="n">jacob_constr</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
<p>where <cite>jacob_constr</cite> is the Jacobian of the constraint function <cite>constr</cite>
and <cite>metric</cite> is the matrix representation of the metric on the ambient
space.</p>
</p></li>
<li><p><strong>constr</strong> (<em>ArrayFunction</em>) – Function which given a position array return as a 1D array the value
of the (vector-valued) constraint function, the zero level-set of which
implicitly defines the manifold the dynamic is simulated on.</p></li>
<li><p><strong>metric</strong> (<em>MetricLike</em><em> | </em><em>None</em>) – Matrix object corresponding to matrix representation of metric on
<em>unconstrained</em> position space and covariance of Gaussian marginal
distribution on <em>unconstrained</em> momentum vector. If <cite>None</cite> is passed
(the default), the identity matrix will be used. If a 1D array is passed
then this is assumed to specify a metric with positive diagonal matrix
representation and the array the matrix diagonal. If a 2D array is
passed then this is assumed to specify a metric with a dense positive
definite matrix representation specified by the array. Otherwise if a
subclass of <cite>mici.matrices.PositiveDefiniteMatrix</cite> it is assumed to
directly specify the metric matrix representation.</p></li>
<li><p><strong>grad_neg_log_dens</strong> (<em>GradientFunction</em><em> | </em><em>None</em>) – Function which given a position array returns the
derivative of <cite>neg_log_dens</cite> with respect to the position array
argument. Optionally the function may instead return a 2-tuple of values
with the first being the array corresponding to the derivative and the
second being the value of the <cite>neg_log_dens</cite> evaluated at the passed
position array. If <cite>None</cite> is passed (the default) an automatic
differentiation fallback will be used to attempt to construct a function
to compute the derivative (and value) of <cite>neg_log_dens</cite> automatically.</p></li>
<li><p><strong>jacob_constr</strong> (<em>JacobianFunction</em><em> | </em><em>None</em>) – <p>Function which given a position array computes the Jacobian
(matrix / 2D array of partial derivatives) of the output of the
constraint function <cite>c = constr(q)</cite> with respect to the position array
argument <cite>q</cite>, returning the computed Jacobian as a 2D array <cite>jacob</cite> with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>jacob[i, j] = ∂c[i] / ∂q[j]
</pre></div>
</div>
<p>Optionally the function may instead return a 2-tuple of values with the
first being the array corresponding to the Jacobian and the second being
the value of <cite>constr</cite> evaluated at the passed position array. If <cite>None</cite>
is passed (the default) an automatic differentiation fallback will be
used to attempt to construct a function to compute the Jacobian (and
value) of <cite>neg_log_dens</cite> automatically.</p>
</p></li>
<li><p><strong>mhp_constr</strong> (<em>MatrixHessianProductFunction</em><em> | </em><em>None</em>) – <p>Function which given a position array returns another function
which takes a 2D array as an argument and returns the
<em>matrix-Hessian-product</em> (MHP) of the constraint function <cite>constr</cite> with
respect to the position array argument. The MHP is here defined as a
function of a <cite>(dim_constr, dim_pos)</cite> shaped 2D array <cite>m</cite></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mhp</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">m</span><span class="p">[:,</span> <span class="p">:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">hess</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<p>where <cite>hess</cite> is the <cite>(dim_constr, dim_pos, dim_pos)</cite> shaped
vector-Hessian of <cite>c = constr(q)</cite> with respect to <cite>q</cite> i.e. the array of
second-order partial derivatives of such that</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>hess[i, j, k] = ∂²c[i] / (∂q[j] ∂q[k])
</pre></div>
</div>
<p>Optionally the function may instead return a 3-tuple of values with the
first a function to compute a MHP of <cite>constr</cite>, the second a 2D array
corresponding to the Jacobian of <cite>constr</cite>, and the third the value of
<cite>constr</cite>, all evaluated at the passed position array. If <cite>None</cite> is
passed (the default) an automatic differentiation fallback will be used
to attempt to construct a function which calculates the MHP (and
Jacobian and value) of <cite>constr</cite> automatically.</p>
</p></li>
<li><p><strong>backend</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – Name of automatic differentiation backend to use. See
<a class="reference internal" href="mici.autodiff.html#module-mici.autodiff" title="mici.autodiff"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autodiff</span></code></a> subpackage documentation for details of available
backends. If <cite>None</cite> (the default) no automatic differentiation fallback
will be used and so all derivative functions must be specified
explicitly.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.constr">
<span class="sig-name descname"><span class="pre">constr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.constr" title="Link to this definition">#</a></dt>
<dd><p>Constraint function at the current position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <code class="code docutils literal notranslate"><span class="pre">constr(state.pos)</span></code> as 1D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.dh1_dpos">
<span class="sig-name descname"><span class="pre">dh1_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.dh1_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h1</cite> Hamiltonian component with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of computed <cite>h1</cite> derivative.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.dh2_dmom">
<span class="sig-name descname"><span class="pre">dh2_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.dh2_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h2</cite> Hamiltonian component with respect to momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2(state)</cite> derivative with respect to <cite>state.mom</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.dh2_dpos">
<span class="sig-name descname"><span class="pre">dh2_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.dh2_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h2</cite> Hamiltonian component with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.dh2_flow_dmom">
<span class="sig-name descname"><span class="pre">dh2_flow_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#GaussianDenseConstrainedEuclideanMetricSystem.dh2_flow_dmom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.dh2_flow_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivatives of <a class="reference internal" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.h2_flow" title="mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.h2_flow"><code class="xref py py-meth docutils literal notranslate"><span class="pre">h2_flow()</span></code></a> flow map with respect to momentum argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to evaluate derivatives of flow map at.</p></li>
<li><p><strong>dt</strong> (<em>ScalarLike</em>) – Time interval flow simulated for.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple <code class="code docutils literal notranslate"><span class="pre">(dpos_dmom,</span> <span class="pre">dmom_dmom)</span></code> with <code class="code docutils literal notranslate"><span class="pre">dpos_dmom</span></code> a matrix
representing derivative (Jacobian) of position output of <a class="reference internal" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.h2_flow" title="mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.h2_flow"><code class="xref py py-meth docutils literal notranslate"><span class="pre">h2_flow()</span></code></a>
with respect to the value of the momentum component of the initial input
state and <code class="code docutils literal notranslate"><span class="pre">dmom_dmom</span></code> a matrix representing derivative (Jacobian) of
momentum output of <a class="reference internal" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.h2_flow" title="mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.h2_flow"><code class="xref py py-meth docutils literal notranslate"><span class="pre">h2_flow()</span></code></a> with respect to the value of the
momentum component of the initial input state.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a>[<a class="reference internal" href="mici.matrices.html#mici.matrices.Matrix" title="mici.matrices.Matrix"><em>Matrix</em></a>, <a class="reference internal" href="mici.matrices.html#mici.matrices.Matrix" title="mici.matrices.Matrix"><em>Matrix</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.dh_dmom">
<span class="sig-name descname"><span class="pre">dh_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.dh_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivative of Hamiltonian with respect to momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h(state)</cite> derivative with respect to <cite>state.mom</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.dh_dpos">
<span class="sig-name descname"><span class="pre">dh_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.dh_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of Hamiltonian with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.grad_log_det_sqrt_gram">
<span class="sig-name descname"><span class="pre">grad_log_det_sqrt_gram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.grad_log_det_sqrt_gram" title="Link to this definition">#</a></dt>
<dd><p>Derivative of half log-determinant of Gram matrix with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <code class="code docutils literal notranslate"><span class="pre">log_det_sqrt_gram(state)</span></code> derivative with respect to
<code class="code docutils literal notranslate"><span class="pre">state.pos</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.grad_neg_log_dens">
<span class="sig-name descname"><span class="pre">grad_neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.grad_neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Derivative of negative log density with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>neg_log_dens(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.gram">
<span class="sig-name descname"><span class="pre">gram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.gram" title="Link to this definition">#</a></dt>
<dd><p>Gram matrix at current position.</p>
<p>The Gram matrix as a position <cite>q</cite> is defined as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gram</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">=</span> <span class="n">jacob_constr</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">@</span> <span class="n">inv</span><span class="p">(</span><span class="n">metric</span><span class="p">)</span> <span class="o">@</span> <span class="n">jacob_constr</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
<p>where <code class="code docutils literal notranslate"><span class="pre">jacob_constr</span></code> is the Jacobian of the constraint function
<code class="code docutils literal notranslate"><span class="pre">constr</span></code> and <code class="code docutils literal notranslate"><span class="pre">metric</span></code> is the matrix representation of the metric on
the ambient space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gram matrix as matrix object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="mici.matrices.html#mici.matrices.PositiveDefiniteMatrix" title="mici.matrices.PositiveDefiniteMatrix"><em>PositiveDefiniteMatrix</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.h">
<span class="sig-name descname"><span class="pre">h</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.h" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian function for system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of Hamiltonian.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.h1">
<span class="sig-name descname"><span class="pre">h1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.h1" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian component depending only on position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h1</cite> Hamiltonian component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.h1_flow">
<span class="sig-name descname"><span class="pre">h1_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.h1_flow" title="Link to this definition">#</a></dt>
<dd><p>Apply exact flow map corresponding to <cite>h1</cite> Hamiltonian component.</p>
<p><cite>state</cite> argument is modified in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to start flow at.</p></li>
<li><p><strong>dt</strong> (<em>ScalarLike</em>) – Time interval to simulate flow for.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.h2">
<span class="sig-name descname"><span class="pre">h2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.h2" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian component depending on momentum and optionally position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2</cite> Hamiltonian component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.h2_flow">
<span class="sig-name descname"><span class="pre">h2_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.h2_flow" title="Link to this definition">#</a></dt>
<dd><p>Apply exact flow map corresponding to <cite>h2</cite> Hamiltonian component.</p>
<p><cite>state</cite> argument is modified in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to start flow at.</p></li>
<li><p><strong>dt</strong> (<em>ScalarLike</em>) – Time interval to simulate flow for.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.inv_gram">
<span class="sig-name descname"><span class="pre">inv_gram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.inv_gram" title="Link to this definition">#</a></dt>
<dd><p>Inverse of Gram matrix at current position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Inverse of Gram matrix as matrix object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="mici.matrices.html#mici.matrices.PositiveDefiniteMatrix" title="mici.matrices.PositiveDefiniteMatrix"><em>PositiveDefiniteMatrix</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.jacob_constr">
<span class="sig-name descname"><span class="pre">jacob_constr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.jacob_constr" title="Link to this definition">#</a></dt>
<dd><p>Jacobian of constraint function at the current position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of Jacobian of <code class="code docutils literal notranslate"><span class="pre">constr(state.pos)</span></code> as 2D array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.jacob_constr_inner_product">
<span class="sig-name descname"><span class="pre">jacob_constr_inner_product</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jacob_constr_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_product_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jacob_constr_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#GaussianDenseConstrainedEuclideanMetricSystem.jacob_constr_inner_product"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.jacob_constr_inner_product" title="Link to this definition">#</a></dt>
<dd><p>Compute inner product of rows of constraint Jacobian matrices.</p>
<p>Computes <code class="code docutils literal notranslate"><span class="pre">jacob_constr_1</span> <span class="pre">&#64;</span> <span class="pre">inner_product_matrix</span> <span class="pre">&#64;</span> <span class="pre">jacob_constr_2.T</span></code>
potentially exploiting any structure / sparsity in <code class="code docutils literal notranslate"><span class="pre">jacob_constr_1</span></code>,
<code class="code docutils literal notranslate"><span class="pre">jacob_constr_2</span></code> and <code class="code docutils literal notranslate"><span class="pre">inner_product_matrix</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jacob_constr_1</strong> (<em>MatrixLike</em>) – First constraint Jacobian in product.</p></li>
<li><p><strong>inner_product_matrix</strong> (<a class="reference internal" href="mici.matrices.html#mici.matrices.PositiveDefiniteMatrix" title="mici.matrices.PositiveDefiniteMatrix"><em>PositiveDefiniteMatrix</em></a>) – Positive-definite matrix defining inner-product
between rows of two constraint Jacobians.</p></li>
<li><p><strong>jacob_constr_2</strong> (<em>MatrixLike</em><em> | </em><em>None</em>) – Second constraint Jacobian in product. Defaults to
<code class="code docutils literal notranslate"><span class="pre">jacob_constr_1</span></code> if set to <code class="code docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Object corresponding to computed inner products of the constraint Jacobian
rows.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>MatrixLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.log_det_sqrt_gram">
<span class="sig-name descname"><span class="pre">log_det_sqrt_gram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.log_det_sqrt_gram" title="Link to this definition">#</a></dt>
<dd><p>Value of (half of) log-determinant of Gram matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.mhp_constr">
<span class="sig-name descname"><span class="pre">mhp_constr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.mhp_constr" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>MatrixHessianProduct</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.neg_log_dens">
<span class="sig-name descname"><span class="pre">neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Negative logarithm of unnormalized density of target distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of computed negative log density.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.project_onto_cotangent_space">
<span class="sig-name descname"><span class="pre">project_onto_cotangent_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.project_onto_cotangent_space" title="Link to this definition">#</a></dt>
<dd><p>Project a momentum on to the co-tangent space at a position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mom</strong> (<em>ArrayLike</em>) – Momentum (co-)vector as 1D array to project on to co-tangent space.</p></li>
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State definining position on the  manifold to project in to the
co-tangent space of.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Projected momentum in the co-tangent space at <code class="code docutils literal notranslate"><span class="pre">state.pos</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.sample_momentum">
<span class="sig-name descname"><span class="pre">sample_momentum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.sample_momentum" title="Link to this definition">#</a></dt>
<dd><p>Sample a momentum from its conditional distribution given a position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State defining position to condition on.</p></li>
<li><p><strong>rng</strong> (<em>Generator</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sampled momentum.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mici.systems.GaussianEuclideanMetricSystem">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mici.systems.</span></span><span class="sig-name descname"><span class="pre">GaussianEuclideanMetricSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neg_log_dens</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_neg_log_dens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#GaussianEuclideanMetricSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.GaussianEuclideanMetricSystem" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#mici.systems.EuclideanMetricSystem" title="mici.systems.EuclideanMetricSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">EuclideanMetricSystem</span></code></a></p>
<p>Euclidean Hamiltonian system with a tractable Gaussian component.</p>
<p>Here Euclidean metric is defined to mean a metric with a fixed positive definite
matrix representation <span class="math notranslate nohighlight">\(M\)</span>. The momentum variables are taken to be independent
of the position variables and with a zero-mean Gaussian marginal distribution with
covariance specified by <span class="math notranslate nohighlight">\(M\)</span>.</p>
<p>Additionally the target distribution on the position variables is assumed to be
defined by an unnormalized density with respect to the standard Gaussian measure on
the position space (with identity covariance and zero mean), with the Hamiltonian
component <span class="math notranslate nohighlight">\(h_1\)</span> corresponding to the negative logarithm of this density rather
than the density with respect to the Lebesgue measure on the position space, i.e.</p>
<div class="math notranslate nohighlight">
\[h_1(q) = \ell(q) - \frac{1}{2} q^T q\]</div>
<p>where <span class="math notranslate nohighlight">\(q\)</span> is the position and <span class="math notranslate nohighlight">\(\ell(q)\)</span> is the negative log
(unnormalized) density of the target distribution with respect to the Lebesgue
measure at <span class="math notranslate nohighlight">\(q\)</span>. The Hamiltonian  component function <span class="math notranslate nohighlight">\(h_2\)</span> is then
assumed to have the form</p>
<div class="math notranslate nohighlight">
\[h_2(q, p) = \frac{1}{2} q^T q + \frac{1}{2} p^T M^{-1} p\]</div>
<p>where <span class="math notranslate nohighlight">\(p\)</span> is the momentum. In this case the Hamiltonian flow due to the
quadratic <span class="math notranslate nohighlight">\(h_2\)</span> component can be solved for analytically, allowing an
integrator to be defined using this alternative splitting of the Hamiltonian [1].</p>
<p class="rubric">References</p>
<ol class="arabic simple">
<li><p>Shahbaba, B., Lan, S., Johnson, W.O. and Neal, R.M., 2014. Split Hamiltonian
Monte Carlo. Statistics and Computing, 24(3), pp.339-349.</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neg_log_dens</strong> (<em>ScalarFunction</em>) – Function which given a position array returns the negative
logarithm of an unnormalized probability density on the position space
with respect to the standard Gaussian measure on the position space,
with the corresponding distribution on the position space being the
target distribution it is wished to draw approximate samples from.</p></li>
<li><p><strong>metric</strong> (<em>MetricLike</em><em> | </em><em>None</em>) – Matrix object corresponding to matrix representation of metric on
position space and covariance of Gaussian marginal distribution on
momentum vector. If <cite>None</cite> is passed (the default), the identity matrix
will be used. If a 1D array is passed then this is assumed to specify a
metric with positive diagonal matrix representation and the array the
matrix diagonal. If a 2D array is passed then this is assumed to specify
a metric with a dense positive definite matrix representation specified
by the array. Otherwise if the value is a subclass of
<cite>mici.matrices.PositiveDefiniteMatrix</cite> it is assumed to directly specify
the metric matrix representation.</p></li>
<li><p><strong>grad_neg_log_dens</strong> (<em>GradientFunction</em><em> | </em><em>None</em>) – Function which given a position array returns the
derivative of <cite>neg_log_dens</cite> with respect to the position array
argument. Optionally the function may instead return a 2-tuple of values
with the first being the array corresponding to the derivative and the
second being the value of the <cite>neg_log_dens</cite> evaluated at the passed
position array. If <cite>None</cite> is passed (the default) an automatic
differentiation fallback will be used to attempt to construct the
derivative of <cite>neg_log_dens</cite> automatically.</p></li>
<li><p><strong>backend</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – Name of automatic differentiation backend to use. See
<a class="reference internal" href="mici.autodiff.html#module-mici.autodiff" title="mici.autodiff"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autodiff</span></code></a> subpackage documentation for details of available
backends. If <cite>None</cite> (the default) no automatic differentiation fallback
will be used and so all derivative functions must be specified
explicitly.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianEuclideanMetricSystem.dh1_dpos">
<span class="sig-name descname"><span class="pre">dh1_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianEuclideanMetricSystem.dh1_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h1</cite> Hamiltonian component with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of computed <cite>h1</cite> derivative.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianEuclideanMetricSystem.dh2_dmom">
<span class="sig-name descname"><span class="pre">dh2_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#GaussianEuclideanMetricSystem.dh2_dmom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.GaussianEuclideanMetricSystem.dh2_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h2</cite> Hamiltonian component with respect to momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2(state)</cite> derivative with respect to <cite>state.mom</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianEuclideanMetricSystem.dh2_dpos">
<span class="sig-name descname"><span class="pre">dh2_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#GaussianEuclideanMetricSystem.dh2_dpos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.GaussianEuclideanMetricSystem.dh2_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h2</cite> Hamiltonian component with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianEuclideanMetricSystem.dh_dmom">
<span class="sig-name descname"><span class="pre">dh_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianEuclideanMetricSystem.dh_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivative of Hamiltonian with respect to momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h(state)</cite> derivative with respect to <cite>state.mom</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianEuclideanMetricSystem.dh_dpos">
<span class="sig-name descname"><span class="pre">dh_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianEuclideanMetricSystem.dh_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of Hamiltonian with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianEuclideanMetricSystem.grad_neg_log_dens">
<span class="sig-name descname"><span class="pre">grad_neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianEuclideanMetricSystem.grad_neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Derivative of negative log density with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>neg_log_dens(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianEuclideanMetricSystem.h">
<span class="sig-name descname"><span class="pre">h</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianEuclideanMetricSystem.h" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian function for system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of Hamiltonian.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianEuclideanMetricSystem.h1">
<span class="sig-name descname"><span class="pre">h1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianEuclideanMetricSystem.h1" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian component depending only on position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h1</cite> Hamiltonian component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianEuclideanMetricSystem.h1_flow">
<span class="sig-name descname"><span class="pre">h1_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianEuclideanMetricSystem.h1_flow" title="Link to this definition">#</a></dt>
<dd><p>Apply exact flow map corresponding to <cite>h1</cite> Hamiltonian component.</p>
<p><cite>state</cite> argument is modified in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to start flow at.</p></li>
<li><p><strong>dt</strong> (<em>ScalarLike</em>) – Time interval to simulate flow for.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianEuclideanMetricSystem.h2">
<span class="sig-name descname"><span class="pre">h2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#GaussianEuclideanMetricSystem.h2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.GaussianEuclideanMetricSystem.h2" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian component depending on momentum and optionally position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2</cite> Hamiltonian component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianEuclideanMetricSystem.h2_flow">
<span class="sig-name descname"><span class="pre">h2_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#GaussianEuclideanMetricSystem.h2_flow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.GaussianEuclideanMetricSystem.h2_flow" title="Link to this definition">#</a></dt>
<dd><p>Apply exact flow map corresponding to <cite>h2</cite> Hamiltonian component.</p>
<p><cite>state</cite> argument is modified in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to start flow at.</p></li>
<li><p><strong>dt</strong> (<em>ScalarLike</em>) – Time interval to simulate flow for.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianEuclideanMetricSystem.neg_log_dens">
<span class="sig-name descname"><span class="pre">neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianEuclideanMetricSystem.neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Negative logarithm of unnormalized density of target distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of computed negative log density.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.GaussianEuclideanMetricSystem.sample_momentum">
<span class="sig-name descname"><span class="pre">sample_momentum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.GaussianEuclideanMetricSystem.sample_momentum" title="Link to this definition">#</a></dt>
<dd><p>Sample a momentum from its conditional distribution given a position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State defining position to condition on.</p></li>
<li><p><strong>rng</strong> (<em>Generator</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sampled momentum.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mici.systems.RiemannianMetricSystem">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mici.systems.</span></span><span class="sig-name descname"><span class="pre">RiemannianMetricSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neg_log_dens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_matrix_class</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_func</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">vjp_metric_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_neg_log_dens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#RiemannianMetricSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.RiemannianMetricSystem" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#mici.systems.System" title="mici.systems.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a></p>
<p>Riemannian Hamiltonian system with a position-dependent metric.</p>
<p>This class allows for metric matrix representations of any generic type. In most
cases a specialized subclass such as <cite>DenseRiemannianMetricSystem</cite>,
<cite>CholeskyFactoredRiemannianMetricSystem</cite>, <cite>DiagonalRiemannianMetricSystem</cite>,
<cite>ScalarRiemannianMetricSystem</cite> or <cite>SoftAbsRiemannianMetricSystem</cite> will provide a
simpler method of constructng a system with a metric matrix representation of a
specific type.</p>
<p>The position space is assumed to be a Riemannian manifold with a metric with
position-dependent positive definite matrix-representation <span class="math notranslate nohighlight">\(M(q)\)</span> where
<span class="math notranslate nohighlight">\(q\)</span> is a position vector. The momentum <span class="math notranslate nohighlight">\(p\)</span> is then taken to have a
zero-mean Gaussian conditional distribution given the position <span class="math notranslate nohighlight">\(q\)</span>, with
covariance <span class="math notranslate nohighlight">\(M(q)\)</span>, i.e. <span class="math notranslate nohighlight">\(p \sim \mathcal{N}(0, M(q))\)</span> [1].</p>
<p>The <span class="math notranslate nohighlight">\(h_1\)</span> Hamiltonian component is then</p>
<div class="math notranslate nohighlight">
\[h_1(q) = \ell(q) + \frac{1}{2}\log\left|M(q)\right|\]</div>
<p>where <span class="math notranslate nohighlight">\(\ell(q)\)</span> is the negative log (unnormalized) density of the target
distribution with respect to the Lebesgue measure at <span class="math notranslate nohighlight">\(q\)</span>. The <span class="math notranslate nohighlight">\(h_2\)</span>
Hamiltonian component is</p>
<div class="math notranslate nohighlight">
\[h_2(q, p) = \frac{1}{2} p^T (M(q))^{-1} p.\]</div>
<p>Due to the coupling between the position and momentum variables in <span class="math notranslate nohighlight">\(h_2\)</span>, the
Hamiltonian system is non-separable, requiring use of a numerical integrator with
implicit steps when simulating the Hamiltonian dynamic associated with the system,
e.g. <cite>mici.integrators.ImplicitLeapfrogIntegrator</cite>.</p>
<p class="rubric">References</p>
<ol class="arabic simple">
<li><p>Girolami, M. and Calderhead, B., 2011. Riemann manifold Langevin and
Hamiltonian Monte Varlo methods. Journal of the Royal Statistical Society:
Series B (Statistical Methodology), 73(2), pp.123-214.</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neg_log_dens</strong> (<em>ScalarFunction</em>) – Function which given a position array returns the negative
logarithm of an unnormalized probability density on the position space
with respect to the Lebesgue measure, with the corresponding
distribution on the position space being the target distribution it is
wished to draw approximate samples from.</p></li>
<li><p><strong>metric_matrix_class</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.13)"><em>type</em></a><em>[</em><a class="reference internal" href="mici.matrices.html#mici.matrices.PositiveDefiniteMatrix" title="mici.matrices.PositiveDefiniteMatrix"><em>PositiveDefiniteMatrix</em></a><em>]</em>) – <p>Class (or factory function returning an instance of the
class) which defines type of matrix representation of metric. The class
initializer should take a single positional argument which will be
passed the array outputted by <cite>metric_func</cite>, and which is assumed to be
a parameter which fully defines the resulting matrix (e.g. the diagonal
of a <cite>mici.matrices.DiagonalMatrix</cite>). The class initializer may also
optionally take one or more keyword arguments, with the <cite>metric_kwargs</cite>
argument used to specify the value of these, if any. Together this means
the metric matrix representation at a position <cite>pos</cite> is constructed as.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">metric</span> <span class="o">=</span> <span class="n">metric_matrix_class</span><span class="p">(</span><span class="n">metric_func</span><span class="p">(</span><span class="n">pos</span><span class="p">),</span> <span class="o">**</span><span class="n">metric_kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>The <cite>mici.matrices.PositiveDefiniteMatrix</cite> subclass should as a minimum
define <cite>inv</cite>, <cite>log_abs_det</cite>, <cite>grad_log_abs_det</cite>,
<cite>grad_quadratic_form_inv</cite>, <cite>__matmul__</cite> and <cite>__rmatmul__</cite> methods /
properties (see documentation of <cite>mici.matrices.PositiveDefiniteMatrix</cite>
and <cite>mici.matrices.DifferentiableMatrix</cite> for definitions of the expected
behaviour of these methods).</p>
</p></li>
<li><p><strong>metric_func</strong> (<em>ArrayFunction</em>) – Function which given a position array returns an array
containing the parameter value of the metric matrix representation
passed as the single positional argument to the <cite>metric_matrix_class</cite>
initializer.</p></li>
<li><p><strong>vjp_metric_func</strong> (<em>VectorJacobianProductFunction</em><em> | </em><em>None</em>) – <p>Function which given a position array returns another
function which takes an array as an argument and returns the
<strong>vector-Jacobian-product</strong> (VJP) of <cite>metric_func</cite> with respect to the
position array argument. The VJP is here defined as a function of an
array <cite>v</cite> (of the same shape as the output of <cite>metric_func</cite>)
corresponding to</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vjp</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">jacob</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ndim</span><span class="p">))</span>
</pre></div>
</div>
<p>where <cite>jacob</cite> is the Jacobian of <cite>m = metric_func(q)</cite> wrt <cite>q</cite> i.e. the
array of partial derivatives of the function such that</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>jacob[..., i] = ∂m[...] / ∂q[i]
</pre></div>
</div>
<p>Optionally the function may instead return a 2-tuple of values with the
first a function to compute a VJP of <cite>metric_func</cite> and the second an
array containing the value of <cite>metric_func</cite>, both evaluated at the
passed position array. If <cite>None</cite> is passed (the default) an automatic
differentiation fallback will be used to attempt to construct a function
which calculates the VJP (and value) of <cite>metric_func</cite> automatically.</p>
</p></li>
<li><p><strong>grad_neg_log_dens</strong> (<em>GradientFunction</em><em> | </em><em>None</em>) – Function which given a position array returns the
derivative of <cite>neg_log_dens</cite> with respect to the position array
argument. Optionally the function may instead return a 2-tuple of values
with the first being the array corresponding to the derivative and the
second being the value of the <cite>neg_log_dens</cite> evaluated at the passed
position array. If <cite>None</cite> is passed (the default) an automatic
differentiation fallback will be used to attempt to construct the
derivative of <cite>neg_log_dens</cite> automatically.</p></li>
<li><p><strong>metric_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Any</em><em>] </em><em>| </em><em>None</em>) – An optional dictionary of any additional keyword arguments to
the initializer of <cite>metric_matrix_class</cite>.</p></li>
<li><p><strong>backend</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – Name of automatic differentiation backend to use. See
<a class="reference internal" href="mici.autodiff.html#module-mici.autodiff" title="mici.autodiff"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autodiff</span></code></a> subpackage documentation for details of available
backends. If <cite>None</cite> (the default) no automatic differentiation fallback
will be used and so all derivative functions must be specified
explicitly.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.RiemannianMetricSystem.dh1_dpos">
<span class="sig-name descname"><span class="pre">dh1_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#RiemannianMetricSystem.dh1_dpos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.RiemannianMetricSystem.dh1_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h1</cite> Hamiltonian component with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of computed <cite>h1</cite> derivative.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.RiemannianMetricSystem.dh2_dmom">
<span class="sig-name descname"><span class="pre">dh2_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#RiemannianMetricSystem.dh2_dmom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.RiemannianMetricSystem.dh2_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h2</cite> Hamiltonian component with respect to momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2(state)</cite> derivative with respect to <cite>state.mom</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.RiemannianMetricSystem.dh2_dpos">
<span class="sig-name descname"><span class="pre">dh2_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#RiemannianMetricSystem.dh2_dpos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.RiemannianMetricSystem.dh2_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h2</cite> Hamiltonian component with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.RiemannianMetricSystem.dh_dmom">
<span class="sig-name descname"><span class="pre">dh_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.RiemannianMetricSystem.dh_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivative of Hamiltonian with respect to momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h(state)</cite> derivative with respect to <cite>state.mom</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.RiemannianMetricSystem.dh_dpos">
<span class="sig-name descname"><span class="pre">dh_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.RiemannianMetricSystem.dh_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of Hamiltonian with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.RiemannianMetricSystem.grad_neg_log_dens">
<span class="sig-name descname"><span class="pre">grad_neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.RiemannianMetricSystem.grad_neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Derivative of negative log density with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>neg_log_dens(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.RiemannianMetricSystem.h">
<span class="sig-name descname"><span class="pre">h</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#RiemannianMetricSystem.h"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.RiemannianMetricSystem.h" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian function for system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of Hamiltonian.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.RiemannianMetricSystem.h1">
<span class="sig-name descname"><span class="pre">h1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#RiemannianMetricSystem.h1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.RiemannianMetricSystem.h1" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian component depending only on position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h1</cite> Hamiltonian component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.RiemannianMetricSystem.h1_flow">
<span class="sig-name descname"><span class="pre">h1_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.RiemannianMetricSystem.h1_flow" title="Link to this definition">#</a></dt>
<dd><p>Apply exact flow map corresponding to <cite>h1</cite> Hamiltonian component.</p>
<p><cite>state</cite> argument is modified in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to start flow at.</p></li>
<li><p><strong>dt</strong> (<em>ScalarLike</em>) – Time interval to simulate flow for.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.RiemannianMetricSystem.h2">
<span class="sig-name descname"><span class="pre">h2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#RiemannianMetricSystem.h2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.RiemannianMetricSystem.h2" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian component depending on momentum and optionally position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2</cite> Hamiltonian component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.RiemannianMetricSystem.metric">
<span class="sig-name descname"><span class="pre">metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#RiemannianMetricSystem.metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.RiemannianMetricSystem.metric" title="Link to this definition">#</a></dt>
<dd><p>Function computing the metric matrix representation.</p>
<p>The returned type of this function is that specified by the
<cite>metric_matrix_class</cite> argument to the initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Metric matrix representation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="mici.matrices.html#mici.matrices.PositiveDefiniteMatrix" title="mici.matrices.PositiveDefiniteMatrix"><em>PositiveDefiniteMatrix</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.RiemannianMetricSystem.metric_func">
<span class="sig-name descname"><span class="pre">metric_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#RiemannianMetricSystem.metric_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.RiemannianMetricSystem.metric_func" title="Link to this definition">#</a></dt>
<dd><p>Function computing the parameter of the metric matrix representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>metric_func(state.pos)</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.RiemannianMetricSystem.neg_log_dens">
<span class="sig-name descname"><span class="pre">neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.RiemannianMetricSystem.neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Negative logarithm of unnormalized density of target distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of computed negative log density.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.RiemannianMetricSystem.sample_momentum">
<span class="sig-name descname"><span class="pre">sample_momentum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#RiemannianMetricSystem.sample_momentum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.RiemannianMetricSystem.sample_momentum" title="Link to this definition">#</a></dt>
<dd><p>Sample a momentum from its conditional distribution given a position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State defining position to condition on.</p></li>
<li><p><strong>rng</strong> (<em>Generator</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sampled momentum.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.RiemannianMetricSystem.vjp_metric_func">
<span class="sig-name descname"><span class="pre">vjp_metric_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#RiemannianMetricSystem.vjp_metric_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.RiemannianMetricSystem.vjp_metric_func" title="Link to this definition">#</a></dt>
<dd><p>Function constructing a vector-Jacobian-product for <cite>metric_func</cite>.</p>
<p>The vector-Jacobian-product is here defined as a function of an array <cite>v</cite> (of
the same shape as the output of <cite>metric_func</cite>) corresponding to</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vjp</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">jacob</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ndim</span><span class="p">))</span>
</pre></div>
</div>
<p>where <cite>jacob</cite> is the Jacobian of <cite>m = metric_func(q)</cite> wrt <cite>q</cite> i.e. the array of
partial derivatives of the function such that</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>jacob[..., i] = ∂m[...] / ∂q[i]
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute VJP at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Vector-Jacobian-product function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>VectorJacobianProduct</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mici.systems.ScalarRiemannianMetricSystem">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mici.systems.</span></span><span class="sig-name descname"><span class="pre">ScalarRiemannianMetricSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neg_log_dens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_scalar_func</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">vjp_metric_scalar_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_neg_log_dens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#ScalarRiemannianMetricSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.ScalarRiemannianMetricSystem" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#mici.systems.RiemannianMetricSystem" title="mici.systems.RiemannianMetricSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">RiemannianMetricSystem</span></code></a></p>
<p>Riemannian-metric system with scaled identity matrix representation.</p>
<p>Hamiltonian system with a position dependent scaled identity metric matrix
representation which is specified by a scalar function <cite>metric_scalar_function</cite> of
the position <cite>q</cite> which outputs a strictly positive scalar <cite>s =
metric_scalar_func(q)</cite> with the the metric matrix representation then taken to be <cite>s
* identity(q.shape[0])</cite>.</p>
<p>See documentation of <cite>RiemannianMetricSystem</cite> for more general details about
Riemannian-metric Hamiltonian systems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neg_log_dens</strong> (<em>ScalarFunction</em>) – Function which given a position array returns the negative
logarithm of an unnormalized probability density on the position space
with respect to the Lebesgue measure, with the corresponding
distribution on the position space being the target distribution it is
wished to draw approximate samples from.</p></li>
<li><p><strong>metric_scalar_func</strong> (<em>ScalarFunction</em>) – Function which given a position array returns a strictly
positive scalar corresponding to the parameter value of the scaled
identity metric matrix representation.</p></li>
<li><p><strong>vjp_metric_scalar_func</strong> (<em>VectorJacobianProductFunction</em><em> | </em><em>None</em>) – <p>Function which given a position array returns
another function which takes a scalar as an argument and returns the
<em>vector-Jacobian-product</em> (VJP) of <cite>metric_scalar_func</cite> with respect to
the position array argument. The VJP is here defined as a function of a
scalar <cite>v</cite>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vjp</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="n">v</span> <span class="o">@</span> <span class="n">grad</span>
</pre></div>
</div>
<p>where <cite>grad</cite> is the <cite>(dim_pos,)</cite> shaped Jacobian (gradient) of <cite>s =
metric_scalar_func(q)</cite> with respect to <cite>q</cite> i.e. the array of partial
derivatives of the function such that</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>grad[i] = ∂s / ∂q[i]
</pre></div>
</div>
<p>Optionally the function may instead return a 2-tuple of values with the
first a function to compute a VJP of <cite>metric_scalar_func</cite> and the second
a float containing the value of <cite>metric_scalar_func</cite>, both evaluated at
the passed position array. If <cite>None</cite> is passed (the default) an
automatic differentiation fallback will be used to attempt to construct
a function which calculates the VJP (and value) of <cite>metric_scalar_func</cite>
automatically.</p>
</p></li>
<li><p><strong>grad_neg_log_dens</strong> (<em>GradientFunction</em><em> | </em><em>None</em>) – Function which given a position array returns the
derivative of <cite>neg_log_dens</cite> with respect to the position array
argument. Optionally the function may instead return a 2-tuple of values
with the first being the array corresponding to the derivative and the
second being the value of the <cite>neg_log_dens</cite> evaluated at the passed
position array. If <cite>None</cite> is passed (the default) an automatic
differentiation fallback will be used to attempt to construct the
derivative of <cite>neg_log_dens</cite> automatically.</p></li>
<li><p><strong>backend</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – Name of automatic differentiation backend to use. See
<a class="reference internal" href="mici.autodiff.html#module-mici.autodiff" title="mici.autodiff"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autodiff</span></code></a> subpackage documentation for details of available
backends. If <cite>None</cite> (the default) no automatic differentiation fallback
will be used and so all derivative functions must be specified
explicitly.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ScalarRiemannianMetricSystem.dh1_dpos">
<span class="sig-name descname"><span class="pre">dh1_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ScalarRiemannianMetricSystem.dh1_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h1</cite> Hamiltonian component with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of computed <cite>h1</cite> derivative.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ScalarRiemannianMetricSystem.dh2_dmom">
<span class="sig-name descname"><span class="pre">dh2_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ScalarRiemannianMetricSystem.dh2_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h2</cite> Hamiltonian component with respect to momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2(state)</cite> derivative with respect to <cite>state.mom</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ScalarRiemannianMetricSystem.dh2_dpos">
<span class="sig-name descname"><span class="pre">dh2_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ScalarRiemannianMetricSystem.dh2_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h2</cite> Hamiltonian component with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ScalarRiemannianMetricSystem.dh_dmom">
<span class="sig-name descname"><span class="pre">dh_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ScalarRiemannianMetricSystem.dh_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivative of Hamiltonian with respect to momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h(state)</cite> derivative with respect to <cite>state.mom</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ScalarRiemannianMetricSystem.dh_dpos">
<span class="sig-name descname"><span class="pre">dh_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ScalarRiemannianMetricSystem.dh_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of Hamiltonian with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ScalarRiemannianMetricSystem.grad_neg_log_dens">
<span class="sig-name descname"><span class="pre">grad_neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ScalarRiemannianMetricSystem.grad_neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Derivative of negative log density with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>neg_log_dens(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ScalarRiemannianMetricSystem.h">
<span class="sig-name descname"><span class="pre">h</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ScalarRiemannianMetricSystem.h" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian function for system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of Hamiltonian.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ScalarRiemannianMetricSystem.h1">
<span class="sig-name descname"><span class="pre">h1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ScalarRiemannianMetricSystem.h1" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian component depending only on position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h1</cite> Hamiltonian component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ScalarRiemannianMetricSystem.h1_flow">
<span class="sig-name descname"><span class="pre">h1_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ScalarRiemannianMetricSystem.h1_flow" title="Link to this definition">#</a></dt>
<dd><p>Apply exact flow map corresponding to <cite>h1</cite> Hamiltonian component.</p>
<p><cite>state</cite> argument is modified in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to start flow at.</p></li>
<li><p><strong>dt</strong> (<em>ScalarLike</em>) – Time interval to simulate flow for.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ScalarRiemannianMetricSystem.h2">
<span class="sig-name descname"><span class="pre">h2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ScalarRiemannianMetricSystem.h2" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian component depending on momentum and optionally position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2</cite> Hamiltonian component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ScalarRiemannianMetricSystem.metric">
<span class="sig-name descname"><span class="pre">metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#ScalarRiemannianMetricSystem.metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.ScalarRiemannianMetricSystem.metric" title="Link to this definition">#</a></dt>
<dd><p>Function computing the metric matrix representation.</p>
<p>The returned type of this function is that specified by the
<cite>metric_matrix_class</cite> argument to the initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Metric matrix representation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="mici.matrices.html#mici.matrices.PositiveDefiniteMatrix" title="mici.matrices.PositiveDefiniteMatrix"><em>PositiveDefiniteMatrix</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ScalarRiemannianMetricSystem.metric_func">
<span class="sig-name descname"><span class="pre">metric_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ScalarRiemannianMetricSystem.metric_func" title="Link to this definition">#</a></dt>
<dd><p>Function computing the parameter of the metric matrix representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>metric_func(state.pos)</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ScalarRiemannianMetricSystem.neg_log_dens">
<span class="sig-name descname"><span class="pre">neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ScalarRiemannianMetricSystem.neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Negative logarithm of unnormalized density of target distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of computed negative log density.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ScalarRiemannianMetricSystem.sample_momentum">
<span class="sig-name descname"><span class="pre">sample_momentum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ScalarRiemannianMetricSystem.sample_momentum" title="Link to this definition">#</a></dt>
<dd><p>Sample a momentum from its conditional distribution given a position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State defining position to condition on.</p></li>
<li><p><strong>rng</strong> (<em>Generator</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sampled momentum.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.ScalarRiemannianMetricSystem.vjp_metric_func">
<span class="sig-name descname"><span class="pre">vjp_metric_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.ScalarRiemannianMetricSystem.vjp_metric_func" title="Link to this definition">#</a></dt>
<dd><p>Function constructing a vector-Jacobian-product for <cite>metric_func</cite>.</p>
<p>The vector-Jacobian-product is here defined as a function of an array <cite>v</cite> (of
the same shape as the output of <cite>metric_func</cite>) corresponding to</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vjp</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">jacob</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ndim</span><span class="p">))</span>
</pre></div>
</div>
<p>where <cite>jacob</cite> is the Jacobian of <cite>m = metric_func(q)</cite> wrt <cite>q</cite> i.e. the array of
partial derivatives of the function such that</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>jacob[..., i] = ∂m[...] / ∂q[i]
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute VJP at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Vector-Jacobian-product function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>VectorJacobianProduct</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mici.systems.SoftAbsRiemannianMetricSystem">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mici.systems.</span></span><span class="sig-name descname"><span class="pre">SoftAbsRiemannianMetricSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neg_log_dens</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_neg_log_dens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hess_neg_log_dens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mtp_neg_log_dens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softabs_coeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#SoftAbsRiemannianMetricSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.SoftAbsRiemannianMetricSystem" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#mici.systems.RiemannianMetricSystem" title="mici.systems.RiemannianMetricSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">RiemannianMetricSystem</span></code></a></p>
<p>SoftAbs Riemmanian metric Hamiltonian system.</p>
<p>Hamiltonian system with a position dependent metric matrix representation which is
specified to be a dense matrix function <cite>metric_func</cite> of the position <cite>q</cite> which is
guaranteed to be positive definite almost-everywhere, with <cite>M = metric_func(q)</cite> then
the metric matrix representation.</p>
<p>Hamiltonian system with a position dependent metric matrix representation which is
specified to be an eigenvalue-regularized transformation of the Hessian of the
negative log density function (the symmetric matrix of second derivatives the
negative log density function with respect to the position array components.
Specifically if <cite>hess_neg_log_dens</cite> is a symmetric 2D square array valued function
of the position <cite>q</cite>, with <cite>H = hess_neg_log_dens(q)</cite> then if an eigenvalue
decomposition of <cite>H</cite> is computed, i.e. <cite>eigval, eigvec = eigh(H)</cite>, with <cite>eigval</cite> a
1D array of real eigenvalues, and <cite>eigvec</cite> the corresponding 2D array (orthogonal
matrix) with eigenvectors as columns, then the resulting positive-definite metric
matrix representation <cite>M</cite> is computed as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="n">eigvec</span> <span class="o">@</span> <span class="n">diag</span><span class="p">(</span><span class="n">softabs</span><span class="p">(</span><span class="n">eigval</span><span class="p">,</span> <span class="n">softabs_coeff</span><span class="p">))</span> <span class="o">@</span> <span class="n">eigvec</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
<p>with <cite>softabs(x, softabs_coeff) = x / tanh(x * softabs_coeff)</cite> an elementwise
function which acts as a smooth approximation to the absolute function (ensuring all
the eigenvalues of <cite>M</cite> are strictly positive) with the additional scalar parameter
<cite>softabs_coeff</cite> controlling the smoothness of the approximation, with <cite>softabs</cite>
tending to the piecewise linear <cite>abs</cite> function as <cite>softabs_coeff</cite> tends to infinity,
and becoming increasingly smooth as <cite>softabs_coeff</cite> tends to zero.</p>
<p>See documentation of <cite>RiemannianMetricSystem</cite> for more general details about
Riemannian-metric Hamiltonian systems.</p>
<p class="rubric">References</p>
<ol class="arabic simple">
<li><p>Betancourt, M., 2013. A general metric for Riemannian manifold Hamiltonian
Monte Carlo. In Geometric science of information (pp. 327-334).</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neg_log_dens</strong> (<em>ScalarFunction</em>) – Function which given a position array returns the negative
logarithm of an unnormalized probability density on the position space
with respect to the Lebesgue measure, with the corresponding
distribution on the position space being the target distribution it is
wished to draw approximate samples from.</p></li>
<li><p><strong>grad_neg_log_dens</strong> (<em>GradientFunction</em><em> | </em><em>None</em>) – Function which given a position array returns the
derivative of <cite>neg_log_dens</cite> with respect to the position array
argument. Optionally the function may instead return a 2-tuple of values
with the first being the array corresponding to the derivative and the
second being the value of the <cite>neg_log_dens</cite> evaluated at the passed
position array. If <cite>None</cite> is passed (the default) an automatic
differentiation fallback will be used to attempt to construct the
derivative of <cite>neg_log_dens</cite> automatically.</p></li>
<li><p><strong>hess_neg_log_dens</strong> (<em>HessianFunction</em><em> | </em><em>None</em>) – Function which given a position array returns the Hessian
of <cite>neg_log_dens</cite> with respect to the position array argument as a 2D
array. Optionally the function may instead return a 3-tuple of values
with the first a 2D array containting the Hessian of <cite>neg_log_dens</cite>, the
second a 1D array containing the gradient of <cite>neg_log_dens</cite> and the
third the value of <cite>neg_log_dens</cite>, all evaluated at the passed position
array. If <cite>None</cite> is passed (the default) an automatic differentiation
fallback will be used to attempt to construct a function which
calculates the Hessian (and gradient and value) of <cite>neg_log_dens</cite>
automatically.</p></li>
<li><p><strong>mtp_neg_log_dens</strong> (<em>MatrixTressianProductFunction</em><em> | </em><em>None</em>) – <p>Function which given a position array returns another
function which takes a 2D array (matrix) as an argument and returns the
<em>matrix-Tressian-product</em> (MTP) of <cite>neg_log_dens</cite> with respect to the
position array argument. The MTP is here defined as a function of a
matrix <cite>m</cite> corresponding to.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mtp</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">m</span><span class="p">[:,</span> <span class="p">:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">tress</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<p>where <cite>tress</cite> is the ‘Tressian’ of <cite>f = neg_log_dens(q)</cite> wrt <cite>q</cite> i.e.
the 3D array of third-order partial derivatives of the scalar-valued
function such that</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>tress[i, j, k] = ∂³f / (∂q[i] ∂q[j] ∂q[k])
</pre></div>
</div>
<p>Optionally the function may instead return a 4-tuple of values with the
first a function to compute a MTP of <cite>neg_log_dens</cite>, the second a 2D
array containing the Hessian of <cite>neg_log_dens</cite>, the third a 1D array
containing the gradient of <cite>neg_log_dens</cite> and the fourth the value of
<cite>neg_log_dens</cite>, all evaluated at the passed position array. If <cite>None</cite> is
passed (the default) an automatic differentiation fallback will be used
to attempt to construct a function which calculates the MTP (and Hesisan
and gradient and value) of <cite>neg_log_dens</cite> automatically.</p>
</p></li>
<li><p><strong>softabs_coeff</strong> (<em>ScalarLike</em>) – Positive regularisation coefficient for smooth approximation
to absolute value used to regularize Hessian eigenvalues in metric
matrix representation. As the value tends to infinity the approximation
becomes increasingly close to the absolute function.</p></li>
<li><p><strong>backend</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – Name of automatic differentiation backend to use. See
<a class="reference internal" href="mici.autodiff.html#module-mici.autodiff" title="mici.autodiff"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autodiff</span></code></a> subpackage documentation for details of available
backends. If <cite>None</cite> (the default) no automatic differentiation fallback
will be used and so all derivative functions must be specified
explicitly.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.SoftAbsRiemannianMetricSystem.dh1_dpos">
<span class="sig-name descname"><span class="pre">dh1_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.SoftAbsRiemannianMetricSystem.dh1_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h1</cite> Hamiltonian component with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of computed <cite>h1</cite> derivative.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.SoftAbsRiemannianMetricSystem.dh2_dmom">
<span class="sig-name descname"><span class="pre">dh2_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.SoftAbsRiemannianMetricSystem.dh2_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h2</cite> Hamiltonian component with respect to momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2(state)</cite> derivative with respect to <cite>state.mom</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.SoftAbsRiemannianMetricSystem.dh2_dpos">
<span class="sig-name descname"><span class="pre">dh2_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.SoftAbsRiemannianMetricSystem.dh2_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h2</cite> Hamiltonian component with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.SoftAbsRiemannianMetricSystem.dh_dmom">
<span class="sig-name descname"><span class="pre">dh_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.SoftAbsRiemannianMetricSystem.dh_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivative of Hamiltonian with respect to momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h(state)</cite> derivative with respect to <cite>state.mom</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.SoftAbsRiemannianMetricSystem.dh_dpos">
<span class="sig-name descname"><span class="pre">dh_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.SoftAbsRiemannianMetricSystem.dh_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of Hamiltonian with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.SoftAbsRiemannianMetricSystem.grad_neg_log_dens">
<span class="sig-name descname"><span class="pre">grad_neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.SoftAbsRiemannianMetricSystem.grad_neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Derivative of negative log density with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>neg_log_dens(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.SoftAbsRiemannianMetricSystem.h">
<span class="sig-name descname"><span class="pre">h</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.SoftAbsRiemannianMetricSystem.h" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian function for system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of Hamiltonian.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.SoftAbsRiemannianMetricSystem.h1">
<span class="sig-name descname"><span class="pre">h1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.SoftAbsRiemannianMetricSystem.h1" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian component depending only on position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h1</cite> Hamiltonian component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.SoftAbsRiemannianMetricSystem.h1_flow">
<span class="sig-name descname"><span class="pre">h1_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.SoftAbsRiemannianMetricSystem.h1_flow" title="Link to this definition">#</a></dt>
<dd><p>Apply exact flow map corresponding to <cite>h1</cite> Hamiltonian component.</p>
<p><cite>state</cite> argument is modified in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to start flow at.</p></li>
<li><p><strong>dt</strong> (<em>ScalarLike</em>) – Time interval to simulate flow for.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.SoftAbsRiemannianMetricSystem.h2">
<span class="sig-name descname"><span class="pre">h2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.SoftAbsRiemannianMetricSystem.h2" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian component depending on momentum and optionally position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2</cite> Hamiltonian component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.SoftAbsRiemannianMetricSystem.hess_neg_log_dens">
<span class="sig-name descname"><span class="pre">hess_neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#SoftAbsRiemannianMetricSystem.hess_neg_log_dens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.SoftAbsRiemannianMetricSystem.hess_neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Hessian of negative log density with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2D array of <cite>neg_log_dens(state)</cite> second derivatives with respect to
<cite>state.pos</cite>, with <cite>hessian[i, j]</cite> the second derivative of
<cite>neg_log_dens(state)</cite> with respect to <cite>state.pos[i]</cite> and <cite>state.pos[j]</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.SoftAbsRiemannianMetricSystem.metric">
<span class="sig-name descname"><span class="pre">metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.SoftAbsRiemannianMetricSystem.metric" title="Link to this definition">#</a></dt>
<dd><p>Function computing the metric matrix representation.</p>
<p>The returned type of this function is that specified by the
<cite>metric_matrix_class</cite> argument to the initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Metric matrix representation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="mici.matrices.html#mici.matrices.PositiveDefiniteMatrix" title="mici.matrices.PositiveDefiniteMatrix"><em>PositiveDefiniteMatrix</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.SoftAbsRiemannianMetricSystem.metric_func">
<span class="sig-name descname"><span class="pre">metric_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#SoftAbsRiemannianMetricSystem.metric_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.SoftAbsRiemannianMetricSystem.metric_func" title="Link to this definition">#</a></dt>
<dd><p>Function computing the parameter of the metric matrix representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>metric_func(state.pos)</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.SoftAbsRiemannianMetricSystem.mtp_neg_log_dens">
<span class="sig-name descname"><span class="pre">mtp_neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#SoftAbsRiemannianMetricSystem.mtp_neg_log_dens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.SoftAbsRiemannianMetricSystem.mtp_neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Generate MTP of negative log density with respect to position.</p>
<p>The matrix-Tressian-product (MTP) is here defined as a function of a matrix <cite>m</cite>
corresponding to</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mtp</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">m</span><span class="p">[:,</span> <span class="p">:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">tress</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<p>where <cite>tress</cite> is the ‘Tressian’ of <cite>f = neg_log_dens(q)</cite> with respect to <cite>q =
state.pos</cite> i.e. the 3D array of third-order partial derivatives of the
scalar-valued function such that</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>tress[i, j, k] = ∂³f / (∂q[i] ∂q[j] ∂q[k])
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Function which accepts a 2D array of shape
<cite>(state.pos.shape[0], state.pos.shape[0])</cite> as an argument and returns an
array of shape <cite>state.pos.shape</cite> containing the computed MTP value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>MatrixTressianProduct</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.SoftAbsRiemannianMetricSystem.neg_log_dens">
<span class="sig-name descname"><span class="pre">neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.SoftAbsRiemannianMetricSystem.neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Negative logarithm of unnormalized density of target distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of computed negative log density.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.SoftAbsRiemannianMetricSystem.sample_momentum">
<span class="sig-name descname"><span class="pre">sample_momentum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.SoftAbsRiemannianMetricSystem.sample_momentum" title="Link to this definition">#</a></dt>
<dd><p>Sample a momentum from its conditional distribution given a position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State defining position to condition on.</p></li>
<li><p><strong>rng</strong> (<em>Generator</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sampled momentum.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.SoftAbsRiemannianMetricSystem.vjp_metric_func">
<span class="sig-name descname"><span class="pre">vjp_metric_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#SoftAbsRiemannianMetricSystem.vjp_metric_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.SoftAbsRiemannianMetricSystem.vjp_metric_func" title="Link to this definition">#</a></dt>
<dd><p>Function constructing a vector-Jacobian-product for <cite>metric_func</cite>.</p>
<p>The vector-Jacobian-product is here defined as a function of an array <cite>v</cite> (of
the same shape as the output of <cite>metric_func</cite>) corresponding to</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vjp</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">jacob</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">ndim</span><span class="p">))</span>
</pre></div>
</div>
<p>where <cite>jacob</cite> is the Jacobian of <cite>m = metric_func(q)</cite> wrt <cite>q</cite> i.e. the array of
partial derivatives of the function such that</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>jacob[..., i] = ∂m[...] / ∂q[i]
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute VJP at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Vector-Jacobian-product function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>MatrixTressianProduct</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mici.systems.System">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mici.systems.</span></span><span class="sig-name descname"><span class="pre">System</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neg_log_dens</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_neg_log_dens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#System"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.System" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>Base class for Hamiltonian systems.</p>
<p>The Hamiltonian function <span class="math notranslate nohighlight">\(h\)</span> is assumed to have the general form</p>
<div class="math notranslate nohighlight">
\[h(q, p) = h_1(q) + h_2(q, p)\]</div>
<p>where <span class="math notranslate nohighlight">\(q\)</span> and <span class="math notranslate nohighlight">\(p\)</span> are the position and momentum variables respectively,
and <span class="math notranslate nohighlight">\(h_1\)</span> and <span class="math notranslate nohighlight">\(h_2\)</span> Hamiltonian component functions. The exact
Hamiltonian flow for the <span class="math notranslate nohighlight">\(h_1\)</span> component can be always be computed as it
depends only on the position variable however depending on the form of <span class="math notranslate nohighlight">\(h_2\)</span>
the corresponding exact Hamiltonian flow may or may not be simulable.</p>
<p>By default <span class="math notranslate nohighlight">\(h_1\)</span> is assumed to correspond to the negative logarithm of an
unnormalized density on the position variables with respect to a reference measure,
with the corresponding distribution on the position space being the target
distribution it is wished to draw approximate samples from.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neg_log_dens</strong> (<em>ScalarFunction</em>) – Function which given a position array returns the negative
logarithm of an unnormalized probability density on the position space
with respect to a reference measure, with the corresponding
distribution on the position space being the target distribution it is
wished to draw approximate samples from.</p></li>
<li><p><strong>grad_neg_log_dens</strong> (<em>GradientFunction</em><em> | </em><em>None</em>) – Function which given a position array returns the
derivative of <cite>neg_log_dens</cite> with respect to the position array
argument. Optionally the function may instead return a 2-tuple of values
with the first being the array corresponding to the derivative and the
second being the value of the <cite>neg_log_dens</cite> evaluated at the passed
position array. If <cite>None</cite> is passed (the default) an automatic
differentiation fallback will be used to attempt to construct the
derivative of <cite>neg_log_dens</cite> automatically.</p></li>
<li><p><strong>backend</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – Name of automatic differentiation backend to use. See
<a class="reference internal" href="mici.autodiff.html#module-mici.autodiff" title="mici.autodiff"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autodiff</span></code></a> subpackage documentation for details of available
backends. If <cite>None</cite> (the default) no automatic differentiation fallback
will be used and so all derivative functions must be specified
explicitly.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.System.dh1_dpos">
<span class="sig-name descname"><span class="pre">dh1_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#System.dh1_dpos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.System.dh1_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h1</cite> Hamiltonian component with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of computed <cite>h1</cite> derivative.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.System.dh2_dmom">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dh2_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#System.dh2_dmom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.System.dh2_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h2</cite> Hamiltonian component with respect to momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2(state)</cite> derivative with respect to <cite>state.mom</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.System.dh2_dpos">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dh2_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#System.dh2_dpos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.System.dh2_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h2</cite> Hamiltonian component with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.System.dh_dmom">
<span class="sig-name descname"><span class="pre">dh_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#System.dh_dmom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.System.dh_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivative of Hamiltonian with respect to momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h(state)</cite> derivative with respect to <cite>state.mom</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.System.dh_dpos">
<span class="sig-name descname"><span class="pre">dh_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#System.dh_dpos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.System.dh_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of Hamiltonian with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.System.grad_neg_log_dens">
<span class="sig-name descname"><span class="pre">grad_neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#System.grad_neg_log_dens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.System.grad_neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Derivative of negative log density with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>neg_log_dens(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.System.h">
<span class="sig-name descname"><span class="pre">h</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#System.h"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.System.h" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian function for system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of Hamiltonian.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.System.h1">
<span class="sig-name descname"><span class="pre">h1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#System.h1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.System.h1" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian component depending only on position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h1</cite> Hamiltonian component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.System.h1_flow">
<span class="sig-name descname"><span class="pre">h1_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#System.h1_flow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.System.h1_flow" title="Link to this definition">#</a></dt>
<dd><p>Apply exact flow map corresponding to <cite>h1</cite> Hamiltonian component.</p>
<p><cite>state</cite> argument is modified in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to start flow at.</p></li>
<li><p><strong>dt</strong> (<em>ScalarLike</em>) – Time interval to simulate flow for.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.System.h2">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">h2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#System.h2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.System.h2" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian component depending on momentum and optionally position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2</cite> Hamiltonian component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.System.neg_log_dens">
<span class="sig-name descname"><span class="pre">neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#System.neg_log_dens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.System.neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Negative logarithm of unnormalized density of target distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of computed negative log density.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.System.sample_momentum">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sample_momentum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#System.sample_momentum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.System.sample_momentum" title="Link to this definition">#</a></dt>
<dd><p>Sample a momentum from its conditional distribution given a position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State defining position to condition on.</p></li>
<li><p><strong>rng</strong> (<em>Generator</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sampled momentum.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mici.systems.TractableFlowSystem">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mici.systems.</span></span><span class="sig-name descname"><span class="pre">TractableFlowSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neg_log_dens</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_neg_log_dens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#TractableFlowSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.TractableFlowSystem" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#mici.systems.System" title="mici.systems.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a></p>
<p>Base class for Hamiltonian systems with tractable component flows.</p>
<p>The Hamiltonian function <span class="math notranslate nohighlight">\(h\)</span> is assumed to have the general form</p>
<div class="math notranslate nohighlight">
\[h(q, p) = h_1(q) + h_2(q, p)\]</div>
<p>where <span class="math notranslate nohighlight">\(q\)</span> and <span class="math notranslate nohighlight">\(p\)</span> are the position and momentum variables respectively,
and <span class="math notranslate nohighlight">\(h_1\)</span> and <span class="math notranslate nohighlight">\(h_2\)</span> Hamiltonian component functions. The exact
Hamiltonian flows for both the <span class="math notranslate nohighlight">\(h_1\)</span> and <span class="math notranslate nohighlight">\(h_2\)</span> components are assumed to
be tractable for subclasses of this class.</p>
<p>By default <span class="math notranslate nohighlight">\(h_1\)</span> is assumed to correspond to the negative logarithm of an
unnormalized density on the position variables with respect to a reference measure,
with the corresponding distribution on the position space being the target
distribution it is wished to draw approximate samples from.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neg_log_dens</strong> (<em>ScalarFunction</em>) – Function which given a position array returns the negative
logarithm of an unnormalized probability density on the position space
with respect to a reference measure, with the corresponding
distribution on the position space being the target distribution it is
wished to draw approximate samples from.</p></li>
<li><p><strong>grad_neg_log_dens</strong> (<em>GradientFunction</em><em> | </em><em>None</em>) – Function which given a position array returns the
derivative of <cite>neg_log_dens</cite> with respect to the position array
argument. Optionally the function may instead return a 2-tuple of values
with the first being the array corresponding to the derivative and the
second being the value of the <cite>neg_log_dens</cite> evaluated at the passed
position array. If <cite>None</cite> is passed (the default) an automatic
differentiation fallback will be used to attempt to construct the
derivative of <cite>neg_log_dens</cite> automatically.</p></li>
<li><p><strong>backend</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – Name of automatic differentiation backend to use. See
<a class="reference internal" href="mici.autodiff.html#module-mici.autodiff" title="mici.autodiff"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autodiff</span></code></a> subpackage documentation for details of available
backends. If <cite>None</cite> (the default) no automatic differentiation fallback
will be used and so all derivative functions must be specified
explicitly.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.TractableFlowSystem.dh1_dpos">
<span class="sig-name descname"><span class="pre">dh1_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.TractableFlowSystem.dh1_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h1</cite> Hamiltonian component with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of computed <cite>h1</cite> derivative.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.TractableFlowSystem.dh2_dmom">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dh2_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.TractableFlowSystem.dh2_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h2</cite> Hamiltonian component with respect to momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2(state)</cite> derivative with respect to <cite>state.mom</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.TractableFlowSystem.dh2_dpos">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dh2_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.TractableFlowSystem.dh2_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of <cite>h2</cite> Hamiltonian component with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.TractableFlowSystem.dh_dmom">
<span class="sig-name descname"><span class="pre">dh_dmom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.TractableFlowSystem.dh_dmom" title="Link to this definition">#</a></dt>
<dd><p>Derivative of Hamiltonian with respect to momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h(state)</cite> derivative with respect to <cite>state.mom</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.TractableFlowSystem.dh_dpos">
<span class="sig-name descname"><span class="pre">dh_dpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.TractableFlowSystem.dh_dpos" title="Link to this definition">#</a></dt>
<dd><p>Derivative of Hamiltonian with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.TractableFlowSystem.grad_neg_log_dens">
<span class="sig-name descname"><span class="pre">grad_neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.TractableFlowSystem.grad_neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Derivative of negative log density with respect to position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>neg_log_dens(state)</cite> derivative with respect to <cite>state.pos</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.TractableFlowSystem.h">
<span class="sig-name descname"><span class="pre">h</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.TractableFlowSystem.h" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian function for system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of Hamiltonian.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.TractableFlowSystem.h1">
<span class="sig-name descname"><span class="pre">h1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.TractableFlowSystem.h1" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian component depending only on position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h1</cite> Hamiltonian component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.TractableFlowSystem.h1_flow">
<span class="sig-name descname"><span class="pre">h1_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.TractableFlowSystem.h1_flow" title="Link to this definition">#</a></dt>
<dd><p>Apply exact flow map corresponding to <cite>h1</cite> Hamiltonian component.</p>
<p><cite>state</cite> argument is modified in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to start flow at.</p></li>
<li><p><strong>dt</strong> (<em>ScalarLike</em>) – Time interval to simulate flow for.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.TractableFlowSystem.h2">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">h2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.TractableFlowSystem.h2" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian component depending on momentum and optionally position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of <cite>h2</cite> Hamiltonian component.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.TractableFlowSystem.h2_flow">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">h2_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/systems.html#TractableFlowSystem.h2_flow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.systems.TractableFlowSystem.h2_flow" title="Link to this definition">#</a></dt>
<dd><p>Apply exact flow map corresponding to <cite>h2</cite> Hamiltonian component.</p>
<p><cite>state</cite> argument is modified in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to start flow at.</p></li>
<li><p><strong>dt</strong> (<em>ScalarLike</em>) – Time interval to simulate flow for.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.TractableFlowSystem.neg_log_dens">
<span class="sig-name descname"><span class="pre">neg_log_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.TractableFlowSystem.neg_log_dens" title="Link to this definition">#</a></dt>
<dd><p>Negative logarithm of unnormalized density of target distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State to compute value at.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of computed negative log density.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ScalarLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mici.systems.TractableFlowSystem.sample_momentum">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sample_momentum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mici.systems.TractableFlowSystem.sample_momentum" title="Link to this definition">#</a></dt>
<dd><p>Sample a momentum from its conditional distribution given a position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="mici.states.html#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>) – State defining position to condition on.</p></li>
<li><p><strong>rng</strong> (<em>Generator</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sampled momentum.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="mici.states.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">mici.states module</p>
      </div>
    </a>
    <a class="right-next"
       href="mici.transitions.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">mici.transitions module</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem"><code class="docutils literal notranslate"><span class="pre">CholeskyFactoredRiemannianMetricSystem</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.dh1_dpos"><code class="docutils literal notranslate"><span class="pre">CholeskyFactoredRiemannianMetricSystem.dh1_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.dh2_dmom"><code class="docutils literal notranslate"><span class="pre">CholeskyFactoredRiemannianMetricSystem.dh2_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.dh2_dpos"><code class="docutils literal notranslate"><span class="pre">CholeskyFactoredRiemannianMetricSystem.dh2_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.dh_dmom"><code class="docutils literal notranslate"><span class="pre">CholeskyFactoredRiemannianMetricSystem.dh_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.dh_dpos"><code class="docutils literal notranslate"><span class="pre">CholeskyFactoredRiemannianMetricSystem.dh_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.grad_neg_log_dens"><code class="docutils literal notranslate"><span class="pre">CholeskyFactoredRiemannianMetricSystem.grad_neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.h"><code class="docutils literal notranslate"><span class="pre">CholeskyFactoredRiemannianMetricSystem.h()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.h1"><code class="docutils literal notranslate"><span class="pre">CholeskyFactoredRiemannianMetricSystem.h1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.h1_flow"><code class="docutils literal notranslate"><span class="pre">CholeskyFactoredRiemannianMetricSystem.h1_flow()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.h2"><code class="docutils literal notranslate"><span class="pre">CholeskyFactoredRiemannianMetricSystem.h2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.metric"><code class="docutils literal notranslate"><span class="pre">CholeskyFactoredRiemannianMetricSystem.metric()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.metric_func"><code class="docutils literal notranslate"><span class="pre">CholeskyFactoredRiemannianMetricSystem.metric_func()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.neg_log_dens"><code class="docutils literal notranslate"><span class="pre">CholeskyFactoredRiemannianMetricSystem.neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.sample_momentum"><code class="docutils literal notranslate"><span class="pre">CholeskyFactoredRiemannianMetricSystem.sample_momentum()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.CholeskyFactoredRiemannianMetricSystem.vjp_metric_func"><code class="docutils literal notranslate"><span class="pre">CholeskyFactoredRiemannianMetricSystem.vjp_metric_func()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedEuclideanMetricSystem"><code class="docutils literal notranslate"><span class="pre">ConstrainedEuclideanMetricSystem</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedEuclideanMetricSystem.constr"><code class="docutils literal notranslate"><span class="pre">ConstrainedEuclideanMetricSystem.constr()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedEuclideanMetricSystem.dh1_dpos"><code class="docutils literal notranslate"><span class="pre">ConstrainedEuclideanMetricSystem.dh1_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedEuclideanMetricSystem.dh2_dmom"><code class="docutils literal notranslate"><span class="pre">ConstrainedEuclideanMetricSystem.dh2_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedEuclideanMetricSystem.dh2_dpos"><code class="docutils literal notranslate"><span class="pre">ConstrainedEuclideanMetricSystem.dh2_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedEuclideanMetricSystem.dh2_flow_dmom"><code class="docutils literal notranslate"><span class="pre">ConstrainedEuclideanMetricSystem.dh2_flow_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedEuclideanMetricSystem.dh_dmom"><code class="docutils literal notranslate"><span class="pre">ConstrainedEuclideanMetricSystem.dh_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedEuclideanMetricSystem.dh_dpos"><code class="docutils literal notranslate"><span class="pre">ConstrainedEuclideanMetricSystem.dh_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedEuclideanMetricSystem.grad_log_det_sqrt_gram"><code class="docutils literal notranslate"><span class="pre">ConstrainedEuclideanMetricSystem.grad_log_det_sqrt_gram()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedEuclideanMetricSystem.grad_neg_log_dens"><code class="docutils literal notranslate"><span class="pre">ConstrainedEuclideanMetricSystem.grad_neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedEuclideanMetricSystem.gram"><code class="docutils literal notranslate"><span class="pre">ConstrainedEuclideanMetricSystem.gram()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedEuclideanMetricSystem.h"><code class="docutils literal notranslate"><span class="pre">ConstrainedEuclideanMetricSystem.h()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedEuclideanMetricSystem.h1"><code class="docutils literal notranslate"><span class="pre">ConstrainedEuclideanMetricSystem.h1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedEuclideanMetricSystem.h1_flow"><code class="docutils literal notranslate"><span class="pre">ConstrainedEuclideanMetricSystem.h1_flow()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedEuclideanMetricSystem.h2"><code class="docutils literal notranslate"><span class="pre">ConstrainedEuclideanMetricSystem.h2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedEuclideanMetricSystem.h2_flow"><code class="docutils literal notranslate"><span class="pre">ConstrainedEuclideanMetricSystem.h2_flow()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedEuclideanMetricSystem.inv_gram"><code class="docutils literal notranslate"><span class="pre">ConstrainedEuclideanMetricSystem.inv_gram()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedEuclideanMetricSystem.jacob_constr"><code class="docutils literal notranslate"><span class="pre">ConstrainedEuclideanMetricSystem.jacob_constr()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedEuclideanMetricSystem.jacob_constr_inner_product"><code class="docutils literal notranslate"><span class="pre">ConstrainedEuclideanMetricSystem.jacob_constr_inner_product()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedEuclideanMetricSystem.log_det_sqrt_gram"><code class="docutils literal notranslate"><span class="pre">ConstrainedEuclideanMetricSystem.log_det_sqrt_gram()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedEuclideanMetricSystem.neg_log_dens"><code class="docutils literal notranslate"><span class="pre">ConstrainedEuclideanMetricSystem.neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedEuclideanMetricSystem.project_onto_cotangent_space"><code class="docutils literal notranslate"><span class="pre">ConstrainedEuclideanMetricSystem.project_onto_cotangent_space()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedEuclideanMetricSystem.sample_momentum"><code class="docutils literal notranslate"><span class="pre">ConstrainedEuclideanMetricSystem.sample_momentum()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedTractableFlowSystem"><code class="docutils literal notranslate"><span class="pre">ConstrainedTractableFlowSystem</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedTractableFlowSystem.constr"><code class="docutils literal notranslate"><span class="pre">ConstrainedTractableFlowSystem.constr()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedTractableFlowSystem.dh1_dpos"><code class="docutils literal notranslate"><span class="pre">ConstrainedTractableFlowSystem.dh1_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedTractableFlowSystem.dh2_dmom"><code class="docutils literal notranslate"><span class="pre">ConstrainedTractableFlowSystem.dh2_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedTractableFlowSystem.dh2_dpos"><code class="docutils literal notranslate"><span class="pre">ConstrainedTractableFlowSystem.dh2_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedTractableFlowSystem.dh2_flow_dmom"><code class="docutils literal notranslate"><span class="pre">ConstrainedTractableFlowSystem.dh2_flow_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedTractableFlowSystem.dh_dmom"><code class="docutils literal notranslate"><span class="pre">ConstrainedTractableFlowSystem.dh_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedTractableFlowSystem.dh_dpos"><code class="docutils literal notranslate"><span class="pre">ConstrainedTractableFlowSystem.dh_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedTractableFlowSystem.grad_neg_log_dens"><code class="docutils literal notranslate"><span class="pre">ConstrainedTractableFlowSystem.grad_neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedTractableFlowSystem.h"><code class="docutils literal notranslate"><span class="pre">ConstrainedTractableFlowSystem.h()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedTractableFlowSystem.h1"><code class="docutils literal notranslate"><span class="pre">ConstrainedTractableFlowSystem.h1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedTractableFlowSystem.h1_flow"><code class="docutils literal notranslate"><span class="pre">ConstrainedTractableFlowSystem.h1_flow()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedTractableFlowSystem.h2"><code class="docutils literal notranslate"><span class="pre">ConstrainedTractableFlowSystem.h2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedTractableFlowSystem.h2_flow"><code class="docutils literal notranslate"><span class="pre">ConstrainedTractableFlowSystem.h2_flow()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedTractableFlowSystem.jacob_constr"><code class="docutils literal notranslate"><span class="pre">ConstrainedTractableFlowSystem.jacob_constr()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedTractableFlowSystem.jacob_constr_inner_product"><code class="docutils literal notranslate"><span class="pre">ConstrainedTractableFlowSystem.jacob_constr_inner_product()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedTractableFlowSystem.neg_log_dens"><code class="docutils literal notranslate"><span class="pre">ConstrainedTractableFlowSystem.neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedTractableFlowSystem.project_onto_cotangent_space"><code class="docutils literal notranslate"><span class="pre">ConstrainedTractableFlowSystem.project_onto_cotangent_space()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ConstrainedTractableFlowSystem.sample_momentum"><code class="docutils literal notranslate"><span class="pre">ConstrainedTractableFlowSystem.sample_momentum()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseConstrainedEuclideanMetricSystem"><code class="docutils literal notranslate"><span class="pre">DenseConstrainedEuclideanMetricSystem</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.constr"><code class="docutils literal notranslate"><span class="pre">DenseConstrainedEuclideanMetricSystem.constr()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.dh1_dpos"><code class="docutils literal notranslate"><span class="pre">DenseConstrainedEuclideanMetricSystem.dh1_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.dh2_dmom"><code class="docutils literal notranslate"><span class="pre">DenseConstrainedEuclideanMetricSystem.dh2_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.dh2_dpos"><code class="docutils literal notranslate"><span class="pre">DenseConstrainedEuclideanMetricSystem.dh2_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.dh2_flow_dmom"><code class="docutils literal notranslate"><span class="pre">DenseConstrainedEuclideanMetricSystem.dh2_flow_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.dh_dmom"><code class="docutils literal notranslate"><span class="pre">DenseConstrainedEuclideanMetricSystem.dh_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.dh_dpos"><code class="docutils literal notranslate"><span class="pre">DenseConstrainedEuclideanMetricSystem.dh_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.grad_log_det_sqrt_gram"><code class="docutils literal notranslate"><span class="pre">DenseConstrainedEuclideanMetricSystem.grad_log_det_sqrt_gram()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.grad_neg_log_dens"><code class="docutils literal notranslate"><span class="pre">DenseConstrainedEuclideanMetricSystem.grad_neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.gram"><code class="docutils literal notranslate"><span class="pre">DenseConstrainedEuclideanMetricSystem.gram()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.h"><code class="docutils literal notranslate"><span class="pre">DenseConstrainedEuclideanMetricSystem.h()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.h1"><code class="docutils literal notranslate"><span class="pre">DenseConstrainedEuclideanMetricSystem.h1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.h1_flow"><code class="docutils literal notranslate"><span class="pre">DenseConstrainedEuclideanMetricSystem.h1_flow()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.h2"><code class="docutils literal notranslate"><span class="pre">DenseConstrainedEuclideanMetricSystem.h2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.h2_flow"><code class="docutils literal notranslate"><span class="pre">DenseConstrainedEuclideanMetricSystem.h2_flow()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.inv_gram"><code class="docutils literal notranslate"><span class="pre">DenseConstrainedEuclideanMetricSystem.inv_gram()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.jacob_constr"><code class="docutils literal notranslate"><span class="pre">DenseConstrainedEuclideanMetricSystem.jacob_constr()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.jacob_constr_inner_product"><code class="docutils literal notranslate"><span class="pre">DenseConstrainedEuclideanMetricSystem.jacob_constr_inner_product()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.log_det_sqrt_gram"><code class="docutils literal notranslate"><span class="pre">DenseConstrainedEuclideanMetricSystem.log_det_sqrt_gram()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.mhp_constr"><code class="docutils literal notranslate"><span class="pre">DenseConstrainedEuclideanMetricSystem.mhp_constr()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.neg_log_dens"><code class="docutils literal notranslate"><span class="pre">DenseConstrainedEuclideanMetricSystem.neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.project_onto_cotangent_space"><code class="docutils literal notranslate"><span class="pre">DenseConstrainedEuclideanMetricSystem.project_onto_cotangent_space()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseConstrainedEuclideanMetricSystem.sample_momentum"><code class="docutils literal notranslate"><span class="pre">DenseConstrainedEuclideanMetricSystem.sample_momentum()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseRiemannianMetricSystem"><code class="docutils literal notranslate"><span class="pre">DenseRiemannianMetricSystem</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseRiemannianMetricSystem.dh1_dpos"><code class="docutils literal notranslate"><span class="pre">DenseRiemannianMetricSystem.dh1_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseRiemannianMetricSystem.dh2_dmom"><code class="docutils literal notranslate"><span class="pre">DenseRiemannianMetricSystem.dh2_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseRiemannianMetricSystem.dh2_dpos"><code class="docutils literal notranslate"><span class="pre">DenseRiemannianMetricSystem.dh2_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseRiemannianMetricSystem.dh_dmom"><code class="docutils literal notranslate"><span class="pre">DenseRiemannianMetricSystem.dh_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseRiemannianMetricSystem.dh_dpos"><code class="docutils literal notranslate"><span class="pre">DenseRiemannianMetricSystem.dh_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseRiemannianMetricSystem.grad_neg_log_dens"><code class="docutils literal notranslate"><span class="pre">DenseRiemannianMetricSystem.grad_neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseRiemannianMetricSystem.h"><code class="docutils literal notranslate"><span class="pre">DenseRiemannianMetricSystem.h()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseRiemannianMetricSystem.h1"><code class="docutils literal notranslate"><span class="pre">DenseRiemannianMetricSystem.h1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseRiemannianMetricSystem.h1_flow"><code class="docutils literal notranslate"><span class="pre">DenseRiemannianMetricSystem.h1_flow()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseRiemannianMetricSystem.h2"><code class="docutils literal notranslate"><span class="pre">DenseRiemannianMetricSystem.h2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseRiemannianMetricSystem.metric"><code class="docutils literal notranslate"><span class="pre">DenseRiemannianMetricSystem.metric()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseRiemannianMetricSystem.metric_func"><code class="docutils literal notranslate"><span class="pre">DenseRiemannianMetricSystem.metric_func()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseRiemannianMetricSystem.neg_log_dens"><code class="docutils literal notranslate"><span class="pre">DenseRiemannianMetricSystem.neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseRiemannianMetricSystem.sample_momentum"><code class="docutils literal notranslate"><span class="pre">DenseRiemannianMetricSystem.sample_momentum()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DenseRiemannianMetricSystem.vjp_metric_func"><code class="docutils literal notranslate"><span class="pre">DenseRiemannianMetricSystem.vjp_metric_func()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DiagonalRiemannianMetricSystem"><code class="docutils literal notranslate"><span class="pre">DiagonalRiemannianMetricSystem</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DiagonalRiemannianMetricSystem.dh1_dpos"><code class="docutils literal notranslate"><span class="pre">DiagonalRiemannianMetricSystem.dh1_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DiagonalRiemannianMetricSystem.dh2_dmom"><code class="docutils literal notranslate"><span class="pre">DiagonalRiemannianMetricSystem.dh2_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DiagonalRiemannianMetricSystem.dh2_dpos"><code class="docutils literal notranslate"><span class="pre">DiagonalRiemannianMetricSystem.dh2_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DiagonalRiemannianMetricSystem.dh_dmom"><code class="docutils literal notranslate"><span class="pre">DiagonalRiemannianMetricSystem.dh_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DiagonalRiemannianMetricSystem.dh_dpos"><code class="docutils literal notranslate"><span class="pre">DiagonalRiemannianMetricSystem.dh_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DiagonalRiemannianMetricSystem.grad_neg_log_dens"><code class="docutils literal notranslate"><span class="pre">DiagonalRiemannianMetricSystem.grad_neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DiagonalRiemannianMetricSystem.h"><code class="docutils literal notranslate"><span class="pre">DiagonalRiemannianMetricSystem.h()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DiagonalRiemannianMetricSystem.h1"><code class="docutils literal notranslate"><span class="pre">DiagonalRiemannianMetricSystem.h1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DiagonalRiemannianMetricSystem.h1_flow"><code class="docutils literal notranslate"><span class="pre">DiagonalRiemannianMetricSystem.h1_flow()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DiagonalRiemannianMetricSystem.h2"><code class="docutils literal notranslate"><span class="pre">DiagonalRiemannianMetricSystem.h2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DiagonalRiemannianMetricSystem.metric"><code class="docutils literal notranslate"><span class="pre">DiagonalRiemannianMetricSystem.metric()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DiagonalRiemannianMetricSystem.metric_func"><code class="docutils literal notranslate"><span class="pre">DiagonalRiemannianMetricSystem.metric_func()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DiagonalRiemannianMetricSystem.neg_log_dens"><code class="docutils literal notranslate"><span class="pre">DiagonalRiemannianMetricSystem.neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DiagonalRiemannianMetricSystem.sample_momentum"><code class="docutils literal notranslate"><span class="pre">DiagonalRiemannianMetricSystem.sample_momentum()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.DiagonalRiemannianMetricSystem.vjp_metric_func"><code class="docutils literal notranslate"><span class="pre">DiagonalRiemannianMetricSystem.vjp_metric_func()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.EuclideanMetricSystem"><code class="docutils literal notranslate"><span class="pre">EuclideanMetricSystem</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.EuclideanMetricSystem.dh1_dpos"><code class="docutils literal notranslate"><span class="pre">EuclideanMetricSystem.dh1_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.EuclideanMetricSystem.dh2_dmom"><code class="docutils literal notranslate"><span class="pre">EuclideanMetricSystem.dh2_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.EuclideanMetricSystem.dh2_dpos"><code class="docutils literal notranslate"><span class="pre">EuclideanMetricSystem.dh2_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.EuclideanMetricSystem.dh_dmom"><code class="docutils literal notranslate"><span class="pre">EuclideanMetricSystem.dh_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.EuclideanMetricSystem.dh_dpos"><code class="docutils literal notranslate"><span class="pre">EuclideanMetricSystem.dh_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.EuclideanMetricSystem.grad_neg_log_dens"><code class="docutils literal notranslate"><span class="pre">EuclideanMetricSystem.grad_neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.EuclideanMetricSystem.h"><code class="docutils literal notranslate"><span class="pre">EuclideanMetricSystem.h()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.EuclideanMetricSystem.h1"><code class="docutils literal notranslate"><span class="pre">EuclideanMetricSystem.h1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.EuclideanMetricSystem.h1_flow"><code class="docutils literal notranslate"><span class="pre">EuclideanMetricSystem.h1_flow()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.EuclideanMetricSystem.h2"><code class="docutils literal notranslate"><span class="pre">EuclideanMetricSystem.h2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.EuclideanMetricSystem.h2_flow"><code class="docutils literal notranslate"><span class="pre">EuclideanMetricSystem.h2_flow()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.EuclideanMetricSystem.neg_log_dens"><code class="docutils literal notranslate"><span class="pre">EuclideanMetricSystem.neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.EuclideanMetricSystem.sample_momentum"><code class="docutils literal notranslate"><span class="pre">EuclideanMetricSystem.sample_momentum()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem"><code class="docutils literal notranslate"><span class="pre">GaussianDenseConstrainedEuclideanMetricSystem</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.constr"><code class="docutils literal notranslate"><span class="pre">GaussianDenseConstrainedEuclideanMetricSystem.constr()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.dh1_dpos"><code class="docutils literal notranslate"><span class="pre">GaussianDenseConstrainedEuclideanMetricSystem.dh1_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.dh2_dmom"><code class="docutils literal notranslate"><span class="pre">GaussianDenseConstrainedEuclideanMetricSystem.dh2_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.dh2_dpos"><code class="docutils literal notranslate"><span class="pre">GaussianDenseConstrainedEuclideanMetricSystem.dh2_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.dh2_flow_dmom"><code class="docutils literal notranslate"><span class="pre">GaussianDenseConstrainedEuclideanMetricSystem.dh2_flow_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.dh_dmom"><code class="docutils literal notranslate"><span class="pre">GaussianDenseConstrainedEuclideanMetricSystem.dh_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.dh_dpos"><code class="docutils literal notranslate"><span class="pre">GaussianDenseConstrainedEuclideanMetricSystem.dh_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.grad_log_det_sqrt_gram"><code class="docutils literal notranslate"><span class="pre">GaussianDenseConstrainedEuclideanMetricSystem.grad_log_det_sqrt_gram()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.grad_neg_log_dens"><code class="docutils literal notranslate"><span class="pre">GaussianDenseConstrainedEuclideanMetricSystem.grad_neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.gram"><code class="docutils literal notranslate"><span class="pre">GaussianDenseConstrainedEuclideanMetricSystem.gram()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.h"><code class="docutils literal notranslate"><span class="pre">GaussianDenseConstrainedEuclideanMetricSystem.h()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.h1"><code class="docutils literal notranslate"><span class="pre">GaussianDenseConstrainedEuclideanMetricSystem.h1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.h1_flow"><code class="docutils literal notranslate"><span class="pre">GaussianDenseConstrainedEuclideanMetricSystem.h1_flow()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.h2"><code class="docutils literal notranslate"><span class="pre">GaussianDenseConstrainedEuclideanMetricSystem.h2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.h2_flow"><code class="docutils literal notranslate"><span class="pre">GaussianDenseConstrainedEuclideanMetricSystem.h2_flow()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.inv_gram"><code class="docutils literal notranslate"><span class="pre">GaussianDenseConstrainedEuclideanMetricSystem.inv_gram()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.jacob_constr"><code class="docutils literal notranslate"><span class="pre">GaussianDenseConstrainedEuclideanMetricSystem.jacob_constr()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.jacob_constr_inner_product"><code class="docutils literal notranslate"><span class="pre">GaussianDenseConstrainedEuclideanMetricSystem.jacob_constr_inner_product()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.log_det_sqrt_gram"><code class="docutils literal notranslate"><span class="pre">GaussianDenseConstrainedEuclideanMetricSystem.log_det_sqrt_gram()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.mhp_constr"><code class="docutils literal notranslate"><span class="pre">GaussianDenseConstrainedEuclideanMetricSystem.mhp_constr()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.neg_log_dens"><code class="docutils literal notranslate"><span class="pre">GaussianDenseConstrainedEuclideanMetricSystem.neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.project_onto_cotangent_space"><code class="docutils literal notranslate"><span class="pre">GaussianDenseConstrainedEuclideanMetricSystem.project_onto_cotangent_space()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianDenseConstrainedEuclideanMetricSystem.sample_momentum"><code class="docutils literal notranslate"><span class="pre">GaussianDenseConstrainedEuclideanMetricSystem.sample_momentum()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianEuclideanMetricSystem"><code class="docutils literal notranslate"><span class="pre">GaussianEuclideanMetricSystem</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianEuclideanMetricSystem.dh1_dpos"><code class="docutils literal notranslate"><span class="pre">GaussianEuclideanMetricSystem.dh1_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianEuclideanMetricSystem.dh2_dmom"><code class="docutils literal notranslate"><span class="pre">GaussianEuclideanMetricSystem.dh2_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianEuclideanMetricSystem.dh2_dpos"><code class="docutils literal notranslate"><span class="pre">GaussianEuclideanMetricSystem.dh2_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianEuclideanMetricSystem.dh_dmom"><code class="docutils literal notranslate"><span class="pre">GaussianEuclideanMetricSystem.dh_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianEuclideanMetricSystem.dh_dpos"><code class="docutils literal notranslate"><span class="pre">GaussianEuclideanMetricSystem.dh_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianEuclideanMetricSystem.grad_neg_log_dens"><code class="docutils literal notranslate"><span class="pre">GaussianEuclideanMetricSystem.grad_neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianEuclideanMetricSystem.h"><code class="docutils literal notranslate"><span class="pre">GaussianEuclideanMetricSystem.h()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianEuclideanMetricSystem.h1"><code class="docutils literal notranslate"><span class="pre">GaussianEuclideanMetricSystem.h1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianEuclideanMetricSystem.h1_flow"><code class="docutils literal notranslate"><span class="pre">GaussianEuclideanMetricSystem.h1_flow()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianEuclideanMetricSystem.h2"><code class="docutils literal notranslate"><span class="pre">GaussianEuclideanMetricSystem.h2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianEuclideanMetricSystem.h2_flow"><code class="docutils literal notranslate"><span class="pre">GaussianEuclideanMetricSystem.h2_flow()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianEuclideanMetricSystem.neg_log_dens"><code class="docutils literal notranslate"><span class="pre">GaussianEuclideanMetricSystem.neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.GaussianEuclideanMetricSystem.sample_momentum"><code class="docutils literal notranslate"><span class="pre">GaussianEuclideanMetricSystem.sample_momentum()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.RiemannianMetricSystem"><code class="docutils literal notranslate"><span class="pre">RiemannianMetricSystem</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.RiemannianMetricSystem.dh1_dpos"><code class="docutils literal notranslate"><span class="pre">RiemannianMetricSystem.dh1_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.RiemannianMetricSystem.dh2_dmom"><code class="docutils literal notranslate"><span class="pre">RiemannianMetricSystem.dh2_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.RiemannianMetricSystem.dh2_dpos"><code class="docutils literal notranslate"><span class="pre">RiemannianMetricSystem.dh2_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.RiemannianMetricSystem.dh_dmom"><code class="docutils literal notranslate"><span class="pre">RiemannianMetricSystem.dh_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.RiemannianMetricSystem.dh_dpos"><code class="docutils literal notranslate"><span class="pre">RiemannianMetricSystem.dh_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.RiemannianMetricSystem.grad_neg_log_dens"><code class="docutils literal notranslate"><span class="pre">RiemannianMetricSystem.grad_neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.RiemannianMetricSystem.h"><code class="docutils literal notranslate"><span class="pre">RiemannianMetricSystem.h()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.RiemannianMetricSystem.h1"><code class="docutils literal notranslate"><span class="pre">RiemannianMetricSystem.h1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.RiemannianMetricSystem.h1_flow"><code class="docutils literal notranslate"><span class="pre">RiemannianMetricSystem.h1_flow()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.RiemannianMetricSystem.h2"><code class="docutils literal notranslate"><span class="pre">RiemannianMetricSystem.h2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.RiemannianMetricSystem.metric"><code class="docutils literal notranslate"><span class="pre">RiemannianMetricSystem.metric()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.RiemannianMetricSystem.metric_func"><code class="docutils literal notranslate"><span class="pre">RiemannianMetricSystem.metric_func()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.RiemannianMetricSystem.neg_log_dens"><code class="docutils literal notranslate"><span class="pre">RiemannianMetricSystem.neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.RiemannianMetricSystem.sample_momentum"><code class="docutils literal notranslate"><span class="pre">RiemannianMetricSystem.sample_momentum()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.RiemannianMetricSystem.vjp_metric_func"><code class="docutils literal notranslate"><span class="pre">RiemannianMetricSystem.vjp_metric_func()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ScalarRiemannianMetricSystem"><code class="docutils literal notranslate"><span class="pre">ScalarRiemannianMetricSystem</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ScalarRiemannianMetricSystem.dh1_dpos"><code class="docutils literal notranslate"><span class="pre">ScalarRiemannianMetricSystem.dh1_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ScalarRiemannianMetricSystem.dh2_dmom"><code class="docutils literal notranslate"><span class="pre">ScalarRiemannianMetricSystem.dh2_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ScalarRiemannianMetricSystem.dh2_dpos"><code class="docutils literal notranslate"><span class="pre">ScalarRiemannianMetricSystem.dh2_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ScalarRiemannianMetricSystem.dh_dmom"><code class="docutils literal notranslate"><span class="pre">ScalarRiemannianMetricSystem.dh_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ScalarRiemannianMetricSystem.dh_dpos"><code class="docutils literal notranslate"><span class="pre">ScalarRiemannianMetricSystem.dh_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ScalarRiemannianMetricSystem.grad_neg_log_dens"><code class="docutils literal notranslate"><span class="pre">ScalarRiemannianMetricSystem.grad_neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ScalarRiemannianMetricSystem.h"><code class="docutils literal notranslate"><span class="pre">ScalarRiemannianMetricSystem.h()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ScalarRiemannianMetricSystem.h1"><code class="docutils literal notranslate"><span class="pre">ScalarRiemannianMetricSystem.h1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ScalarRiemannianMetricSystem.h1_flow"><code class="docutils literal notranslate"><span class="pre">ScalarRiemannianMetricSystem.h1_flow()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ScalarRiemannianMetricSystem.h2"><code class="docutils literal notranslate"><span class="pre">ScalarRiemannianMetricSystem.h2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ScalarRiemannianMetricSystem.metric"><code class="docutils literal notranslate"><span class="pre">ScalarRiemannianMetricSystem.metric()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ScalarRiemannianMetricSystem.metric_func"><code class="docutils literal notranslate"><span class="pre">ScalarRiemannianMetricSystem.metric_func()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ScalarRiemannianMetricSystem.neg_log_dens"><code class="docutils literal notranslate"><span class="pre">ScalarRiemannianMetricSystem.neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ScalarRiemannianMetricSystem.sample_momentum"><code class="docutils literal notranslate"><span class="pre">ScalarRiemannianMetricSystem.sample_momentum()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.ScalarRiemannianMetricSystem.vjp_metric_func"><code class="docutils literal notranslate"><span class="pre">ScalarRiemannianMetricSystem.vjp_metric_func()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.SoftAbsRiemannianMetricSystem"><code class="docutils literal notranslate"><span class="pre">SoftAbsRiemannianMetricSystem</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.SoftAbsRiemannianMetricSystem.dh1_dpos"><code class="docutils literal notranslate"><span class="pre">SoftAbsRiemannianMetricSystem.dh1_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.SoftAbsRiemannianMetricSystem.dh2_dmom"><code class="docutils literal notranslate"><span class="pre">SoftAbsRiemannianMetricSystem.dh2_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.SoftAbsRiemannianMetricSystem.dh2_dpos"><code class="docutils literal notranslate"><span class="pre">SoftAbsRiemannianMetricSystem.dh2_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.SoftAbsRiemannianMetricSystem.dh_dmom"><code class="docutils literal notranslate"><span class="pre">SoftAbsRiemannianMetricSystem.dh_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.SoftAbsRiemannianMetricSystem.dh_dpos"><code class="docutils literal notranslate"><span class="pre">SoftAbsRiemannianMetricSystem.dh_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.SoftAbsRiemannianMetricSystem.grad_neg_log_dens"><code class="docutils literal notranslate"><span class="pre">SoftAbsRiemannianMetricSystem.grad_neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.SoftAbsRiemannianMetricSystem.h"><code class="docutils literal notranslate"><span class="pre">SoftAbsRiemannianMetricSystem.h()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.SoftAbsRiemannianMetricSystem.h1"><code class="docutils literal notranslate"><span class="pre">SoftAbsRiemannianMetricSystem.h1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.SoftAbsRiemannianMetricSystem.h1_flow"><code class="docutils literal notranslate"><span class="pre">SoftAbsRiemannianMetricSystem.h1_flow()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.SoftAbsRiemannianMetricSystem.h2"><code class="docutils literal notranslate"><span class="pre">SoftAbsRiemannianMetricSystem.h2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.SoftAbsRiemannianMetricSystem.hess_neg_log_dens"><code class="docutils literal notranslate"><span class="pre">SoftAbsRiemannianMetricSystem.hess_neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.SoftAbsRiemannianMetricSystem.metric"><code class="docutils literal notranslate"><span class="pre">SoftAbsRiemannianMetricSystem.metric()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.SoftAbsRiemannianMetricSystem.metric_func"><code class="docutils literal notranslate"><span class="pre">SoftAbsRiemannianMetricSystem.metric_func()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.SoftAbsRiemannianMetricSystem.mtp_neg_log_dens"><code class="docutils literal notranslate"><span class="pre">SoftAbsRiemannianMetricSystem.mtp_neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.SoftAbsRiemannianMetricSystem.neg_log_dens"><code class="docutils literal notranslate"><span class="pre">SoftAbsRiemannianMetricSystem.neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.SoftAbsRiemannianMetricSystem.sample_momentum"><code class="docutils literal notranslate"><span class="pre">SoftAbsRiemannianMetricSystem.sample_momentum()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.SoftAbsRiemannianMetricSystem.vjp_metric_func"><code class="docutils literal notranslate"><span class="pre">SoftAbsRiemannianMetricSystem.vjp_metric_func()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.System"><code class="docutils literal notranslate"><span class="pre">System</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.System.dh1_dpos"><code class="docutils literal notranslate"><span class="pre">System.dh1_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.System.dh2_dmom"><code class="docutils literal notranslate"><span class="pre">System.dh2_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.System.dh2_dpos"><code class="docutils literal notranslate"><span class="pre">System.dh2_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.System.dh_dmom"><code class="docutils literal notranslate"><span class="pre">System.dh_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.System.dh_dpos"><code class="docutils literal notranslate"><span class="pre">System.dh_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.System.grad_neg_log_dens"><code class="docutils literal notranslate"><span class="pre">System.grad_neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.System.h"><code class="docutils literal notranslate"><span class="pre">System.h()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.System.h1"><code class="docutils literal notranslate"><span class="pre">System.h1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.System.h1_flow"><code class="docutils literal notranslate"><span class="pre">System.h1_flow()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.System.h2"><code class="docutils literal notranslate"><span class="pre">System.h2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.System.neg_log_dens"><code class="docutils literal notranslate"><span class="pre">System.neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.System.sample_momentum"><code class="docutils literal notranslate"><span class="pre">System.sample_momentum()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.TractableFlowSystem"><code class="docutils literal notranslate"><span class="pre">TractableFlowSystem</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.TractableFlowSystem.dh1_dpos"><code class="docutils literal notranslate"><span class="pre">TractableFlowSystem.dh1_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.TractableFlowSystem.dh2_dmom"><code class="docutils literal notranslate"><span class="pre">TractableFlowSystem.dh2_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.TractableFlowSystem.dh2_dpos"><code class="docutils literal notranslate"><span class="pre">TractableFlowSystem.dh2_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.TractableFlowSystem.dh_dmom"><code class="docutils literal notranslate"><span class="pre">TractableFlowSystem.dh_dmom()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.TractableFlowSystem.dh_dpos"><code class="docutils literal notranslate"><span class="pre">TractableFlowSystem.dh_dpos()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.TractableFlowSystem.grad_neg_log_dens"><code class="docutils literal notranslate"><span class="pre">TractableFlowSystem.grad_neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.TractableFlowSystem.h"><code class="docutils literal notranslate"><span class="pre">TractableFlowSystem.h()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.TractableFlowSystem.h1"><code class="docutils literal notranslate"><span class="pre">TractableFlowSystem.h1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.TractableFlowSystem.h1_flow"><code class="docutils literal notranslate"><span class="pre">TractableFlowSystem.h1_flow()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.TractableFlowSystem.h2"><code class="docutils literal notranslate"><span class="pre">TractableFlowSystem.h2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.TractableFlowSystem.h2_flow"><code class="docutils literal notranslate"><span class="pre">TractableFlowSystem.h2_flow()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.TractableFlowSystem.neg_log_dens"><code class="docutils literal notranslate"><span class="pre">TractableFlowSystem.neg_log_dens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.systems.TractableFlowSystem.sample_momentum"><code class="docutils literal notranslate"><span class="pre">TractableFlowSystem.sample_momentum()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/mici.systems.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023, Matt Graham.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>