
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>mici.stagers module &#8212; Mici 0.2.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=938c9ccc"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'mici.stagers';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="mici.states module" href="mici.states.html" />
    <link rel="prev" title="mici.solvers module" href="mici.solvers.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/mici-logo-rectangular.svg" class="logo__image only-light" alt="Mici 0.2.0 documentation - Home"/>
    <img src="_static/mici-logo-rectangular-light-text.svg" class="logo__image only-dark pst-js-only" alt="Mici 0.2.0 documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="mici.html">
    mici package
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/matt-graham/mici" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="mici.html">
    mici package
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/matt-graham/mici" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="mici.autodiff.html">mici.autodiff package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="mici.autodiff.autograd_wrapper.html">mici.autodiff.autograd_wrapper module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mici.autodiff.jax_wrapper.html">mici.autodiff.jax_wrapper module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mici.autodiff.symnum_wrapper.html">mici.autodiff.symnum_wrapper module</a></li>
</ul>
</details></li>
</ul>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="mici.adapters.html">mici.adapters module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.errors.html">mici.errors module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.integrators.html">mici.integrators module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.interface.html">mici.interface module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.interop.html">mici.interop module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.matrices.html">mici.matrices module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.progressbars.html">mici.progressbars module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.samplers.html">mici.samplers module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.solvers.html">mici.solvers module</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">mici.stagers module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.states.html">mici.states module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.systems.html">mici.systems module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.transitions.html">mici.transitions module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.types.html">mici.types module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mici.utils.html">mici.utils module</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="mici.html" class="nav-link">mici package</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">mici.stagers module</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-mici.stagers">
<span id="mici-stagers-module"></span><h1>mici.stagers module<a class="headerlink" href="#module-mici.stagers" title="Link to this heading">#</a></h1>
<p>Classes for staging sampling of Markov chains.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mici.stagers.ChainStage">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mici.stagers.</span></span><span class="sig-name descname"><span class="pre">ChainStage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adapters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trace_funcs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">record_stats</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/stagers.html#ChainStage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.stagers.ChainStage" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a></p>
<p>Parameters of chain stage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of iterations in chain stage.</p></li>
<li><p><strong>adapters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Iterable</em><em>[</em><a class="reference internal" href="mici.adapters.html#mici.adapters.Adapter" title="mici.adapters.Adapter"><em>Adapter</em></a><em>]</em><em>]</em>) – Dictionary of adapters to apply to each transition in chain stage.</p></li>
<li><p><strong>trace_funcs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><em>TraceFunction</em><em>] </em><em>| </em><em>None</em>) – Functions defining chain variables to trace during chain stage.</p></li>
<li><p><strong>record_stats</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to record statistics during chain stage.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mici.stagers.Stager">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mici.stagers.</span></span><span class="sig-name descname"><span class="pre">Stager</span></span><a class="reference internal" href="_modules/mici/stagers.html#Stager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.stagers.Stager" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>Abstract chain iteration stager.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mici.stagers.Stager.stages">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_warm_up_iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_main_iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adapters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trace_funcs</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">trace_warm_up</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/stagers.html#Stager.stages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.stagers.Stager.stages" title="Link to this definition">#</a></dt>
<dd><p>Create dictionary specifying labels and parameters of chain sampling stages.</p>
<p>Constructs an ordered dictionary with entries corresponding to the sequence of
sampling stages when running chains with one or more initial adaptation stages.
The keys of each entry are a string label for the sampling stage and the value a
<a class="reference internal" href="#mici.stagers.ChainStage" title="mici.stagers.ChainStage"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChainStage</span></code></a> named tuple specifying the parameters of the stage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_warm_up_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of adaptive warm up iterations per chain. Depending
on the adapters specified by the <cite>adapters</cite> argument the warm up
iterations may be split between one or more adaptive stages.</p></li>
<li><p><strong>n_main_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of iterations (samples to draw) per chain during main
(non-adaptive) sampling stage.</p></li>
<li><p><strong>trace_funcs</strong> (<em>Iterable</em><em>[</em><em>TraceFunction</em><em>]</em>) – Iterable of functions which compute the variables to be
recorded at each chain iteration, with each trace function being passed
the current state and returning a dictionary of scalar or array values
corresponding to the variable(s) to be stored. The keys in the returned
dictionaries are used to index the trace arrays in the returned traces
dictionary. If a key appears in multiple dictionaries only the the value
corresponding to the last trace function to return that key will be
stored. By default chains are only traced in the iterations of the final
non-adaptive stage - this behaviour can be altered using the
<cite>trace_warm_up</cite> argument.</p></li>
<li><p><strong>adapters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Iterable</em><em>[</em><a class="reference internal" href="mici.adapters.html#mici.adapters.Adapter" title="mici.adapters.Adapter"><em>Adapter</em></a><em>]</em><em>]</em>) – Dictionary of iterables of <a class="reference internal" href="mici.adapters.html#mici.adapters.Adapter" title="mici.adapters.Adapter"><code class="xref py py-class docutils literal notranslate"><span class="pre">mici.adapters.Adapter</span></code></a>
instances keyed by strings corresponding to the key of the transition in
the sampler
<a class="reference internal" href="mici.samplers.html#mici.samplers.MarkovChainMonteCarloMethod.transitions" title="mici.samplers.MarkovChainMonteCarloMethod.transitions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">mici.samplers.MarkovChainMonteCarloMethod.transitions</span></code></a>
dictionary to apply the adapters to, to use to adaptatively set
parameters of the transitions during the adaptive stages of the chains.
Note that the adapter updates are applied in the order the adapters
appear in the iterables and so if multiple adapters change the same
parameter(s) the order will matter.</p></li>
<li><p><strong>trace_warm_up</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to record chain traces and statistics during warm-up
stage iterations (<code class="code docutils literal notranslate"><span class="pre">True</span></code>) or only record traces and statistics in
the iterations of the final non-adaptive stage (<code class="code docutils literal notranslate"><span class="pre">False</span></code>, the
default).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary specifying chain stages, keyed by labels for stages.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>, <a class="reference internal" href="#mici.stagers.ChainStage" title="mici.stagers.ChainStage"><em>ChainStage</em></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mici.stagers.WarmUpStager">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mici.stagers.</span></span><span class="sig-name descname"><span class="pre">WarmUpStager</span></span><a class="reference internal" href="_modules/mici/stagers.html#WarmUpStager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.stagers.WarmUpStager" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#mici.stagers.Stager" title="mici.stagers.Stager"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stager</span></code></a></p>
<p>Chain iteration stager with a single adaptive warm up stage.</p>
<p>Sampling is split in to two stages:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>An adaptive warm up stage will all adapters active.</p></li>
<li><p>A main sampling stage with no adapters active.</p></li>
</ol>
</div></blockquote>
<p>Only in the main sampling stage are traces of the chain state recorded by storing
the outputs of functions of the sampled chain state after each iteration.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mici.stagers.WarmUpStager.stages">
<span class="sig-name descname"><span class="pre">stages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_warm_up_iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_main_iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adapters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trace_funcs</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">trace_warm_up</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/stagers.html#WarmUpStager.stages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.stagers.WarmUpStager.stages" title="Link to this definition">#</a></dt>
<dd><p>Create dictionary specifying labels and parameters of chain sampling stages.</p>
<p>Constructs an ordered dictionary with entries corresponding to the sequence of
sampling stages when running chains with one or more initial adaptation stages.
The keys of each entry are a string label for the sampling stage and the value a
<a class="reference internal" href="#mici.stagers.ChainStage" title="mici.stagers.ChainStage"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChainStage</span></code></a> named tuple specifying the parameters of the stage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_warm_up_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of adaptive warm up iterations per chain. Depending
on the adapters specified by the <cite>adapters</cite> argument the warm up
iterations may be split between one or more adaptive stages.</p></li>
<li><p><strong>n_main_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of iterations (samples to draw) per chain during main
(non-adaptive) sampling stage.</p></li>
<li><p><strong>trace_funcs</strong> (<em>Iterable</em><em>[</em><em>TraceFunction</em><em>]</em>) – Iterable of functions which compute the variables to be
recorded at each chain iteration, with each trace function being passed
the current state and returning a dictionary of scalar or array values
corresponding to the variable(s) to be stored. The keys in the returned
dictionaries are used to index the trace arrays in the returned traces
dictionary. If a key appears in multiple dictionaries only the the value
corresponding to the last trace function to return that key will be
stored. By default chains are only traced in the iterations of the final
non-adaptive stage - this behaviour can be altered using the
<cite>trace_warm_up</cite> argument.</p></li>
<li><p><strong>adapters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Iterable</em><em>[</em><a class="reference internal" href="mici.adapters.html#mici.adapters.Adapter" title="mici.adapters.Adapter"><em>Adapter</em></a><em>]</em><em>]</em>) – Dictionary of iterables of <a class="reference internal" href="mici.adapters.html#mici.adapters.Adapter" title="mici.adapters.Adapter"><code class="xref py py-class docutils literal notranslate"><span class="pre">mici.adapters.Adapter</span></code></a>
instances keyed by strings corresponding to the key of the transition in
the sampler
<a class="reference internal" href="mici.samplers.html#mici.samplers.MarkovChainMonteCarloMethod.transitions" title="mici.samplers.MarkovChainMonteCarloMethod.transitions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">mici.samplers.MarkovChainMonteCarloMethod.transitions</span></code></a>
dictionary to apply the adapters to, to use to adaptatively set
parameters of the transitions during the adaptive stages of the chains.
Note that the adapter updates are applied in the order the adapters
appear in the iterables and so if multiple adapters change the same
parameter(s) the order will matter.</p></li>
<li><p><strong>trace_warm_up</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to record chain traces and statistics during warm-up
stage iterations (<code class="code docutils literal notranslate"><span class="pre">True</span></code>) or only record traces and statistics in
the iterations of the final non-adaptive stage (<code class="code docutils literal notranslate"><span class="pre">False</span></code>, the
default).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary specifying chain stages, keyed by labels for stages.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>, <a class="reference internal" href="#mici.stagers.ChainStage" title="mici.stagers.ChainStage"><em>ChainStage</em></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mici.stagers.WindowedWarmUpStager">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mici.stagers.</span></span><span class="sig-name descname"><span class="pre">WindowedWarmUpStager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_init_slow_window_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_init_fast_stage_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_final_fast_stage_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slow_window_multiplier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/stagers.html#WindowedWarmUpStager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.stagers.WindowedWarmUpStager" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#mici.stagers.Stager" title="mici.stagers.Stager"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stager</span></code></a></p>
<p>Chain iteration stager with a hierarchy of adaptive warm up stages.</p>
<p>Following the approach of [Stan](<a class="reference external" href="https://mc-stan.org">https://mc-stan.org</a>) the adaptive stages are split
in to two types - ‘fast’ adaptation stages which adjust only transition parameters
which can be adapted quickly using local information and ‘slow’ adaptation stages
which <em>addtionally</em> adjust transition parameters which require more global
information. The adapters to be used in both the fast and slow adaptation stages
will be referred to as the <em>fast adapters</em> and the adapters to use in only the slow
adaptation stages the <em>slow adapters</em>. Each adapter self identifies if it is a fast
adapter by whether the <a class="reference internal" href="mici.adapters.html#mici.adapters.Adapter.is_fast" title="mici.adapters.Adapter.is_fast"><code class="xref py py-attr docutils literal notranslate"><span class="pre">mici.adapters.Adapter.is_fast</span></code></a> attribute is set to
<code class="code docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>The adaptive warm up iterations are split into three stages:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>An initial fast adaptive stage with only fast adapters active.</p></li>
<li><p>A slow adaptive stage with both slow and fast adapters active.</p></li>
<li><p>A final adaptive stage with only fast adapters active.</p></li>
</ol>
</div></blockquote>
<p>The slow sampling stage (2) is further split in to a sequence of growing, memoryless
windows with the adapter stages reset at the beginning of each window, and the
number of iterations in each window increasing (by default doubling). The split of
the iterations in each of these stages can be controlled using the keyword arguments
<cite>n_init_fast_stage_iter</cite>, <cite>n_init_slow_window_iter</cite>, <cite>n_final_fast_stage_iter</cite> and
<cite>slow_window_multiplier</cite> (see descriptions below).</p>
<p>After the initial adaptive warm up stages a subsequent main sampling stage with no
further adaptation is performed. Only in this main sampling stage are traces of the
chain state recorded by storing the outputs of functions of the sampled chain state
after each iteration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_init_slow_window_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of iterations in the initial (smallest)
window in the slow adaptation stage. Defaults to 25. If the sum of
<cite>n_init_slow_window_iter</cite>, <cite>n_init_fast_stage_iter</cite> and
<cite>n_final_fast_stage_iter</cite> is more than <cite>n_warm_up_iter</cite> then
<cite>n_init_slow_window_iter</cite> is set to approximately 75% of
<cite>n_warm_up_iter</cite> (with a single window being used in the slow adaptation
stage in this case).</p></li>
<li><p><strong>n_init_fast_stage_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of iterations in the initial fast adaptation
stage. Defaults to 75. If the sum of <cite>n_init_slow_window_iter</cite>,
n_init_fast_stage_iter` and <cite>n_final_fast_stage_iter</cite> is more than
<cite>n_warm_up_iter</cite> then <cite>n_init_fast_stage_iter</cite> is set to approximately
15% of <cite>n_warm_up_iter</cite>.</p></li>
<li><p><strong>n_final_fast_stage_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of iterations in the final fast adaptation
stage. Defaults to 50. If the sum of <cite>n_init_slow_window_iter</cite>,
<cite>n_init_fast_stage_iter</cite> and <cite>n_final_fast_stage_iter</cite> is more than
<cite>n_warm_up_iter</cite> then <cite>n_init_fast_stage_iter</cite> is set to approximately
10% of <cite>n_warm_up_iter</cite>.</p></li>
<li><p><strong>slow_window_multiplier</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Multiplier by which to increase the number of
iterations of each subsequent slow adaptation window by. Defaults to 2
such that each window doubles in size.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mici.stagers.WindowedWarmUpStager.stages">
<span class="sig-name descname"><span class="pre">stages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_warm_up_iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_main_iter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adapters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trace_funcs</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">trace_warm_up</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/stagers.html#WindowedWarmUpStager.stages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.stagers.WindowedWarmUpStager.stages" title="Link to this definition">#</a></dt>
<dd><p>Create dictionary specifying labels and parameters of chain sampling stages.</p>
<p>Constructs an ordered dictionary with entries corresponding to the sequence of
sampling stages when running chains with one or more initial adaptation stages.
The keys of each entry are a string label for the sampling stage and the value a
<a class="reference internal" href="#mici.stagers.ChainStage" title="mici.stagers.ChainStage"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChainStage</span></code></a> named tuple specifying the parameters of the stage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_warm_up_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of adaptive warm up iterations per chain. Depending
on the adapters specified by the <cite>adapters</cite> argument the warm up
iterations may be split between one or more adaptive stages.</p></li>
<li><p><strong>n_main_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of iterations (samples to draw) per chain during main
(non-adaptive) sampling stage.</p></li>
<li><p><strong>trace_funcs</strong> (<em>Iterable</em><em>[</em><em>TraceFunction</em><em>]</em>) – Iterable of functions which compute the variables to be
recorded at each chain iteration, with each trace function being passed
the current state and returning a dictionary of scalar or array values
corresponding to the variable(s) to be stored. The keys in the returned
dictionaries are used to index the trace arrays in the returned traces
dictionary. If a key appears in multiple dictionaries only the the value
corresponding to the last trace function to return that key will be
stored. By default chains are only traced in the iterations of the final
non-adaptive stage - this behaviour can be altered using the
<cite>trace_warm_up</cite> argument.</p></li>
<li><p><strong>adapters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Iterable</em><em>[</em><a class="reference internal" href="mici.adapters.html#mici.adapters.Adapter" title="mici.adapters.Adapter"><em>Adapter</em></a><em>]</em><em>]</em>) – Dictionary of iterables of <a class="reference internal" href="mici.adapters.html#mici.adapters.Adapter" title="mici.adapters.Adapter"><code class="xref py py-class docutils literal notranslate"><span class="pre">mici.adapters.Adapter</span></code></a>
instances keyed by strings corresponding to the key of the transition in
the sampler
<a class="reference internal" href="mici.samplers.html#mici.samplers.MarkovChainMonteCarloMethod.transitions" title="mici.samplers.MarkovChainMonteCarloMethod.transitions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">mici.samplers.MarkovChainMonteCarloMethod.transitions</span></code></a>
dictionary to apply the adapters to, to use to adaptatively set
parameters of the transitions during the adaptive stages of the chains.
Note that the adapter updates are applied in the order the adapters
appear in the iterables and so if multiple adapters change the same
parameter(s) the order will matter.</p></li>
<li><p><strong>trace_warm_up</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to record chain traces and statistics during warm-up
stage iterations (<code class="code docutils literal notranslate"><span class="pre">True</span></code>) or only record traces and statistics in
the iterations of the final non-adaptive stage (<code class="code docutils literal notranslate"><span class="pre">False</span></code>, the
default).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary specifying chain stages, keyed by labels for stages.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>, <a class="reference internal" href="#mici.stagers.ChainStage" title="mici.stagers.ChainStage"><em>ChainStage</em></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="mici.solvers.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">mici.solvers module</p>
      </div>
    </a>
    <a class="right-next"
       href="mici.states.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">mici.states module</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.stagers.ChainStage"><code class="docutils literal notranslate"><span class="pre">ChainStage</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.stagers.Stager"><code class="docutils literal notranslate"><span class="pre">Stager</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.stagers.Stager.stages"><code class="docutils literal notranslate"><span class="pre">Stager.stages()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.stagers.WarmUpStager"><code class="docutils literal notranslate"><span class="pre">WarmUpStager</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.stagers.WarmUpStager.stages"><code class="docutils literal notranslate"><span class="pre">WarmUpStager.stages()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.stagers.WindowedWarmUpStager"><code class="docutils literal notranslate"><span class="pre">WindowedWarmUpStager</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mici.stagers.WindowedWarmUpStager.stages"><code class="docutils literal notranslate"><span class="pre">WindowedWarmUpStager.stages()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/mici.stagers.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023, Matt Graham.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>