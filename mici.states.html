<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>mici.states module &mdash; Mici 0.2.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="mici.systems module" href="mici.systems.html" />
    <link rel="prev" title="mici.stagers module" href="mici.stagers.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
              <img src="_static/mici-logo-rectangular.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="mici.html">mici package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="mici.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="mici.adapters.html">mici.adapters module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mici.autodiff.html">mici.autodiff module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mici.autograd_wrapper.html">mici.autograd_wrapper module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mici.errors.html">mici.errors module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mici.integrators.html">mici.integrators module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mici.interop.html">mici.interop module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mici.matrices.html">mici.matrices module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mici.progressbars.html">mici.progressbars module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mici.samplers.html">mici.samplers module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mici.solvers.html">mici.solvers module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mici.stagers.html">mici.stagers module</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">mici.states module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mici.states.ChainState"><code class="docutils literal notranslate"><span class="pre">ChainState</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mici.states.cache_in_state"><code class="docutils literal notranslate"><span class="pre">cache_in_state()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mici.states.cache_in_state_with_aux"><code class="docutils literal notranslate"><span class="pre">cache_in_state_with_aux()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mici.systems.html">mici.systems module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mici.transitions.html">mici.transitions module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mici.types.html">mici.types module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mici.utils.html">mici.utils module</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Mici</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="mici.html">mici package</a></li>
      <li class="breadcrumb-item active">mici.states module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/mici.states.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-mici.states">
<span id="mici-states-module"></span><h1>mici.states module<a class="headerlink" href="#module-mici.states" title="Permalink to this heading"></a></h1>
<p>Objects for recording state of a Markov chain and caching computations.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mici.states.ChainState">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mici.states.</span></span><span class="sig-name descname"><span class="pre">ChainState</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_call_counts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_read_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_dependencies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">variables</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/states.html#ChainState"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.states.ChainState" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Markov chain state.</p>
<p>As well as recording the chain state variable values, the state object is also used
to cache derived quantities to avoid recalculation if these values are subsequently
reused.</p>
<p>Additionally for <cite>ChainState</cite> instances initialized with a <cite>_call_counts</cite>
dictionary, any memoized system methods (i.e. those decorated with <cite>cache_in_state</cite>
or <cite>cache_in_state_with_aux</cite>) will update a counter for the method in the state
<cite>_call_counts</cite> dictionary attribute every time the decorated method is called (i.e.
when there isn’t a valid cached value available).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>_call_counts</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a><em>]</em><em>]</em>) – </p></li>
<li><p><strong>_read_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – </p></li>
<li><p><strong>_dependencies</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.11)"><em>set</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>_cache</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>, </em><em>Any</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>variables</strong> (<em>ArrayLike</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mici.states.ChainState.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">read_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/states.html#ChainState.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.states.ChainState.copy" title="Permalink to this definition"></a></dt>
<dd><p>Create a deep copy of the state object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>read_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – Whether the state copy should be read-only.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A copy of the state object with variable attributes that are independent
copies of the original state object’s variables.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mici.states.cache_in_state">
<span class="sig-prename descclassname"><span class="pre">mici.states.</span></span><span class="sig-name descname"><span class="pre">cache_in_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">depends_on</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/states.html#cache_in_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.states.cache_in_state" title="Permalink to this definition"></a></dt>
<dd><p>Memoizing decorator for system methods.</p>
<p>Used to decorate <cite>mici.systems.System</cite> methods which compute a function of one or
more chain state variable(s), with the decorated method caching the value returned
by the method being wrapped in the <cite>ChainState</cite> object to prevent the need for
recomputation on future calls if the state variables the returned value depends on
have not been changed in between the calls.</p>
<p>Additionally for <cite>ChainState</cite> instances initialized with a <cite>_call_counts</cite> argument,
the memoized method will update a counter for the method in the <cite>_call_counts</cite>
attribute every time the method being decorated is called (i.e. when there isn’t a
valid cached value available).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*depends_on</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – One or more strings corresponding to the names of any state
variables the value returned by the method depends on, e.g. <cite>pos</cite> or <cite>mom</cite>,
such that the cache in the state object is correctly cleared when the value
of any of these variables (attributes) of the state object changes.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Callable</em>[[<em>Callable</em>[[<a class="reference internal" href="mici.systems.html#mici.systems.System" title="mici.systems.System"><em>System</em></a>, <a class="reference internal" href="#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>], ArrayLike]], <em>Callable</em>[[<a class="reference internal" href="mici.systems.html#mici.systems.System" title="mici.systems.System"><em>System</em></a>, <a class="reference internal" href="#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>], ArrayLike]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mici.states.cache_in_state_with_aux">
<span class="sig-prename descclassname"><span class="pre">mici.states.</span></span><span class="sig-name descname"><span class="pre">cache_in_state_with_aux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">depends_on</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auxiliary_outputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mici/states.html#cache_in_state_with_aux"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mici.states.cache_in_state_with_aux" title="Permalink to this definition"></a></dt>
<dd><p>Memoizing decorator for system methods with possible auxiliary outputs.</p>
<p>Used to decorate <cite>System</cite> methods which compute a function of one or more chain
state variable(s), with the decorated method caching the value or values returned by
the method being wrapped in the <cite>ChainState</cite> object to prevent the need for
recomputation on future calls if the state variables the returned value(s) depends
on have not been changed in between the calls.</p>
<p>Compared to the <cite>cache_in_state</cite> decorator, this variant allows for methods which
may optionally also return additional auxiliary outputs, such as intermediate result
computed while computing the primary output, which correspond to the output of
another system method decorated with the <cite>cache_in_state</cite> or
<cite>cache_in_state_with_aux</cite> decorators. If such auxiliary outputs are returned they
are also used to update cache entry for the corresponding decorated method,
potentially saving recomputation in subsequent calls to that method. A common
instance of this pattern is in derivative values computed using automatic
differentiation (AD), with the primal value being differentiated usually either
calculated alongside the derivative (in forward-mode AD) or calculated first in a
forward-pass before the derivatives are calculated in a reverse-pass (in
reverse-mode AD). By caching the value of the primal computed as part of the
derivative calculation, a subsequent call to a method corresponding to calculation
of the primal itself will retrieve the cached value and not recompute the primal,
providing the relevant state variables the primal (and derivative) depend on have
not been changed in between.</p>
<p>Additionally for <cite>ChainState</cite> instances initialized with a <cite>_call_counts</cite> argument,
the memoized method will update a counter for the method in the <cite>_call_counts</cite>
attribute every time the method being decorated is called (i.e. when there isn’t a
valid cached value available).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>depends_on</strong> (<em>Iterable</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em>) – A string or tuple of strings, with each string corresponding to the
name of a state variables the value(s) returned by the method depends on,
e.g. ‘pos’ or ‘mom’, such that the cache in the state object is correctly
cleared when the value of any of these variables (attributes) of the state
object changes.</p></li>
<li><p><strong>auxiliary_outputs</strong> (<em>Iterable</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em>) – A string or tuple of strings, with each string defining an
auxiliary output the wrapped method may additionally return in addition to
the primary output. If auxiliary outputs are returned, the returned value
should be a tuple with first entry the ‘primary’ output corresponding to the
value associated with the name of the method and the subsequent entries in
the tuple corresponding to the auxiliary outputs in the order specified by
the entries in the <cite>auxiliary_outputs</cite> argument. If the primary output is
itself a tuple, it must be wrapped in another tuple even when no auxiliary
outputs are being returned.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Callable</em>[[<em>Callable</em>[[<a class="reference internal" href="mici.systems.html#mici.systems.System" title="mici.systems.System"><em>System</em></a>, <a class="reference internal" href="#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>], ArrayLike]], <em>Callable</em>[[<a class="reference internal" href="mici.systems.html#mici.systems.System" title="mici.systems.System"><em>System</em></a>, <a class="reference internal" href="#mici.states.ChainState" title="mici.states.ChainState"><em>ChainState</em></a>], ArrayLike]]</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="mici.stagers.html" class="btn btn-neutral float-left" title="mici.stagers module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="mici.systems.html" class="btn btn-neutral float-right" title="mici.systems module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Matt Graham.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>